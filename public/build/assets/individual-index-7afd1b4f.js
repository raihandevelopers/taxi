import{_ as ae,Z as ne,O as le,P as ie,z as re,C as de,r as u,T as J,R as ce,g as c,o as m,x as D,w as r,a as P,U as b,N as E,k as d,l as t,J as n,i as _,F as K,L as W,y as f,B as g,p as ue,q as Y,K as me,n as Z,W as Q}from"./vendor-ddfbd976.js";import{L as fe}from"./main-306a5ea6.js";import{P as _e}from"./page-header-2dc95532.js";import{P as pe}from"./Pagination-f095ae3c.js";import{s as ge}from"./searchbar-3acbc236.js";import{l as ve}from"./footer-e648049d.js";import{_ as ye}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const be={data(){return{rightOffcanvas:!1}},components:{Layout:fe,PageHeader:_e,Head:ne,Pagination:pe,Multiselect:le,flatPickr:ie,Link:re,searchbar:ge},props:{successMessage:String,alertMessage:String,app_for:String,employees:Array,ticket:Object,support_ticket:Array,employees:Array},setup(a){const{t:e}=de(),L=u(""),o=J({transport_type:null,dispatch_type:null,status:null}),v=u([]),F=u({}),w=u(!1),B=u(!1),C=u(null),M=u(!1),A=u([]);u(a.support_ticket);const y=u(),H=u(null),S=u(a.employees),h=J({assign_to:a.ticket&&a.ticket.assign_to||""}),U={assign_to:{required:!0}},O=u(a.successMessage||""),R=u(a.alertMessage||""),I=()=>{O.value="",R.value=""},x=u(!1),N=()=>{V(),B.value=!0,x.value=!1},q=()=>{o.reset(),V(),x.value=!1},z=()=>{w.value=!1},s=async l=>{try{await P.delete(`/title/delete/${l}`);const i=v.value.findIndex(p=>p.id===l);i!==-1&&v.value.splice(i,1),w.value=!1,b.fire(e("success"),e("title_deleted_successfully"),"success")}catch{b.fire(e("error"),e("failed_to_delete_title"),"error")}},j=async l=>{b.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async i=>{if(i.isConfirmed)try{await s(l)}catch(p){console.error(e("error_deleting_data"),p),b.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},$=async l=>{L.value=l,V()},V=async(l=1)=>{try{const i=o.data();i.search=L.value,i.page=l;const p=await P.get("/support-tickets/individual_list",{params:i});v.value=p.data.results,F.value=p.data.paginator,B.value=!1}catch(i){console.error(e("error_fetching_title"),i)}},X=async(l,i,p)=>{b.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async T=>{if(T.isConfirmed)try{await P.post("/support-tickets/update-status",{id:l,status:i,employee_id:p});const k=v.value.findIndex(oe=>oe.id===l);k!==-1&&(v.value[k].active=i),b.fire(e("changed"),e("status_updated_successfully"),"success"),E.get("/support-tickets")}catch(k){console.error(e("error_updating_status"),k),b.fire(e("error"),e("failed_to_update_status"),"error")}})},ee=async l=>{V(l)},te=async l=>{E.get(`/title/edit/${l.id}`)},se=async l=>{M.value=!0,y.value=l;const i=y.value.ticket_title.category_type;i?await G(i):console.error("Category type is undefined")},G=async l=>{try{const i=await P.get(`/admins/list?category_type=${l}`),p=l.split(",");A.value=i.data.results.filter(T=>T.category_type&&p.some(k=>T.category_type.includes(k)))}catch(i){console.error("Error fetching employees:",i)}};return{results:v,modalShow:w,deleteItemId:C,successMessage:O,alertMessage:R,filterData:N,deleteModal:j,closeModal:z,deleteData:s,dismissMessage:I,searchTerm:L,fetchSearch:$,paginator:F,modalFilter:B,clearFilter:q,fetchDatas:V,filter:o,handlePageChanged:ee,editData:te,rightOffcanvas:x,toggleActiveStatus:X,assignEmployees:se,showEmployess:M,employees_name:A,handleSubmit:async()=>{console.log("data",h.data());try{const l=await P.post(`support-tickets/update/${y.value.id}`,{assign_to:h.assign_to});l.status===200||l.status===201?(h.reset(),E.get("/support-tickets")):console.error("Unexpected response status:",l.status)}catch(l){console.error("Error submitting form:",l)}},validationRules:U,validationRef:H,form:h,fetchEmployees:G,viewTicket:async l=>{E.get(`/support-tickets/view-details/${l.id}`,{},{preserveState:!1})},employee_id:S}},computed:{...ve,...ce(["permissions"])},mounted(){this.fetchDatas()}},he={class:"table-responsive"},ke={class:"table align-middle position-relative table-nowrap"},we={class:"table-active"},Be={scope:"col"},Ce={scope:"col"},Me={scope:"col"},Se={scope:"col"},xe={scope:"col"},Ve={scope:"col"},Pe={scope:"col"},Le={key:0},Ae={key:0},Oe={class:"dropdown"},Re={class:"dropdown-menu dropdown-menu-end"},Te={key:0,class:"dropdown-item",href:"#"},De=["onClick"],Ee=["onClick"],Fe={key:1},He={colspan:"12",class:"text-center"},Ue={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ie={class:"alert-content"},Ne={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},qe={class:"alert-content"},ze={class:"row"},je={class:"col-sm-12"},$e={class:"mb-3"},Ye={for:"assing_to",class:"form-label"},Ge={value:"",disabled:""},Je=["value"],Ke={class:"modal-footer v-modal-footer"},We={class:"offcanvas-body"},Ze={class:"mb-4"},Qe={for:"datepicker-range",class:"form-label text-muted text-uppercase fw-semibold mb-3"},Xe={class:"form-check form-check-inline"},et={class:"form-check-label",for:"active"},tt={class:"form-check form-check-inline"},st={class:"form-check-label",for:"inactive"},ot={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function at(a,e,L,o,v,F){const w=c("Head"),B=c("PageHeader"),C=c("BCol"),M=c("BRow"),A=c("BCardHeader"),y=c("BBadge"),H=c("Link"),S=c("BButton"),h=c("BCardBody"),U=c("BCard"),O=c("BLink"),R=c("FormValidation"),I=c("BModal"),x=c("BFrom"),N=c("BOffcanvas"),q=c("Pagination"),z=c("Layout");return m(),D(z,null,{default:r(()=>[d(w,{title:"Tickets"}),d(B,{title:a.$t("tickets"),pageTitle:a.$t("support_management")},null,8,["title","pageTitle"]),d(M,null,{default:r(()=>[d(C,{lg:"12"},{default:r(()=>[d(U,{"no-body":"",id:"tasksList"},{default:r(()=>[d(A,{class:"border-0"},{default:r(()=>[d(M,{class:"g-2"},{default:r(()=>[d(C,{md:"3"}),d(C,{md:"auto",class:"ms-auto"},{default:r(()=>e[10]||(e[10]=[t("div",{class:"d-flex align-items-center gap-2"},null,-1)])),_:1,__:[10]})]),_:1})]),_:1}),d(h,{class:"border border-dashed border-end-0 border-start-0"},{default:r(()=>[t("div",he,[t("table",ke,[t("thead",we,[t("tr",null,[t("th",Be,n(a.$t("ticket_id")),1),t("th",Ce,n(a.$t("support_type")),1),t("th",Me,n(a.$t("title")),1),t("th",Se,n(a.$t("user_name")),1),t("th",xe,n(a.$t("user_type")),1),t("th",Ve,n(a.$t("status")),1),t("th",Pe,n(a.$t("action")),1)])]),o.results.length>0?(m(),_("tbody",Le,[(m(!0),_(K,null,W(o.results,(s,j)=>(m(),_("tr",{key:j},[t("td",null,n(s.ticket_id),1),t("td",null,[f(n(s.support_type)+" ",1),s.request_id?(m(),_("span",Ae,"("+n(s.request_id)+")",1)):g("",!0)]),t("td",null,n(s.title),1),t("td",null,n(s.user_name),1),t("td",null,n(s.user_type),1),t("td",null,[s.status==1?(m(),D(y,{key:0,variant:"success",class:"text-uppercase"},{default:r(()=>[f(n(a.$t("pending")),1)]),_:1})):g("",!0),s.status==2?(m(),D(y,{key:1,variant:"warning",class:"text-uppercase"},{default:r(()=>[f(n(a.$t("acknowledge")),1)]),_:1})):g("",!0),s.status==3?(m(),D(y,{key:2,variant:"danger",class:"text-uppercase"},{default:r(()=>[f(n(a.$t("closed")),1)]),_:1})):g("",!0)]),t("td",null,[d(S,{class:ue(["btn btn-soft-info btn-sm m-2",{"disabled-btn":a.isDisabled}]),size:"sm",type:"button",disabled:s.admin_details&&s.admin_details.user_id!==o.employee_id.user_id},{default:r(()=>[t("div",Oe,[e[14]||(e[14]=t("a",{class:"text-reset",href:"#","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[t("span",{class:"text-muted fs-18"},[t("i",{class:"mdi mdi-dots-vertical"})])],-1)),t("div",Re,[s.status===1?(m(),_("a",Te,[e[11]||(e[11]=t("i",{class:"bx bx-radio-circle-marked align-center text-muted me-2"},null,-1)),t("span",{onClick:$=>o.toggleActiveStatus(s.id,2,o.employee_id.user_id)},n(a.$t("acknowledge")),9,De)])):g("",!0),s.status===2?(m(),_("a",{key:1,class:"dropdown-item",href:"#",onClick:$=>o.toggleActiveStatus(s.id,3,o.employee_id.user_id)},[e[12]||(e[12]=t("i",{class:"bx bx-radio-circle-marked align-center text-muted me-2"},null,-1)),t("span",null,n(a.$t("closed")),1)],8,Ee)):g("",!0),d(H,{class:"dropdown-item",href:`/support-tickets/view-details/${s.id}`},{default:r(()=>[e[13]||(e[13]=t("i",{class:"bx bx-radio-circle-marked align-center text-muted me-2"},null,-1)),f(" "+n(a.$t("view")),1)]),_:2,__:[13]},1032,["href"])])])]),_:2},1032,["disabled","class"])]),e[15]||(e[15]=t("td",null,null,-1))]))),128))])):(m(),_("tbody",Fe,[t("tr",null,[t("td",He,[e[16]||(e[16]=t("img",{src:ye,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,n(a.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[o.successMessage?(m(),_("div",Ue,[t("div",Ie,[e[17]||(e[17]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[18]||(e[18]=f()),e[19]||(e[19]=t("strong",null,"Success",-1)),f(" - "+n(o.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[0]||(e[0]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):g("",!0),o.alertMessage?(m(),_("div",Ne,[t("div",qe,[e[20]||(e[20]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[21]||(e[21]=f()),e[22]||(e[22]=t("strong",null,"Alert",-1)),f(" - "+n(o.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[1]||(e[1]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):g("",!0)]),d(I,{modelValue:o.showEmployess,"onUpdate:modelValue":e[6]||(e[6]=s=>o.showEmployess=s),"hide-footer":"",title:a.$t("assign_to"),class:"v-modal-custom",size:"md"},{default:r(()=>[t("form",{onSubmit:e[5]||(e[5]=Z((...s)=>o.handleSubmit&&o.handleSubmit(...s),["prevent"])),enctype:"multipart/form-data"},[d(R,{form:o.form,rules:o.validationRules,ref:"validationRef"},{default:r(()=>[t("div",ze,[t("div",je,[t("div",$e,[t("label",Ye,[f(n(a.$t("assign_to")),1),e[23]||(e[23]=t("span",{class:"text-danger"},"*",-1))]),Y(t("select",{id:"assing_to",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>o.form.assign_to=s)},[t("option",Ge,n(a.$t("select_title")),1),(m(!0),_(K,null,W(o.employees_name,s=>(m(),_("option",{key:s.first_name,value:s.user_id},n(s.first_name),9,Je))),128))],512),[[me,o.form.assign_to]])])])]),t("div",Ke,[d(O,{href:"javascript:void(0);",class:"btn btn-link link-warning fw-medium",onClick:e[3]||(e[3]=s=>o.showEmployess=!1)},{default:r(()=>[e[24]||(e[24]=t("i",{class:"ri-close-line me-1 align-middle"},null,-1)),f(" "+n(a.$t("close")),1)]),_:1,__:[24]}),t("button",{type:"button",class:"btn btn-soft-info waves-effect waves-light",onClick:e[4]||(e[4]=Z((...s)=>o.handleSubmit&&o.handleSubmit(...s),["prevent"]))},n(a.$t("submit")),1)])]),_:1},8,["form","rules"])],32)]),_:1},8,["modelValue","title"]),d(N,{modelValue:o.rightOffcanvas,"onUpdate:modelValue":e[9]||(e[9]=s=>o.rightOffcanvas=s),placement:"end",title:a.$t("users_filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:r(()=>[d(x,{action:"",class:"d-flex flex-column justify-content-end h-100"},{default:r(()=>[t("div",We,[t("div",Ze,[t("label",Qe,n(a.$t("status")),1),t("div",null,[t("div",Xe,[Y(t("input",{class:"form-check-input","onUpdate:modelValue":e[7]||(e[7]=s=>o.filter.status=s),type:"radio",name:"inlineRadioOptions",id:"active",value:"1"},null,512),[[Q,o.filter.status]]),t("label",et,n(a.$t("active")),1)]),t("div",tt,[Y(t("input",{class:"form-check-input","onUpdate:modelValue":e[8]||(e[8]=s=>o.filter.status=s),type:"radio",name:"inlineRadioOptions",id:"inactive",value:"0"},null,512),[[Q,o.filter.status]]),t("label",st,n(a.$t("inactive")),1)])])])]),t("div",ot,[d(S,{variant:"light",onClick:o.clearFilter,class:"w-100"},{default:r(()=>[f(n(a.$t("clear_filter")),1)]),_:1},8,["onClick"]),d(S,{type:"submit",onClick:o.filterData,variant:"success",class:"w-100"},{default:r(()=>[f(n(a.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),d(q,{paginator:o.paginator,onPageChanged:o.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const pt=ae(be,[["render",at]]);export{pt as default};
