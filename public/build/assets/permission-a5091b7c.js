import{_ as A,aF as E,z as I,Z as N,r as C,G as V,D as F,g as l,o as u,x as T,w as d,a as j,k as r,l as s,y as w,J as i,i as g,L as $,F as B,B as L,a1 as z}from"./vendor-ddfbd976.js";import{L as D}from"./main-306a5ea6.js";import{P as W}from"./page-header-2dc95532.js";import"./footer-e648049d.js";import"./app-042fb454.js";const G=E({components:{Layout:D,PageHeader:W,Link:I,Head:N},props:{role:Object,permissions:Array,permissionRole:Array},setup(e){const n=C(new Set),f=C(""),m=C(100),M=V(()=>Array.from(new Set(e.permissions.map(t=>t.main_menu)))),P=t=>e.permissions.filter(o=>o.main_menu===t),b=t=>e.permissions.filter(o=>o.main_menu===t).length,h=t=>e.permissions.filter(a=>a.main_menu===t).every(a=>n.value.has(a.slug)),v=t=>{h(t)?e.permissions.filter(o=>o.main_menu===t).forEach(o=>{n.value.has(o.slug)&&n.value.delete(o.slug)}):e.permissions.filter(o=>o.main_menu===t).forEach(o=>{n.value.has(o.slug)||n.value.add(o.slug)})},_=(t,o)=>{n.value.has(t)?n.value.delete(t):n.value.add(t)},k=t=>n.value.has(t),y=()=>{const t={permissions:Array.from(n.value)};j.post(`/permissions/${e.role.id}`,t).then(o=>{if(o.status>=200&&o.status<300){f.value=o.data.message,m.value=100;const a=setInterval(()=>{m.value-=1,m.value<=0&&clearInterval(a)},20);setTimeout(()=>{p()},2e3)}}).catch(o=>{console.error(o)})};F(()=>{e.permissionRole&&e.permissionRole.length>0&&e.permissionRole.forEach(t=>{n.value.add(t.slug)})});const p=()=>{f.value="",m.value=0};return{getMainMenus:M,getPermissionsByMainMenu:P,getRowSpan:b,isChecked:k,isMenuChecked:h,toggleSlug:_,toggleMenu:v,savePermissions:y,successMessage:f,dismissMessage:p,progressWidth:m}}}),J={class:"form-group mt-3 d-flex justify-content-between"},O={class:"btn btn-primary mt-3 float-end btn-sm"},Z={class:"table table-bordered permissions-table"},q=["rowspan"],K=["id","checked","onChange"],Q=["for"],U={class:"form-check form-check-success mb-3"},X=["id","checked","onChange"],Y=["for"],x={key:0,class:"custom-alert alert alert-success alert-border-left fade show bounce",role:"alert",id:"alertMsg"},ee={class:"alert-content"},se={class:"progress-container"};function te(e,n,f,m,M,P){const b=l("Head"),h=l("PageHeader"),v=l("Link"),_=l("BCol"),k=l("BCardHeader"),y=l("BCardBody"),p=l("BCard"),t=l("BRow"),o=l("Layout");return u(),T(o,null,{default:d(()=>[r(b,{title:"Permissions"}),r(h,{title:"Permissions",pageTitle:"Roles",pageLink:"/roles"}),r(t,null,{default:d(()=>[r(_,{lg:"12"},{default:d(()=>[r(p,{"no-body":"",id:"tasksList"},{default:d(()=>[r(k,{class:"border-0"},{default:d(()=>[r(_,null,{default:d(()=>[s("div",J,[s("div",null,[s("h3",null,[w(i(e.$t("role"))+": ",1),s("b",null,i(e.role.name),1)])]),r(v,{href:"/roles"},{default:d(()=>[s("button",O,i(e.$t("back")),1)]),_:1})])]),_:1})]),_:1}),r(y,{class:"border border-dashed border-end-0 border-start-0"},{default:d(()=>[s("table",Z,[s("thead",null,[s("tr",null,[s("th",null,i(e.$t("main_menu")),1),s("th",null,i(e.$t("slugs")),1)])]),s("tbody",null,[(u(!0),g(B,null,$(e.getMainMenus,(a,R)=>(u(),g(B,{key:R},[(u(!0),g(B,null,$(e.getPermissionsByMainMenu(a),(c,S)=>(u(),g("tr",{key:c.id},[S===0?(u(),g("td",{key:0,rowspan:e.getRowSpan(a)},[s("input",{class:"form-check-input",type:"checkbox",id:a,checked:e.isMenuChecked(a),onChange:H=>e.toggleMenu(a)},null,40,K),s("label",{class:"form-check-label mx-2",for:a},i(a),9,Q)],8,q)):L("",!0),s("td",null,[s("div",U,[s("input",{class:"form-check-input",type:"checkbox",id:c.id,checked:e.isChecked(c.slug),onChange:H=>e.toggleSlug(c.slug,c.main_menu)},null,40,X),s("label",{class:"form-check-label mx-2",for:c.id},i(c.slug),9,Y)])])]))),128))],64))),128))])]),s("button",{onClick:n[0]||(n[0]=(...a)=>e.savePermissions&&e.savePermissions(...a)),class:"btn btn-primary mt-3 float-end"},i(e.permissionRole.length===0?e.$t("save_permissions"):e.$t("update_permissions")),1)]),_:1})]),_:1})]),_:1})]),_:1}),e.successMessage?(u(),g("div",x,[s("div",ee,[n[2]||(n[2]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),n[3]||(n[3]=s("strong",null,"Success",-1)),w(" - "+i(e.successMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-success",onClick:n[1]||(n[1]=(...a)=>e.dismissMessage&&e.dismissMessage(...a)),"aria-label":"Close Success Message"}),s("div",se,[s("div",{class:"progress-bar",style:z({width:e.progressWidth+"%"})},null,4)])])])):L("",!0)]),_:1})}const ie=A(G,[["render",te],["__scopeId","data-v-267d00de"]]);export{ie as default};
