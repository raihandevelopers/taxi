import{_ as I,Z as R,C as U,r as L,T as G,X as m,D as J,g as b,o as n,x as N,w as T,a as V,N as A,k as E,i as l,l as t,n as Z,J as c,q as F,K,F as D,L as S,B as g,p as X,M as Q,y as W}from"./vendor-ddfbd976.js";import{L as Y}from"./main-306a5ea6.js";import{P as $}from"./page-header-2dc95532.js";import{u as ee}from"./footer-e648049d.js";import"./app-042fb454.js";const te={components:{Layout:Y,PageHeader:$,Head:R},props:{airport:Object,successMessage:String,languages:Array,alertMessage:String},setup(i){const{airport:o}=i,{t:u}=U(),{languages:s,fetchData:B}=ee(),C=L("English"),h=L(i.successMessage||""),y=L(i.alertMessage||""),p=G({service_location_id:o.service_location_id,name:o.name,coordinates:o.coordinates||[]}),w=L([]);let d,e,_=[];const x=m.latLngBounds(),H=async()=>{const a=await V.get("/airport/list");w.value=a.data.results},O=()=>{if(o&&o.coordinates){d=m.map("map").setView([0,0],10),m.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"Â© OpenStreetMap"}).addTo(d);const a=new m.FeatureGroup;d.addLayer(a),o.coordinates.forEach(r=>{const v=r[0].map(f=>[f.coordinates[1],f.coordinates[0]]);e=m.polygon(v,{color:"blue",weight:3,fillOpacity:.2}).addTo(a),x.extend(e.getBounds()),_.push(e)}),d.fitBounds(x),q(a)}},q=a=>{const r=new m.Control.Draw({edit:{featureGroup:a,remove:!0},draw:{polygon:{allowIntersection:!1},rectangle:!1,circle:!1,polyline:!1,marker:!1}});d.addControl(r),d.on(m.Draw.Event.CREATED,function(v){const f=v.layer;a.addLayer(f),_.push(f)}),d.on(m.Draw.Event.DELETED,function(v){v.layers.eachLayer(function(M){console.log("Deleted layer:",M),_=_.filter(k=>k!==M)})})},P=async()=>{const a=j();if(Object.keys(a).length===0)try{if(_.length===0){y.value=u("at_least_one_completed_polygon_is_required");return}const r=_.map(M=>M.getLatLngs()[0].map(k=>[k.lng,k.lat])),v={...p.data(),coordinates:JSON.stringify(r)};(await V.post(`/airport/update/${o.id}`,v)).status===200?(h.value=u("airport_created_successfully"),p.reset(),A.get("/airport")):console.error(u("failed_to_update_airport"))}catch(r){r.response&&r.response.status===403?(y.value=r.response.data.alertMessage,setTimeout(()=>{A.get("/airport")},5e3)):console.error(u("error_updating_airport"),r)}else p.errors=a},j=()=>{const{service_location_id:a}=p,r={};return a?delete r.service_location_id:r.service_location_id=u("service_location_is_required"),r},z=a=>{C.value=a};return J(async()=>{Object.keys(s).length==0&&await B(),O(),H()}),{form:p,serviceLocations:w,handleSubmit:P,setActiveTab:z,languages:s,activeTab:C,successMessage:h,alertMessage:y}}},se={key:0,class:"row"},oe={class:"col-lg-6"},ae={class:"card"},re={class:"card-body"},ne={class:"mb-3"},ie={for:"service_location",class:"form-label"},le={value:"",disabled:""},ce=["value"],de={key:0,class:"text-danger"},_e={class:"nav nav-tabs nav-tabs-custom nav-success nav-justified",role:"tablist"},me={class:"nav-item",role:"presentation"},ue=["onClick"],pe=["id"],ve={class:"col-sm-6 mt-3"},fe={class:"mb-3"},ge=["for"],ye=["placeholder","id","onUpdate:modelValue","required"],be={class:"text-end"},he={type:"submit",class:"btn btn-primary"},we={class:"mb-3"},Me={key:0,class:"text-danger"},ke={key:1,class:"alert alert-success"},Le={key:2,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},Ce={class:"alert-content"};function Te(i,o,u,s,B,C){const h=b("Head"),y=b("PageHeader"),p=b("BCol"),w=b("BRow"),d=b("Layout");return n(),N(d,null,{default:T(()=>[E(h,{title:"Edit Airport"}),E(y,{title:i.$t("edit"),pageTitle:i.$t("airport"),pageLink:"/airport"},null,8,["title","pageTitle"]),u.airport?(n(),l("div",se,[t("div",oe,[t("div",ae,[t("div",re,[t("form",{onSubmit:o[1]||(o[1]=Z((...e)=>s.handleSubmit&&s.handleSubmit(...e),["prevent"]))},[t("div",ne,[t("label",ie,c(i.$t("service_location")),1),F(t("select",{class:"form-select",id:"service_location","onUpdate:modelValue":o[0]||(o[0]=e=>s.form.service_location_id=e)},[t("option",le,c(i.$t("select_service_location")),1),(n(!0),l(D,null,S(s.serviceLocations,e=>(n(),l("option",{key:e.id,value:e.id},c(e.name),9,ce))),128))],512),[[K,s.form.service_location_id]]),s.form.errors.service_location_id?(n(),l("span",de,c(s.form.errors.service_location_id),1)):g("",!0)]),t("ul",_e,[(n(!0),l(D,null,S(s.languages,e=>(n(),N(w,{key:e.code},{default:T(()=>[E(p,{lg:"12"},{default:T(()=>[t("li",me,[t("a",{class:X(["nav-link",{active:s.activeTab===e.label}]),onClick:_=>s.setActiveTab(e.label),role:"tab","aria-selected":"true"},c(e.label),11,ue)])]),_:2},1024)]),_:2},1024))),128))]),(n(!0),l(D,null,S(s.languages,e=>(n(),l("div",{class:"tab-content text-muted",key:e.code},[s.activeTab===e.label?(n(),l("div",{key:0,class:"tab-pane active show",id:`${e.label}`,role:"tabpanel"},[t("div",ve,[t("div",fe,[t("label",{for:`name-${e.code}`,class:"form-label"},c(i.$t("name")),9,ge),F(t("input",{type:"text",class:"form-control",placeholder:`Enter Name in ${e.label}`,id:`name-${e.code}`,"onUpdate:modelValue":_=>s.form.languageFields[e.code]=_,required:e.code==="en"},null,8,ye),[[Q,s.form.languageFields[e.code]]])])])],8,pe)):g("",!0)]))),128)),t("div",be,[t("button",he,c(i.$t("update")),1)]),t("div",we,[s.form.errors.coordinates?(n(),l("span",Me,c(s.form.errors.coordinates),1)):g("",!0)])],32)])])]),o[3]||(o[3]=t("div",{class:"col-lg-6"},[t("div",{class:"card"},[t("div",{class:"card-body"},[t("div",{id:"map",style:{height:"400px"}})])])],-1))])):g("",!0),s.successMessage?(n(),l("div",ke,c(s.successMessage),1)):g("",!0),s.alertMessage?(n(),l("div",Le,[t("div",Ce,[o[4]||(o[4]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[5]||(o[5]=t("strong",null,"Alert",-1)),W(" - "+c(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[2]||(o[2]=(...e)=>i.dismissMessage&&i.dismissMessage(...e)),"aria-label":"Close Alert Message"})])])):g("",!0)]),_:1})}const Ne=I(te,[["render",Te],["__scopeId","data-v-2ca8413e"]]);export{Ne as default};
