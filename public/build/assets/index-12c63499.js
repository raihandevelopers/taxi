import{_ as $,Z as ee,O as te,P as se,z as oe,C as ae,r as _,T as ie,R as ne,g as u,S as le,o as l,x as h,w as r,U as y,a as A,N as re,k as c,l as e,y as v,J as n,B as m,i as b,n as M,q as L,K as de,L as j,F as q,p as ce,W as Y}from"./vendor-ddfbd976.js";import{L as ue}from"./main-306a5ea6.js";import{P as me}from"./page-header-2dc95532.js";import{P as _e}from"./Pagination-f095ae3c.js";import{s as fe}from"./search-2c17aadd.js";import{s as be}from"./searchbar-3acbc236.js";import{l as pe}from"./footer-e648049d.js";import{_ as he}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const ve={data(){return{rightOffcanvas:!1}},components:{Layout:ue,PageHeader:me,Head:ee,Pagination:_e,Multiselect:te,flatPickr:se,Link:oe,search:fe,searchbar:be},props:{successMessage:String,alertMessage:String,enabled_module:String,app_for:String,users:Array,promoCodes:{type:Object,required:!0}},setup(o){const{t}=ae(),f=_(""),s=ie({status:null,transport_type:null,limit:10}),C=_([]),O=_({}),P=_(!1),S=_(!1),U=_(null),D=_(o.users),g=_(o.enabled_module),w=_({}),R=_(o.successMessage||""),p=_(o.alertMessage||""),N=()=>{R.value="",p.value=""},z=async(i,d)=>{y.fire({title:t("are_you_sure"),text:t("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:t("yes"),cancelButtonText:t("cancel")}).then(async k=>{if(k.isConfirmed)try{await A.post(`/subscription/update-status/${i}`,{id:i,status:d});const T=C.value.findIndex(X=>X.id===i);T!==-1&&(C.value[T].active=d),y.fire(t("changed"),t("status_updated_successfully"),"success")}catch(T){console.error(t("error_updating_status"),T),y.fire(t("error"),t("failed_to_update_status"),"error")}})},E=i=>i.charAt(0).toUpperCase()+i.slice(1),x=_(!1),W=()=>{B(),S.value=!0,x.value=!1},I=()=>{s.reset(),B(),x.value=!1},V=()=>{P.value=!1},a=async i=>{try{await A.delete(`/subscription/delete/${i}`);const d=C.value.findIndex(k=>k.id===i);d!==-1&&C.value.splice(d,1),P.value=!1,y.fire(t("success"),t("subscription_deleted_successfully"),"success")}catch{y.fire(t("error"),t("failed_to_delete_subscription"),"error")}},F=_(g.value!="commission"),H=async i=>{if(g.value!==i)try{await A.post("/drivers-levelup/settingsUpdate",{id:"driver_register_module",status:i}),g.value=i,F.value=i!=="commission"}catch(d){console.error(t("error_updating_module"),d),y.fire(t("error"),t("failed_to_update_module"),"error")}},G=async i=>{y.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async d=>{if(d.isConfirmed)try{await a(i)}catch(k){console.error(t("error_deleting_data"),k),y.fire(t("error"),t("failed_to_delete_the_data"),"error")}})},B=async(i=1)=>{try{const d=s.data();d.page=i,f.value.length>0&&(d.search=f.value);const k=await A.get("/subscription/list",{params:d});C.value=k.data.results,O.value=k.data.paginator,Q(O.value.total),S.value=!1}catch(d){console.error(t("error_fetching_subscriptions"),d)}},J=async i=>{B(i)},K=async i=>{re.get(`/subscription/edit/${i.id}`)},Z=async i=>{f.value=i,B()},Q=()=>{w.value=[10,25,50,100,200,500]};return{results:C,users:D,modalShow:P,deleteItemId:U,successMessage:R,enable_subscription:F,handleSubscriptionUpdate:H,alertMessage:p,filterData:W,deleteModal:G,enabled_module:g,closeModal:V,deleteData:a,dismissMessage:N,searchTerm:f,paginator:O,modalFilter:S,clearFilter:I,fetchDatas:B,filter:s,handlePageChanged:J,editData:K,capitalizeFirstLetter:E,toggleActiveStatus:z,rightOffcanvas:x,fetchSearch:Z,paginatorOption:w,changeEntriesPerPage:()=>{B()}}},computed:{...pe,...ne(["permissions"])},mounted(){this.fetchDatas()}},ge={class:"alert bg-warning border-warning fs-18",role:"alert"},ke={key:0,class:"col-sm-4"},ye={class:"mb-3"},Ce={class:"border rounded"},we={class:"row"},Be={class:"col"},Me={class:"form-check-label p-2 mt-2",for:"enable_commission"},Pe={class:"col"},Se={class:"form-check form-switch form-switch-md float-end p-2"},xe=["disabled","checked"],Le={key:1,class:"col-sm-4"},Oe={class:"mb-3"},Ue={class:"border rounded"},De={class:"row"},Re={class:"col"},Ve={class:"form-check-label p-2 mt-2",for:"enable_subscribtion"},Fe={class:"col"},He={class:"form-check form-switch form-switch-md float-end p-2"},Te=["disabled","checked"],Ae={key:2,class:"col-sm-4"},Ne={class:"mb-3"},ze={class:"border rounded"},Ee={class:"row"},We={class:"col-8"},Ie={class:"form-check-label p-2 mt-2",for:"enable_subscribtion_and_commission"},je={class:"col"},qe={class:"form-check form-switch form-switch-md float-end p-2"},Ye=["disabled","checked"],Ge={class:"d-flex align-items-center mt-3"},Je={class:"me-2 text-muted"},Ke=["value"],Ze={class:"ms-2 text-muted"},Qe={class:"d-flex align-items-center gap-2"},Xe={class:"table-responsive"},$e={class:"table align-middle position-relative table-nowrap"},et={class:"table-active"},tt={scope:"col"},st={scope:"col"},ot={scope:"col"},at={scope:"col"},it={key:0},nt={class:"d-flex"},lt={class:"flex-grow-1"},rt={key:0},dt=["disabled","onClick","id","checked"],ct={key:1},ut={colspan:"7",class:"text-center"},mt={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},_t={class:"alert-content"},ft={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},bt={class:"alert-content"},pt={class:"offcanvas-body"},ht={class:"mb-4"},vt={for:"datepicker-range",class:"form-label text-muted text-uppercase fw-semibold mb-3"},gt={class:"form-check form-check-inline"},kt={class:"form-check-label",for:"WithoutinlineRadio2"},yt={class:"form-check form-check-inline"},Ct={class:"form-check-label",for:"WithoutinlineRadio3"},wt={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function Bt(o,t,f,s,C,O){const P=u("Head"),S=u("PageHeader"),U=u("BCardHeader"),D=u("BCard"),g=u("BRow"),w=u("BCol"),R=u("searchbar"),p=u("BButton"),N=u("Link"),z=u("BCardBody"),E=u("BFrom"),x=u("BOffcanvas"),W=u("Pagination"),I=u("Layout"),V=le("b-tooltip");return l(),h(I,null,{default:r(()=>[c(P,{title:"Subscription Code"}),c(S,{title:o.$t("subscription"),pageTitle:o.$t("subscription")},null,8,["title","pageTitle"]),c(g,null,{default:r(()=>[c(w,{lg:"12"},{default:r(()=>[f.app_for==="demo"?(l(),h(D,{key:0,"no-body":"",id:"tasksList"},{default:r(()=>[c(U,{class:"border-0"},{default:r(()=>[e("div",ge,[e("strong",null,[v(n(o.$t("note"))+" : ",1),e("em",null,n(o.$t("actions_restricted_due_to_demo_mode")),1)])])]),_:1})]),_:1})):m("",!0),c(D,{"no-body":"",id:"tasksList"},{default:r(()=>[c(U,{class:"border-0"},{default:r(()=>[c(g,null,{default:r(()=>[o.permissions.includes("add-subscription")?(l(),b("div",ke,[e("div",ye,[e("div",Ce,[e("div",we,[e("div",Be,[e("label",Me,n(o.$t("enable_commission")),1)]),e("div",Pe,[e("div",Se,[e("input",{type:"checkbox",class:"form-check-input",id:"enable_commission",disabled:f.app_for=="demo",checked:s.enabled_module==="commission",onClick:t[0]||(t[0]=M(a=>s.handleSubscriptionUpdate("commission"),["prevent"]))},null,8,xe)])])])])])])):m("",!0),o.permissions.includes("add-subscription")?(l(),b("div",Le,[e("div",Oe,[e("div",Ue,[e("div",De,[e("div",Re,[e("label",Ve,n(o.$t("enable_subscribtion")),1)]),e("div",Fe,[e("div",He,[e("input",{type:"checkbox",class:"form-check-input",disabled:f.app_for=="demo",checked:s.enabled_module==="subscription",id:"enable_subscribtion",onClick:t[1]||(t[1]=M(a=>s.handleSubscriptionUpdate("subscription"),["prevent"]))},null,8,Te)])])])])])])):m("",!0),o.permissions.includes("add-subscription")?(l(),b("div",Ae,[e("div",Ne,[e("div",ze,[e("div",Ee,[e("div",We,[e("label",Ie,n(o.$t("enable_subscribtion_and_commission")),1)]),e("div",je,[e("div",qe,[e("input",{type:"checkbox",class:"form-check-input",disabled:f.app_for=="demo",checked:s.enabled_module==="both",id:"enable_subscribtion_and_commission",onClick:t[2]||(t[2]=M(a=>s.handleSubscriptionUpdate("both"),["prevent"]))},null,8,Ye)])])])])])])):m("",!0)]),_:1}),s.enable_subscription?(l(),h(g,{key:0,class:"g-2"},{default:r(()=>[c(w,{md:"3"},{default:r(()=>[e("div",Ge,[e("label",Je,n(o.$t("show")),1),L(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>s.filter.limit=a),onChange:t[4]||(t[4]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(l(!0),b(q,null,j(s.paginatorOption,a=>(l(),b("option",{key:a,value:a},n(a),9,Ke))),128))],544),[[de,s.filter.limit]]),e("label",Ze,n(o.$t("entries")),1)])]),_:1}),c(w,{md:"auto",class:"ms-auto"},{default:r(()=>[e("div",Qe,[c(R,{onSearch:s.fetchSearch},null,8,["onSearch"]),c(p,{variant:"danger",onClick:t[5]||(t[5]=a=>s.rightOffcanvas=!0)},{default:r(()=>[t[12]||(t[12]=e("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),v(" "+n(o.$t("filters")),1)]),_:1,__:[12]}),o.permissions.includes("add-subscription")?(l(),h(N,{key:0,href:"/subscription/create"},{default:r(()=>[f.app_for!=="demo"?(l(),h(p,{key:0,variant:"primary",class:"float-end"},{default:r(()=>[t[13]||(t[13]=e("i",{class:"ri-add-line align-bottom me-1"},null,-1)),v(" "+n(o.$t("add_subscription")),1)]),_:1,__:[13]})):m("",!0)]),_:1})):m("",!0)])]),_:1})]),_:1})):m("",!0)]),_:1}),s.enable_subscription?(l(),h(z,{key:0,class:"border border-dashed border-end-0 border-start-0"},{default:r(()=>[e("div",Xe,[e("table",$e,[e("thead",et,[e("tr",null,[e("th",tt,n(o.$t("name")),1),e("th",st,n(o.$t("vehicle_type")),1),e("th",ot,n(o.$t("status")),1),e("th",at,n(o.$t("action")),1)])]),s.results.length>0?(l(),b("tbody",it,[(l(!0),b(q,null,j(s.results,(a,F)=>(l(),b("tr",{key:F},[e("td",null,[e("div",nt,[e("div",lt,n(a.name),1)])]),e("td",null,n(s.capitalizeFirstLetter(a.vehicle_type_name)),1),o.permissions.includes("toggle-subscription")?(l(),b("td",rt,[e("div",{class:ce({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[e("input",{class:"form-check-input",type:"checkbox",disabled:f.app_for=="demo",role:"switch",onClick:M(H=>s.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,dt)],2)])):m("",!0),e("td",null,[o.permissions.includes("edit-subscription")?L((l(),h(p,{key:0,onClick:M(H=>s.editData(a),["prevent"]),class:"btn btn-soft-warning btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("edit")},{default:r(()=>t[14]||(t[14]=[e("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[14]},1032,["onClick","title"])),[[V,void 0,void 0,{hover:!0}]]):m("",!0),o.permissions.includes("delete-subscription")&&f.app_for!=="demo"?L((l(),h(p,{key:1,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:M(H=>s.deleteModal(a.id),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("delete")},{default:r(()=>t[15]||(t[15]=[e("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[15]},1032,["onClick","title"])),[[V,void 0,void 0,{hover:!0}]]):m("",!0)])]))),128))])):(l(),b("tbody",ct,[e("tr",null,[e("td",ut,[t[16]||(t[16]=e("img",{src:he,alt:"Loading...",style:{width:"100px"}},null,-1)),e("h5",null,n(o.$t("no_data_found")),1)])])]))])])]),_:1})):m("",!0)]),_:1})]),_:1})]),_:1}),e("div",null,[s.successMessage?(l(),b("div",mt,[e("div",_t,[t[17]||(t[17]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[18]||(t[18]=v()),t[19]||(t[19]=e("strong",null,"Success",-1)),v(" - "+n(s.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:t[6]||(t[6]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):m("",!0),s.alertMessage?(l(),b("div",ft,[e("div",bt,[t[20]||(t[20]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[21]||(t[21]=v()),t[22]||(t[22]=e("strong",null,"Alert",-1)),v(" - "+n(s.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:t[7]||(t[7]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):m("",!0)]),c(x,{modelValue:s.rightOffcanvas,"onUpdate:modelValue":t[11]||(t[11]=a=>s.rightOffcanvas=a),placement:"end",title:o.$t("filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:r(()=>[c(E,{action:"",class:"d-flex flex-column justify-content-end h-100"},{default:r(()=>[e("div",pt,[e("div",ht,[e("label",vt,n(o.$t("status")),1),e("div",null,[e("div",gt,[L(e("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"WithoutinlineRadio2",value:"1","onUpdate:modelValue":t[8]||(t[8]=a=>s.filter.status=a)},null,512),[[Y,s.filter.status]]),e("label",kt,n(o.$t("active")),1)]),e("div",yt,[L(e("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"WithoutinlineRadio3",value:"0","onUpdate:modelValue":t[9]||(t[9]=a=>s.filter.status=a)},null,512),[[Y,s.filter.status]]),e("label",Ct,n(o.$t("inactive")),1)])])])]),e("div",wt,[c(p,{variant:"light",onClick:t[10]||(t[10]=a=>s.clearFilter()),class:"w-100"},{default:r(()=>[v(n(o.$t("clear_filter")),1)]),_:1}),c(p,{type:"submit",onClick:s.filterData,variant:"success",class:"w-100"},{default:r(()=>[v(n(o.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),s.enable_subscription?(l(),h(W,{key:0,paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])):m("",!0)]),_:1})}const Ft=$(ve,[["render",Bt]]);export{Ft as default};
