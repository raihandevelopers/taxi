import{_ as K,Z as Q,O as Z,P as X,z as ee,C as te,r as f,T as se,Q as oe,a2 as ae,a as E,R as le,g as u,S as ne,o as d,x as R,w as i,U as b,N as ie,k as r,l as t,J as l,q as k,K as $,i as m,L as W,F as z,y as h,B as C,p as re,n as I,W as j}from"./vendor-ddfbd976.js";import{L as de}from"./main-306a5ea6.js";import{P as ce}from"./page-header-2dc95532.js";import{P as ue}from"./Pagination-f095ae3c.js";import{s as me}from"./search-2c17aadd.js";import{s as fe}from"./searchbar-3acbc236.js";import{l as pe}from"./footer-e648049d.js";import{_ as _e}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const ge={data(){return{rightOffcanvas:!1}},components:{Layout:de,PageHeader:ce,Head:Q,Pagination:ue,Multiselect:Z,flatPickr:X,Link:ee,search:me,searchbar:fe},props:{successMessage:String,alertMessage:String,users:Array,promoCodes:{type:Object,required:!0}},setup(s){const{t:e}=te(),w=f(""),o=se({status:null,transport_type:null,limit:10}),v=f([]),O=f({}),B=f(!1),P=f(!1),y=f(null),_=f(s.users),S=f({}),M=f(s.successMessage||""),L=f(s.alertMessage||""),F=()=>{M.value="",L.value=""},H=async(n,c)=>{b.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async g=>{if(g.isConfirmed)try{await E.post("/promo-code/update-status",{id:n,status:c});const D=v.value.findIndex(J=>J.id===n);D!==-1&&(v.value[D].active=c),b.fire(e("changed"),e("status_updated_successfully"),"success")}catch(D){console.error(e("error_updating_status"),D),b.fire(e("error"),e("failed_to_update_status"),"error")}})},T=n=>n.charAt(0).toUpperCase()+n.slice(1),x=f(!1),A=()=>{p(),P.value=!0,x.value=!1},N=()=>{o.reset(),p(),x.value=!1},V=()=>{B.value=!1},a=async n=>{try{await E.delete(`/promo-code/delete/${n}`);const c=v.value.findIndex(g=>g.id===n);c!==-1&&v.value.splice(c,1),B.value=!1,b.fire(e("success"),e("promo_code_deleted_successfully"),"success")}catch{b.fire(e("error"),e("failed_to_delete_promo_code"),"error")}},U=async n=>{b.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async c=>{if(c.isConfirmed)try{await a(n)}catch(g){console.error(e("error_deleting_data"),g),b.fire(e("error"),e("failed_to_delete_the_data"),"error")}})};oe(w,ae.debounce(function(n){p(w.value)},300));const p=async(n=1)=>{try{const c=o.data();c.search=w.value,c.page=n;const g=await E.get("/promo-code/list",{params:c});v.value=g.data.results,O.value=g.data.paginator,G(O.value.total),P.value=!1}catch(c){console.error(e("error_fetching_promo_codes"),c)}},q=async n=>{localStorage.setItem("promo-code/list",n),p(n)},Y=async n=>{ie.get(`/promo-code/edit/${n.id}`)},G=()=>{S.value=[10,25,50,100,200,500]};return{results:v,users:_,modalShow:B,deleteItemId:y,successMessage:M,alertMessage:L,filterData:A,deleteModal:U,closeModal:V,deleteData:a,dismissMessage:F,searchTerm:w,paginator:O,modalFilter:P,clearFilter:N,fetchDatas:p,filter:o,handlePageChanged:q,editData:Y,capitalizeFirstLetter:T,toggleActiveStatus:H,rightOffcanvas:x,paginatorOption:S,changeEntriesPerPage:()=>{p()}}},computed:{...pe,...le(["permissions"])},mounted(){this.fetchDatas();const s=localStorage.getItem("promo-code/list");s?this.handlePageChanged(Number(s)):this.handlePageChanged(1)}},he={class:"d-flex align-items-center mt-3"},ve={class:"me-2 text-muted"},be=["value"],ye={class:"ms-2 text-muted"},ke={class:"d-flex align-items-center gap-2"},Ce={class:"table-responsive"},we={class:"table align-middle position-relative table-nowrap"},Be={class:"table-active"},Pe={scope:"col"},Me={scope:"col"},xe={scope:"col"},Oe={scope:"col"},Se={key:0},Le={class:"d-flex"},Ve={class:"flex-grow-1"},De={key:0},Re={key:1},Fe={key:2},He={key:0},Te=["onClick","id","checked"],Ae={key:1},Ne={colspan:"12",class:"text-center"},Ue={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ee={class:"alert-content"},Ie={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},$e={class:"alert-content"},We={class:"offcanvas-body"},ze={class:"mb-4"},je={for:"datepicker-range",class:"form-label text-muted text-uppercase fw-semibold mb-3"},qe={class:"form-check form-check-inline"},Ye={class:"form-check-label",for:"WithoutinlineRadio2"},Ge={class:"form-check form-check-inline"},Je={class:"form-check-label",for:"WithoutinlineRadio3"},Ke={class:"mb-4"},Qe={for:"datepicker-range",class:"form-label text-muted text-uppercase fw-semibold mb-3"},Ze={value:"taxi"},Xe={value:"delivery"},et={value:"both"},tt={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function st(s,e,w,o,v,O){const B=u("Head"),P=u("PageHeader"),y=u("BCol"),_=u("BButton"),S=u("Link"),M=u("BRow"),L=u("BCardHeader"),F=u("BCardBody"),H=u("BCard"),T=u("BFrom"),x=u("BOffcanvas"),A=u("Pagination"),N=u("Layout"),V=ne("b-tooltip");return d(),R(N,null,{default:i(()=>[r(B,{title:"Promo Code"}),r(P,{title:s.$t("promo_code"),pageTitle:s.$t("promo_code")},null,8,["title","pageTitle"]),r(M,null,{default:i(()=>[r(y,{lg:"12"},{default:i(()=>[r(H,{"no-body":"",id:"tasksList"},{default:i(()=>[r(L,{class:"border-0"},{default:i(()=>[r(M,{class:"g-2"},{default:i(()=>[r(y,{md:"3"},{default:i(()=>[t("div",he,[t("label",ve,l(s.$t("show")),1),k(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>o.filter.limit=a),onChange:e[1]||(e[1]=(...a)=>o.changeEntriesPerPage&&o.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(d(!0),m(z,null,W(o.paginatorOption,a=>(d(),m("option",{key:a,value:a},l(a),9,be))),128))],544),[[$,o.filter.limit]]),t("label",ye,l(s.$t("entries")),1)])]),_:1}),r(y,{md:"3"}),r(y,{md:"auto",class:"ms-auto"},{default:i(()=>[t("div",ke,[r(_,{variant:"danger",onClick:e[2]||(e[2]=a=>o.rightOffcanvas=!0)},{default:i(()=>[e[10]||(e[10]=t("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),h(" "+l(s.$t("filters")),1)]),_:1,__:[10]}),s.permissions.includes("add-promo")?(d(),R(S,{key:0,href:"/promo-code/create"},{default:i(()=>[r(_,{variant:"primary",class:"float-end"},{default:i(()=>[e[11]||(e[11]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),h(" "+l(s.$t("add_promo_code")),1)]),_:1,__:[11]})]),_:1})):C("",!0)])]),_:1})]),_:1})]),_:1}),r(F,{class:"border border-dashed border-end-0 border-start-0"},{default:i(()=>[t("div",Ce,[t("table",we,[t("thead",Be,[t("tr",null,[t("th",Pe,l(s.$t("code")),1),t("th",Me,l(s.$t("transport_type")),1),t("th",xe,l(s.$t("status")),1),t("th",Oe,l(s.$t("action")),1)])]),o.results.length>0?(d(),m("tbody",Se,[(d(!0),m(z,null,W(o.results,(a,U)=>(d(),m("tr",{key:U},[t("td",null,[t("div",Le,[t("div",Ve,l(a.code),1)])]),t("td",null,[a.transport_type==="taxi"?(d(),m("span",De,l(s.$t("taxi")),1)):a.transport_type==="delivery"?(d(),m("span",Re,l(s.$t("delivery")),1)):(d(),m("span",Fe,l(s.$t("all")),1))]),s.permissions.includes("toggle-promo")?(d(),m("td",He,[t("div",{class:re({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:I(p=>o.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,Te)],2)])):C("",!0),t("td",null,[s.permissions.includes("edit-promo")?k((d(),R(_,{key:0,onClick:I(p=>o.editData(a),["prevent"]),class:"btn btn-soft-warning btn-sm m-2","data-bs-toggle":"tooltip",title:s.$t("edit")},{default:i(()=>e[12]||(e[12]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[12]},1032,["onClick","title"])),[[V,void 0,void 0,{hover:!0}]]):C("",!0),s.permissions.includes("delete-promo")?k((d(),R(_,{key:1,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:I(p=>o.deleteModal(a.id),["prevent"]),"data-bs-toggle":"tooltip",title:s.$t("delete")},{default:i(()=>e[13]||(e[13]=[t("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[13]},1032,["onClick","title"])),[[V,void 0,void 0,{hover:!0}]]):C("",!0)])]))),128))])):(d(),m("tbody",Ae,[t("tr",null,[t("td",Ne,[e[14]||(e[14]=t("img",{src:_e,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,l(s.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[o.successMessage?(d(),m("div",Ue,[t("div",Ee,[e[15]||(e[15]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[16]||(e[16]=h()),e[17]||(e[17]=t("strong",null,"Success",-1)),h(" - "+l(o.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[3]||(e[3]=(...a)=>o.dismissMessage&&o.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):C("",!0),o.alertMessage?(d(),m("div",Ie,[t("div",$e,[e[18]||(e[18]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[19]||(e[19]=h()),e[20]||(e[20]=t("strong",null,"Alert",-1)),h(" - "+l(o.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[4]||(e[4]=(...a)=>o.dismissMessage&&o.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):C("",!0)]),r(x,{modelValue:o.rightOffcanvas,"onUpdate:modelValue":e[9]||(e[9]=a=>o.rightOffcanvas=a),placement:"end",title:s.$t("promo_filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:i(()=>[r(T,{action:"",class:"d-flex flex-column justify-content-end h-100"},{default:i(()=>[t("div",We,[t("div",ze,[t("label",je,l(s.$t("status")),1),t("div",null,[t("div",qe,[k(t("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"WithoutinlineRadio2",value:"1","onUpdate:modelValue":e[5]||(e[5]=a=>o.filter.status=a)},null,512),[[j,o.filter.status]]),t("label",Ye,l(s.$t("active")),1)]),t("div",Ge,[k(t("input",{class:"form-check-input",type:"radio",name:"inlineRadioOptions",id:"WithoutinlineRadio3",value:"0","onUpdate:modelValue":e[6]||(e[6]=a=>o.filter.status=a)},null,512),[[j,o.filter.status]]),t("label",Je,l(s.$t("inactive")),1)])])]),t("div",Ke,[t("label",Qe,l(s.$t("transport_type")),1),k(t("select",{class:"form-control","data-choices":"","data-choices-search-false":"",name:"choices-select-status",id:"choices-select-status","onUpdate:modelValue":e[7]||(e[7]=a=>o.filter.transport_type=a)},[t("option",Ze,l(s.$t("taxi")),1),t("option",Xe,l(s.$t("delivery")),1),t("option",et,l(s.$t("both")),1)],512),[[$,o.filter.transport_type]])])]),t("div",tt,[r(_,{variant:"light",onClick:e[8]||(e[8]=a=>o.clearFilter()),class:"w-100"},{default:i(()=>[h(l(s.$t("clear_filter")),1)]),_:1}),r(_,{type:"submit",onClick:o.filterData,variant:"success",class:"w-100"},{default:i(()=>[h(l(s.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),r(A,{paginator:o.paginator,onPageChanged:o.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const ft=K(ge,[["render",st]]);export{ft as default};
