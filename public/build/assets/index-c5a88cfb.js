import{_ as Z,Z as G,r as m,T as z,Q as W,a2 as X,a as F,g as c,o as g,x as $,w as n,U as V,k as a,l as o,q as M,M as N,ad as ee,y as u,i as b,L as te,J as p,n as D,F as oe,B as R,p as I,K as Y}from"./vendor-ddfbd976.js";import{L as le}from"./main-306a5ea6.js";import{P as se}from"./page-header-2dc95532.js";import{P as re}from"./Pagination-f095ae3c.js";import"./footer-e648049d.js";import"./app-042fb454.js";const ae={components:{Layout:le,PageHeader:se,Head:G,Pagination:re},props:{successMessage:String,alertMessage:String},setup(P){const e=m(""),v=m(null),t=z({name:"",description:""}),_=z({all:"",locked:""}),y=m([]),B=m({}),C=m(!1),f=m(!1),i=m(!1),w=m(null),x=m(P.successMessage||""),S=m(P.alertMessage||""),h=()=>{x.value="",S.value=""},E=()=>{t.reset(),v.value=null,f.value=!0},U=()=>{i.value=!0},H=r=>{v.value=r,t.name=r.name,t.description=r.description,t.clearErrors(),f.value=!0},l=()=>{t.reset(),f.value=!1,v.value=null},K=()=>{_.reset(),k(),i.value=!1},T=()=>{const{name:r,description:s}=t,d={},A={name:{test:()=>!r,message:"Role name is required"},description:{test:()=>!s,message:"Role description is required"}};return Object.keys(A).forEach(L=>{A[L].test()&&(d[L]=A[L].message)}),d},j=async()=>{const r=T();if(Object.keys(r).length===0)try{let s;v.value?s=await F.put(`/roles/update/${v.value.id}`,t.data()):s=await F.post("/roles",t.data()),s.status===200||s.status===201?(x.value=s.data.successMessage,k(),f.value=!1,t.reset()):console.error("Unexpected response status:",s.status)}catch(s){if(console.error("Error handling form submission:",s),s.response&&s.response.status===422){const d=s.response.data.errors;t.errors=d}else console.error("An unexpected error occurred:",s)}else t.errors=r},O=r=>{t.errors[r]=""},J=()=>{C.value=!1},q=async r=>{try{await F.delete(`/roles/delete/${r}`);const s=y.value.findIndex(d=>d.id===r);s!==-1&&y.value.splice(s,1),C.value=!1,V.fire("Success","Role deleted successfully","success")}catch(s){console.error("Error deleting role:",s),V.fire("Error","Failed to delete role","error")}},Q=async r=>{V.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async s=>{if(s.isConfirmed)try{await q(r)}catch(d){console.error("Error deleting role:",d),V.fire("Error","Failed to delete the role","error")}})};W(e,X.debounce(function(r){k(e.value)},300));const k=async(r=1)=>{try{const s=_.data();s.search=e.value,s.page=r;const d=await F.get("/roles1/list",{params:s});y.value=d.data.roles,B.value=d.data.paginator,i.value=!1}catch(s){console.error("Error fetching roles:",s)}};return{form:t,roles:y,modalShow:C,modalForm:f,deleteItemId:w,selectedRole:v,successMessage:x,alertMessage:S,createRole:E,filterRole:U,editRole:H,cancelEdit:l,handleSubmit:j,deleteModal:Q,closeModal:J,deleteRole:q,dismissMessage:h,hideError:O,searchTerm:e,paginator:B,modalFilter:i,clearFilter:K,fetchRoles:k,filter:_,handlePageChanged:async r=>{k(r)}}},mounted(){this.fetchRoles()}},ne={class:"search-box"},ie={class:"d-flex align-items-center gap-2"},de={class:"table table-bordered align-middle table-nowrap mb-0"},ce={class:"d-flex"},me={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},ue={class:"alert-content"},fe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},ge={class:"alert-content"},ve={class:"form-group mt-3"},be={key:0,class:"text-danger"},pe={class:"form-group mt-3"},ye={key:0,class:"text-danger"},Ce={type:"submit",class:"btn btn-success m-2 float-end"},xe={class:"input-group"};function ke(P,e,v,t,_,y){const B=c("Head"),C=c("PageHeader"),f=c("BCol"),i=c("BButton"),w=c("BRow"),x=c("BCardHeader"),S=c("BCardBody"),h=c("BCard"),E=c("BModal"),U=c("Pagination"),H=c("Layout");return g(),$(H,null,{default:n(()=>[a(B,{title:"Roles"}),a(C,{title:"Roles",pageTitle:"Masters"}),a(w,null,{default:n(()=>[a(f,{lg:"12"},{default:n(()=>[a(h,{"no-body":"",id:"tasksList"},{default:n(()=>[a(x,{class:"border-0"},{default:n(()=>[a(w,{class:"g-2"},{default:n(()=>[a(f,{md:"3"},{default:n(()=>[o("div",ne,[M(o("input",{type:"text",id:"name",class:"form-control search",placeholder:"Search roles...","onUpdate:modelValue":e[0]||(e[0]=l=>t.searchTerm=l),onKeyup:e[1]||(e[1]=ee((...l)=>t.fetchRoles&&t.fetchRoles(...l),["enter"]))},null,544),[[N,t.searchTerm]]),e[15]||(e[15]=o("i",{class:"ri-search-line search-icon"},null,-1))])]),_:1}),a(f,{md:"auto",class:"ms-auto"},{default:n(()=>[o("div",ie,[a(i,{variant:"danger",onClick:t.filterRole},{default:n(()=>e[16]||(e[16]=[o("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1),u(" Filters")])),_:1,__:[16]},8,["onClick"]),a(i,{variant:"primary",onClick:t.createRole,class:"float-end"},{default:n(()=>e[17]||(e[17]=[o("i",{class:"ri-add-line align-bottom me-1"},null,-1),u(" Create Role")])),_:1,__:[17]},8,["onClick"])])]),_:1})]),_:1})]),_:1}),a(S,{class:"border border-dashed border-end-0 border-start-0"},{default:n(()=>[o("table",de,[e[20]||(e[20]=o("thead",{class:"table-light"},[o("tr",null,[o("th",null,"Role Name"),o("th",null,"description"),o("th",null,"Action")])],-1)),o("tbody",null,[(g(!0),b(oe,null,te(t.roles,(l,K)=>(g(),b("tr",{key:l.id},[o("td",null,p(l.name),1),o("td",null,p(l.description),1),o("td",null,[o("div",ce,[a(i,{onClick:D(T=>t.editRole(l),["prevent"]),class:"btn btn-soft-warning btn-sm m-2"},{default:n(()=>e[18]||(e[18]=[o("i",{class:"bx bxs-edit-alt"},null,-1)])),_:2,__:[18]},1032,["onClick"]),a(i,{class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",id:"sa-warning",onClick:D(T=>t.deleteModal(l.id),["prevent"])},{default:n(()=>e[19]||(e[19]=[o("i",{class:"bx bx-trash"},null,-1)])),_:2,__:[19]},1032,["onClick"])])])]))),128))])])]),_:1})]),_:1})]),_:1})]),_:1}),o("div",null,[t.successMessage?(g(),b("div",me,[o("div",ue,[e[21]||(e[21]=o("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[22]||(e[22]=u()),e[23]||(e[23]=o("strong",null,"Success",-1)),u(" - "+p(t.successMessage)+" ",1),o("button",{type:"button",class:"btn-close btn-close-success",onClick:e[2]||(e[2]=(...l)=>t.dismissMessage&&t.dismissMessage(...l)),"aria-label":"Close Success Message"})])])):R("",!0),t.alertMessage?(g(),b("div",fe,[o("div",ge,[e[24]||(e[24]=o("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[25]||(e[25]=u()),e[26]||(e[26]=o("strong",null,"Alert",-1)),u(" - "+p(t.alertMessage)+" ",1),o("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[3]||(e[3]=(...l)=>t.dismissMessage&&t.dismissMessage(...l)),"aria-label":"Close Alert Message"})])])):R("",!0)]),a(E,{modelValue:t.modalForm,"onUpdate:modelValue":e[11]||(e[11]=l=>t.modalForm=l),"hide-footer":"",title:t.selectedRole?"Update Role":"Create Role",class:"v-modal-custom"},{default:n(()=>[o("form",{onSubmit:e[9]||(e[9]=D((...l)=>t.handleSubmit&&t.handleSubmit(...l),["prevent"])),onKeydown:e[10]||(e[10]=(...l)=>t.hideError&&t.hideError(...l))},[o("div",ve,[e[27]||(e[27]=o("label",{for:"name",class:"form-label"},[u("Role Name"),o("span",{class:"text-danger"},"*")],-1)),M(o("input",{type:"text",id:"name","onUpdate:modelValue":e[4]||(e[4]=l=>t.form.name=l),class:I(["form-control",{"is-invalid":t.form.errors.name}]),onFocus:e[5]||(e[5]=l=>t.hideError("name"))},null,34),[[N,t.form.name]]),t.form.errors.name?(g(),b("div",be,p(t.form.errors.name),1)):R("",!0)]),o("div",pe,[e[28]||(e[28]=o("label",{for:"description",class:"form-label"},[u("description"),o("span",{class:"text-danger"},"*")],-1)),M(o("input",{type:"text",id:"description","onUpdate:modelValue":e[6]||(e[6]=l=>t.form.description=l),class:I(["form-control",{"is-invalid":t.form.errors.description}]),onFocus:e[7]||(e[7]=l=>t.hideError("description"))},null,34),[[N,t.form.description]]),t.form.errors.description?(g(),b("div",ye,p(t.form.errors.description),1)):R("",!0)]),o("button",Ce,p(t.selectedRole?"Update":"Save"),1),t.selectedRole?(g(),b("button",{key:0,type:"button",onClick:e[8]||(e[8]=(...l)=>t.cancelEdit&&t.cancelEdit(...l)),class:"btn btn-secondary m-2 float-end"},"Cancel")):R("",!0)],32)]),_:1},8,["modelValue","title"]),a(E,{modelValue:t.modalFilter,"onUpdate:modelValue":e[14]||(e[14]=l=>t.modalFilter=l),"hide-footer":"","dialog-class":"modal-dialog-right",title:"Filter",class:"v-modal-custom",size:"sm"},{default:n(()=>[o("form",null,[o("div",xe,[M(o("select",{class:"form-select mb-3","aria-label":"Default select example","onUpdate:modelValue":e[12]||(e[12]=l=>t.filter.all=l)},e[29]||(e[29]=[o("option",{selected:""},"Select Status",-1),o("option",{value:"1"},"Yes",-1),o("option",{value:"0"},"No",-1)]),512),[[Y,t.filter.all]]),M(o("select",{class:"form-select mb-3","aria-label":"Default select example","onUpdate:modelValue":e[13]||(e[13]=l=>t.filter.locked=l)},e[30]||(e[30]=[o("option",{selected:""},"Select Status",-1),o("option",{value:"0"},"Inactive",-1),o("option",{value:"1"},"Active",-1)]),512),[[Y,t.filter.locked]])]),a(i,{variant:"primary",class:"float-end",onClick:t.fetchRoles},{default:n(()=>e[31]||(e[31]=[u(" Apply")])),_:1,__:[31]},8,["onClick"]),a(i,{variant:"outline-primary",class:"float-end mx-2",onClick:t.clearFilter},{default:n(()=>e[32]||(e[32]=[u("Clear")])),_:1,__:[32]},8,["onClick"])])]),_:1},8,["modelValue"]),a(U,{paginator:t.paginator,onPageChanged:t.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const Fe=Z(ae,[["render",ke]]);export{Fe as default};
