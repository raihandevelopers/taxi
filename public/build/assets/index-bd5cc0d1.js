import{_ as U,Z as q,O as z,P as Y,z as j,C as G,r as f,T as J,Q as K,a2 as Q,a as I,R as Z,g as c,S as W,o as u,x as E,w as r,U as w,N as X,k as l,l as t,J as n,q as V,K as $,i as m,L as F,F as A,y as P,B as x,n as ee}from"./vendor-ddfbd976.js";import{L as te}from"./main-306a5ea6.js";import{P as se}from"./page-header-2dc95532.js";import{P as ae}from"./Pagination-f095ae3c.js";import{s as oe}from"./search-2c17aadd.js";import{s as ne}from"./searchbar-3acbc236.js";import{l as le}from"./footer-e648049d.js";import{_ as ie}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const re={data(){return{rightOffcanvas:!1}},components:{Layout:te,PageHeader:se,Head:q,Pagination:ae,Multiselect:z,flatPickr:Y,Link:j,search:oe,searchbar:ne},props:{successMessage:String,alertMessage:String,serviceLocations:{type:Object,required:!0}},setup(o){const{t:e}=G(),h=f(""),a=J({all:"",locked:"",limit:10}),v=f([]),B=f({}),b=f(!1),g=f(!1),_=f(null),y=f({}),M=f(o.successMessage||""),C=f(o.alertMessage||""),L=()=>{M.value="",C.value=""},S=()=>{g.value=!0},D=()=>{a.reset(),s(),g.value=!1},H=()=>{b.value=!1},k=async i=>{try{await I.delete(`/push-notifications/delete/${i}`);const d=v.value.findIndex(p=>p.id===i);d!==-1&&v.value.splice(d,1),b.value=!1,w.fire(e("success"),e("push_notification_deleted_successfully"),"success")}catch{w.fire(e("error"),e("failed_to_delete_push_notification"),"error")}},N=async i=>{w.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async d=>{if(d.isConfirmed)try{await k(i)}catch(p){console.error(e("error_deleting_data"),p),w.fire(e("error"),e("failed_to_delete_the_data"),"error")}})};K(h,Q.debounce(function(i){s(h.value)},300));const s=async(i=1)=>{try{const d=a.data();d.search=h.value,d.page=i;const p=await I.get("/push-notifications/list",{params:d});v.value=p.data.results.data,B.value=p.data.results,R(B.value.total),g.value=!1}catch(d){console.error(e("error_fetching_push_notifications"),d)}},O=async i=>{localStorage.setItem("push-notifications/list",i),s(i)},T=async i=>{X.get(`/push-notifications/edit/${i.id}`)},R=()=>{y.value=[10,25,50,100,200,500]};return{results:v,modalShow:b,deleteItemId:_,successMessage:M,alertMessage:C,filterData:S,deleteModal:N,closeModal:H,deleteData:k,dismissMessage:L,searchTerm:h,paginator:B,modalFilter:g,clearFilter:D,fetchDatas:s,filter:a,handlePageChanged:O,editData:T,paginatorOption:y,changeEntriesPerPage:()=>{s()}}},computed:{...le,...Z(["permissions"])},mounted(){this.fetchDatas();const o=localStorage.getItem("push-notifications/list");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},de={class:"d-flex align-items-center mt-3"},ce={class:"me-2 text-muted"},ue=["value"],fe={class:"ms-2 text-muted"},me={class:"d-flex align-items-center gap-2"},ge={class:"table-responsive"},_e={class:"table align-middle position-relative table-nowrap"},pe={class:"table-active"},he={scope:"col"},ve={scope:"col"},be={scope:"col"},ye={scope:"col"},Ce={key:0},Pe={key:1},Be={colspan:"7",class:"text-center"},Me={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},ke={class:"alert-content"},we={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},xe={class:"alert-content"};function Le(o,e,h,a,v,B){const b=c("Head"),g=c("PageHeader"),_=c("BCol"),y=c("BButton"),M=c("Link"),C=c("BRow"),L=c("BCardHeader"),S=c("BCardBody"),D=c("BCard"),H=c("Pagination"),k=c("Layout"),N=W("b-tooltip");return u(),E(k,null,{default:r(()=>[l(b,{title:"Push Notifications"}),l(g,{title:o.$t("send_notifications"),pageTitle:o.$t("send_notifications")},null,8,["title","pageTitle"]),l(C,null,{default:r(()=>[l(_,{lg:"12"},{default:r(()=>[l(D,{"no-body":"",id:"tasksList"},{default:r(()=>[l(L,{class:"border-0"},{default:r(()=>[l(C,{class:"g-2"},{default:r(()=>[l(_,{md:"3"},{default:r(()=>[t("div",de,[t("label",ce,n(o.$t("show")),1),V(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.filter.limit=s),onChange:e[1]||(e[1]=(...s)=>a.changeEntriesPerPage&&a.changeEntriesPerPage(...s)),class:"form-select form-select-sm w-auto"},[(u(!0),m(A,null,F(a.paginatorOption,s=>(u(),m("option",{key:s,value:s},n(s),9,ue))),128))],544),[[$,a.filter.limit]]),t("label",fe,n(o.$t("entries")),1)])]),_:1}),l(_,{md:"3"}),l(_,{md:"auto",class:"ms-auto"},{default:r(()=>[t("div",me,[o.permissions.includes("add-notifications")?(u(),E(M,{key:0,href:"/push-notifications/create"},{default:r(()=>[l(y,{variant:"primary",class:"float-end"},{default:r(()=>[e[4]||(e[4]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),P(" "+n(o.$t("add_push_notifications")),1)]),_:1,__:[4]})]),_:1})):x("",!0)])]),_:1})]),_:1})]),_:1}),l(S,{class:"border border-dashed border-end-0 border-start-0"},{default:r(()=>[t("div",ge,[t("table",_e,[t("thead",pe,[t("tr",null,[t("th",he,n(o.$t("push_title")),1),t("th",ve,n(o.$t("message")),1),t("th",be,n(o.$t("user_type")),1),t("th",ye,n(o.$t("action")),1)])]),a.results.length>0?(u(),m("tbody",Ce,[(u(!0),m(A,null,F(a.results,(s,O)=>(u(),m("tr",{key:O},[t("td",null,n(s.title),1),t("td",null,n(s.body),1),t("td",null,n(s.for_user?"User":s.for_driver?"Driver":"Owner"),1),t("td",null,[o.permissions.includes("delete-notifications")?V((u(),E(y,{key:0,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:ee(T=>a.deleteModal(s.id),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("delete")},{default:r(()=>e[5]||(e[5]=[t("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[5]},1032,["onClick","title"])),[[N,void 0,void 0,{hover:!0}]]):x("",!0)])]))),128))])):(u(),m("tbody",Pe,[t("tr",null,[t("td",Be,[e[6]||(e[6]=t("img",{src:ie,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,n(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[a.successMessage?(u(),m("div",Me,[t("div",ke,[e[7]||(e[7]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[8]||(e[8]=P()),e[9]||(e[9]=t("strong",null,"Success",-1)),P(" - "+n(a.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[2]||(e[2]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):x("",!0),a.alertMessage?(u(),m("div",we,[t("div",xe,[e[10]||(e[10]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[11]||(e[11]=P()),e[12]||(e[12]=t("strong",null,"Alert",-1)),P(" - "+n(a.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[3]||(e[3]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):x("",!0)]),l(H,{paginator:a.paginator,onPageChanged:a.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const Ae=U(re,[["render",Le]]);export{Ae as default};
