import{_ as C,ae as B,af as j,ag as A,ah as G,r as i,Q as y,g as O,o as r,i as I,k as U,w as M,x as _,B as x,F as L,L as P}from"./vendor-ddfbd976.js";const F={name:"googleMap",components:{GoogleMap:B,Polyline:j,AdvancedMarker:A,InfoWindow:G},props:{pick_location:Object,default_location:Object,drop_location:Object,polyline:String,map_key:String,baseUrl:String,current_location:Object,libraries:Array,stops:{type:Array,default:[]},nearbyDrivers:{type:Object,default:{}},draggable:{type:Boolean,default:!1}},setup(n){const u=i(null),k=i(n.default_location),t=i(n.pick_location),d=i(n.drop_location),b=i(n.stops),c=i(n.nearbyDrivers),h=i([]),p=i(null),v=i(null),l=i([]),s=i(null),m=i(n.polyline),w=i([]),f=async()=>{if(!window.google||!window.google.maps){console.warn("Google Maps API not yet loaded");return}const a=window.google.maps;if(l.value=[],h.value=[],w.value=[],s.value=new a.LatLngBounds,t.value&&d.value&&(s.value=new a.LatLngBounds),t.value){const e=document.createElement("img");e.src=n.baseUrl+"/image/map/pickup.png",e.style.width="30px",e.style.height="30px";const o=n.pick_location;p.value={content:e,position:o,gmpDraggable:n.draggable},t.value&&s.value.extend(o)}else p.value=null;if(d.value){const e=document.createElement("img");e.src=n.baseUrl+"/image/map/drop.png",e.style.width="30px",e.style.height="30px";const o=d.value;d.value&&s.value.extend(o),v.value={content:e,position:o,gmpDraggable:n.draggable}}else v.value=null;if(b.value&&b.value.forEach((e,o)=>{const g=document.createElement("img");g.src=n.baseUrl+"/image/map/"+o+".png",g.style.width="30px",g.style.height="30px";const D={position:{lat:e.lat,lng:e.lng},content:g,gmpDraggable:n.draggable};e.lat&&e.lng&&s.value.extend({lat:e.lat,lng:e.lng}),l.value.push({options:D})}),m.value){const e=new a.geometry.encoding.decodePath(m.value);w.value=e.map(o=>({lat:o.lat(),lng:o.lng()})),t.value&&d.value&&w.value.forEach(o=>s.value.extend(o))}c.value&&Object.keys(c.value).length>0&&Object.values(c.value).forEach(e=>{const o=document.createElement("img");o.src=n.baseUrl+`/image/map/${e.type_icon}.png`,o.style.width="30px",o.style.height="30px",e.rotation!==void 0&&(o.style.transform=`rotate(${e.rotation}deg)`);const g={position:{lat:e.lat,lng:e.lng},content:o};h.value.push({options:g,showInfo:!1})}),(t.value||d.value)&&u.value.map.fitBounds(s.value)};return y(()=>{var a;return(a=u.value)==null?void 0:a.ready},async a=>{a&&await f()}),y(()=>n.pick_location,a=>{t.value=a,f()}),y(()=>n.drop_location,a=>{d.value=a,f()}),y(()=>n.stops,a=>{b.value=a,f()}),y(()=>n.nearbyDrivers,a=>{c.value=a,f()},{deep:!0}),y(()=>n.polyline,()=>{m.value=n.polyline,f()}),{default_location:k,pickOption:p,dropOption:v,stopOptions:l,pathCoordinates:w,driverOptions:h,handleDragEnd:(a,e,o=null)=>{const g=a.latLng.lat(),D=a.latLng.lng(),E={lat:g,lng:D};e=="pickup"?p.value.position=E:e=="drop"?v.value.position=E:l.value[o].position=E},mapRef:u}}},S={class:"map-container"};function W(n,u,k,t,d,b){const c=O("AdvancedMarker"),h=O("InfoWindow"),p=O("Polyline"),v=O("GoogleMap",!0);return r(),I("div",S,[U(v,{ref:"mapRef","api-key":k.map_key,mapId:"DEMO_MAP_ID",style:{width:"100%",height:"100%"},center:t.default_location,zoom:12,libraries:k.libraries},{default:M(()=>[t.pickOption?(r(),_(c,{key:0,options:t.pickOption,onDragend:u[0]||(u[0]=l=>t.handleDragEnd(l,"pickup"))},null,8,["options"])):x("",!0),t.dropOption?(r(),_(c,{key:1,options:t.dropOption,onDragend:u[1]||(u[1]=l=>t.handleDragEnd(l,"drop"))},null,8,["options"])):x("",!0),(r(!0),I(L,null,P(t.stopOptions,(l,s)=>(r(),_(c,{key:s,options:l.options,onDragend:m=>t.handleDragEnd(m,"stop",s)},null,8,["options","onDragend"]))),128)),(r(!0),I(L,null,P(t.driverOptions,(l,s)=>(r(),_(c,{key:"drv"+s,options:l.options,onClick:m=>l.showInfo=!l.showInfo},{default:M(()=>[l.showInfo?(r(),_(h,{key:0,options:{content:l.info},open:!0},null,8,["options"])):x("",!0)]),_:2},1032,["options","onClick"]))),128)),t.pathCoordinates.length?(r(),_(p,{key:2,options:{path:t.pathCoordinates,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:4}},null,8,["options"])):x("",!0)]),_:1},8,["api-key","center","libraries"])])}const V=C(F,[["render",W]]);export{V as g};
