import{_ as B,Z as I,C as O,r as p,T as P,D as G,g as M,o as u,x as j,w as z,a as C,X as i,N as D,k as T,l as e,n as J,y as E,J as l,q as x,K as U,i as g,L as K,F as R,B as S,M as X}from"./vendor-ddfbd976.js";import{L as Z}from"./main-306a5ea6.js";import{P as Q}from"./page-header-2dc95532.js";import{u as W}from"./footer-e648049d.js";import"./app-042fb454.js";const Y={components:{Layout:Z,PageHeader:Q,Head:I},props:{successMessage:String,alertMessage:String,default_lat:String,default_lng:String,languages:Array},setup(n){const{t}=O(),{languages:y,fetchData:a}=W(),h=p("English"),c=P({service_location_id:"",name:""}),b=p(parseFloat(n.default_lat)),w=p(parseFloat(n.default_lng)),f=p(n.successMessage||""),s=p(n.alertMessage||""),k=p([]);let d=[];const N=async()=>{const o=await C.get("list");k.value=o.data.results},F=()=>{const o=i.map("map").setView({lat:b.value,lng:w.value},10);i.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(o);const r=new i.FeatureGroup;o.addLayer(r);const L=new i.Control.Draw({draw:{polygon:!0,polyline:!1,rectangle:!1,circle:!1,marker:!1},edit:{featureGroup:new i.FeatureGroup().addTo(o)}});o.addControl(L),o.on(i.Draw.Event.CREATED,v=>{const _=v.layer;d.push(_),r.addLayer(_),o.addLayer(_)}),o.on(i.Draw.Event.DELETED,function(v){v.layers.eachLayer(function(m){console.log("Deleted layer:",m),d=d.filter(q=>q!==m)})})},V=async()=>{const o=H();if(Object.keys(o).length===0)try{if(d.length===0){s.value=t("at_least_one_completed_polygon_is_required");return}const r=d.map(_=>_.getLatLngs()[0].map(m=>[m.lng,m.lat])),L={...c.data(),coordinates:JSON.stringify(r)};(await C.post("store",L)).status===201?(f.value=t("airport_created_successfully"),c.reset(),D.get("/airport")):s.value=t("failed_to_create_airport")}catch(r){r.response&&r.response.status===403?(s.value=r.response.data.alertMessage,setTimeout(()=>{D.get("/airport")},5e3)):(console.error(t("error_creating_airport"),r),s.value=t("failed_to_create_airport_catch"))}else c.errors=o},A=o=>{h.value=o};G(async()=>{Object.keys(y).length==0&&await a(),F(),N()});const H=()=>{const{service_location_id:o}=c,r={};return o?delete r.service_location_id:r.service_location_id=t("service_location_is_required"),d.length===0?r.coordinates=t("at_least_one_completed_polygon_is_required"):delete r.coordinates,r};return{form:c,successMessage:f,alertMessage:s,handleSubmit:V,serviceLocations:k,setActiveTab:A,activeTab:h,languages:y}}},$={class:"row"},ee={class:"col-lg-6"},te={class:"card"},se={class:"card-body"},oe={class:"mb-3"},ae={for:"service_location",class:"form-label"},re={value:"",disabled:""},ne=["value"],le={key:0,class:"text-danger"},ie={class:"mb-3"},ce={for:"name",class:"form-label"},de={class:"text-end"},_e={type:"submit",class:"btn btn-primary"},pe={class:"mb-3"},ue={key:0,class:"text-danger"},me={class:"col-lg-6"},ge={class:"card"},fe={class:"card-body"},ve=["placeholder"],ye={key:0,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},he={class:"alert-content"};function be(n,t,y,a,h,c){const b=M("Head"),w=M("PageHeader"),f=M("Layout");return u(),j(f,null,{default:z(()=>[T(b,{title:"Airport"}),T(w,{title:n.$t("create"),pageTitle:n.$t("airport"),pageLink:"/airport"},null,8,["title","pageTitle"]),e("div",$,[e("div",ee,[e("div",te,[e("div",se,[e("form",{onSubmit:t[2]||(t[2]=J((...s)=>a.handleSubmit&&a.handleSubmit(...s),["prevent"]))},[e("div",oe,[e("label",ae,[E(l(n.$t("service_location"))+" ",1),t[4]||(t[4]=e("span",{class:"text-danger"},"*",-1))]),x(e("select",{class:"form-select",id:"service_location","onUpdate:modelValue":t[0]||(t[0]=s=>a.form.service_location_id=s)},[e("option",re,l(n.$t("select_service_location")),1),(u(!0),g(R,null,K(a.serviceLocations,s=>(u(),g("option",{key:s.id,value:s.id},l(s.name),9,ne))),128))],512),[[U,a.form.service_location_id]]),a.form.errors.service_location_id?(u(),g("span",le,l(a.form.errors.service_location_id),1)):S("",!0)]),e("div",ie,[e("label",ce,l(n.$t("name")),1),x(e("input",{type:"text",class:"form-control",placeholder:"Enter Name",id:"name","onUpdate:modelValue":t[1]||(t[1]=s=>a.form.name=s),required:""},null,512),[[X,a.form.name]])]),e("div",de,[e("button",_e,l(n.$t("save")),1)]),e("div",pe,[a.form.errors.coordinates?(u(),g("span",ue,l(a.form.errors.coordinates),1)):S("",!0)])],32)])])]),e("div",me,[e("div",ge,[e("div",fe,[e("input",{id:"pac-input",class:"form-control",type:"text",placeholder:n.$t("search_for_a_city"),ref:"autocompleteInput"},null,8,ve),t[5]||(t[5]=e("div",{id:"map",style:{height:"400px"}},null,-1))])])])]),a.alertMessage?(u(),g("div",ye,[e("div",he,[t[6]||(t[6]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[7]||(t[7]=e("strong",null,"Alert",-1)),E(" - "+l(a.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:t[3]||(t[3]=(...s)=>n.dismissMessage&&n.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):S("",!0)]),_:1})}const Ce=B(Y,[["render",be],["__scopeId","data-v-b91f435a"]]);export{Ce as default};
