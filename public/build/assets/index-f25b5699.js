import{_ as T,Z as N,O as A,P as q,C as E,T as j,r as u,Q as O,a as R,G,g as _,o as n,x as I,w as p,N as J,k as m,l as e,J as a,q as v,K as B,i as d,L as k,F as w,B as g,W as H,y as C,n as K}from"./vendor-ddfbd976.js";import{L as Q}from"./main-306a5ea6.js";import{P as W}from"./page-header-2dc95532.js";import{P as Y}from"./Pagination-f095ae3c.js";import{i as Z}from"./imageUpload-4f5efd67.js";import{F as x}from"./FormValidation-a9047131.js";import"./footer-e648049d.js";import"./app-042fb454.js";/* empty css                                                    */const z={components:{Layout:Q,PageHeader:W,Head:N,Pagination:Y,Multiselect:A,FormValidation:x,imageUpload:Z,flatPickr:q},props:{successMessage:String,alertMessage:String,validate:Function,owners:Array},setup(l){const{t:s}=E(),c=j({date:"",trip_status:"0",select_date_option:"",file_format:"",owner:null,fleet_id:null}),t=u([]),F={select_date_option:{required:!0},file_format:{required:!0}};O(()=>c.owner,i=>{i?V(i):t.value=[]});const V=async i=>{try{const o=await R.get(`/report/list-fleets?owner_id=${i}`);t.value=o.data.fleets.map(r=>({...r,fleetLabel:`${r.id} - ${r.vehicleType?r.vehicleType.vehicle_type_name:"Unknown"}`}))}catch(o){console.error("Error fetching fleets:",o),f.value.select_fleet=[s("failed_to_load_fleets")]}},M=u(null),f=u({}),b=u(l.successMessage||""),h=u(l.alertMessage||""),D=()=>{b.value="",h.value=""},y=u(!1),L=async()=>{if(f.value=M.value.validate(),!(Object.keys(f.value).length>0)){y.value=!0;try{console.log("Form Data:",c.data());const i=await R.post("/report/fleet-report-download",c.data(),{responseType:"blob"}),o=window.URL.createObjectURL(new Blob([i.data])),r=document.createElement("a");r.href=o,r.setAttribute("download",`fleet_report.${c.file_format}`),document.body.appendChild(r),r.click(),r.remove(),b.value=s("report_downloaded_successfully"),c.reset(),J.get("/report/fleet-report")}catch(i){i.response&&i.response.status===422?f.value=i.response.data.errors:(console.error(s("error_downloading_report"),i),h.value=s("failed_to_download_report"))}finally{y.value=!1}}},S=G(()=>{if(c.date&&c.date.length===2){const i=new Date(c.date[0]),o=new Date(c.date[1]),r=i.toLocaleString("default",{month:"short"}),P=o.toLocaleString("default",{month:"short"});return`${i.getDate()} ${r} - ${o.getDate()} ${P}`}return""});return{form:c,successMessage:b,alertMessage:h,handleSubmit:L,dismissMessage:D,validationRules:F,validationRef:M,errors:f,formattedDate:S,rangeDateconfig:{mode:"range",dateFormat:"d M, Y",maxDate:"today"},owners:l.owners,fleets:t,fetchFleets:V,loading:y}}},X={class:"row"},$={class:"col-sm-6"},ee={class:"mb-3"},te={for:"owner",class:"form-label"},oe={disabled:"",value:""},se=["value"],ae={key:0,class:"text-danger"},le={class:"col-sm-6"},re={class:"mb-3"},ne={for:"fleet_id",class:"form-label"},ie={disabled:"",value:""},de=["value"],ce={key:0,class:"text-danger"},_e={class:"col-sm-6"},me={class:"mb-3"},fe={for:"trip_status",class:"form-label"},ue={class:"mt-3"},pe={class:"form-check form-check-inline"},ve={class:"form-check-label",for:"completed"},ge={class:"form-check form-check-inline"},be={class:"form-check-label",for:"cancelled"},he={key:0,class:"text-danger"},ye={class:"col-sm-6"},ke={class:"mb-3"},we={for:"select_date_option",class:"form-label"},Me={disabled:"",value:""},Be={value:"today"},Ce={value:"this_week"},Ve={value:"this_month"},De={value:"this_year"},Le={value:"date"},Se={key:0,class:"col-sm-6"},Fe={class:"mb-4"},Ue={for:"datepicker-range",class:"form-label"},Re={class:"col-sm-6"},He={class:"mb-3"},Pe={for:"file_format",class:"form-label"},Te={disabled:"",selected:"",value:""},Ne={value:"xlsx"},Ae={value:"csv"},qe={class:"col-lg-12"},Ee={class:"text-end"},je=["disabled"],Oe={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},Ge={class:"alert-content"},Ie={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},Je={class:"alert-content"};function Ke(l,s,c,t,F,V){const M=_("Head"),f=_("PageHeader"),b=_("BCardHeader"),h=_("flat-pickr"),D=_("FormValidation"),y=_("BCardBody"),L=_("BCard"),S=_("BCol"),U=_("BRow"),i=_("Layout");return n(),I(i,null,{default:p(()=>[m(M,{title:"Fleet Report"}),m(f,{title:l.$t("fleet_finance_report"),pageTitle:l.$t("fleet_report")},null,8,["title","pageTitle"]),m(U,null,{default:p(()=>[m(S,{lg:"12"},{default:p(()=>[m(L,{"no-body":"",id:"tasksList"},{default:p(()=>[m(b,{class:"border-0"}),m(y,{class:"border border-dashed border-end-0 border-start-0"},{default:p(()=>[e("form",{onSubmit:s[7]||(s[7]=K((...o)=>t.handleSubmit&&t.handleSubmit(...o),["prevent"]))},[m(D,{form:t.form,rules:t.validationRules,ref:"validationRef"},{default:p(()=>[e("div",X,[e("div",$,[e("div",ee,[e("label",te,a(l.$t("owner")),1),v(e("select",{id:"owner",class:"form-select","onUpdate:modelValue":s[0]||(s[0]=o=>t.form.owner=o)},[e("option",oe,a(l.$t("select")),1),(n(!0),d(w,null,k(t.owners,o=>(n(),d("option",{key:o.id,value:o.id},a(o.name),9,se))),128))],512),[[B,t.form.owner]]),t.errors.owner?(n(),d("span",ae,a(t.errors.owner),1)):g("",!0)])]),e("div",le,[e("div",re,[e("label",ne,a(l.$t("fleet_id")),1),v(e("select",{id:"fleet_id",class:"form-select","onUpdate:modelValue":s[1]||(s[1]=o=>t.form.fleet_id=o)},[e("option",ie,a(l.$t("select")),1),(n(!0),d(w,null,k(t.fleets,o=>(n(),d("option",{key:o.id,value:o.id},a(o.vehicle_type_name),9,de))),128))],512),[[B,t.form.fleet_id]]),t.errors.fleet_id?(n(),d("span",ce,a(t.errors.fleet_id),1)):g("",!0)])]),e("div",_e,[e("div",me,[e("label",fe,a(l.$t("trip_status")),1),e("div",ue,[e("div",pe,[v(e("input",{class:"form-check-input",type:"radio",name:"trip_status",id:"completed",value:0,"onUpdate:modelValue":s[2]||(s[2]=o=>t.form.trip_status=o)},null,512),[[H,t.form.trip_status]]),e("label",ve,a(l.$t("completed")),1)]),e("div",ge,[v(e("input",{class:"form-check-input",type:"radio",name:"trip_status",id:"cancelled",value:1,"onUpdate:modelValue":s[3]||(s[3]=o=>t.form.trip_status=o)},null,512),[[H,t.form.trip_status]]),e("label",be,a(l.$t("cancelled")),1)])]),t.errors.trip_status?(n(),d("span",he,a(t.errors.trip_status),1)):g("",!0)])]),e("div",ye,[e("div",ke,[e("label",we,[C(a(l.$t("date_option"))+" ",1),s[10]||(s[10]=e("span",{class:"text-danger"},"*",-1))]),v(e("select",{id:"select_date_option",class:"form-select","onUpdate:modelValue":s[4]||(s[4]=o=>t.form.select_date_option=o)},[e("option",Me,a(l.$t("select")),1),e("option",Be,a(l.$t("today")),1),e("option",Ce,a(l.$t("this_week")),1),e("option",Ve,a(l.$t("this_month")),1),e("option",De,a(l.$t("this_year")),1),e("option",Le,a(l.$t("date")),1)],512),[[B,t.form.select_date_option]]),(n(!0),d(w,null,k(t.errors.select_date_option,(o,r)=>(n(),d("span",{key:r,class:"text-danger"},a(o),1))),128))])]),t.form.select_date_option==="date"?(n(),d("div",Se,[e("div",Fe,[e("label",Ue,a(l.$t("from_to_date")),1),m(h,{placeholder:l.$t("select_date"),modelValue:t.form.date,"onUpdate:modelValue":s[5]||(s[5]=o=>t.form.date=o),config:t.rangeDateconfig,class:"form-control flatpickr-input",id:"datepicker-range"},null,8,["placeholder","modelValue","config"]),(n(!0),d(w,null,k(t.errors.date,(o,r)=>(n(),d("span",{key:r,class:"text-danger"},a(o),1))),128))])])):g("",!0),e("div",Re,[e("div",He,[e("label",Pe,[C(a(l.$t("file_format"))+" ",1),s[11]||(s[11]=e("span",{class:"text-danger"},"*",-1))]),v(e("select",{id:"file_format",class:"form-select","onUpdate:modelValue":s[6]||(s[6]=o=>t.form.file_format=o)},[e("option",Te,a(l.$t("select_file_format")),1),e("option",Ne,a(l.$t("excel")),1),e("option",Ae,a(l.$t("csv")),1)],512),[[B,t.form.file_format]]),(n(!0),d(w,null,k(t.errors.file_format,(o,r)=>(n(),d("span",{key:r,class:"text-danger"},a(o),1))),128))])]),e("div",qe,[e("div",Ee,[e("button",{type:"submit",class:"btn btn-primary",disabled:t.loading},a(l.$t("download")),9,je)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[t.successMessage?(n(),d("div",Oe,[e("div",Ge,[s[12]||(s[12]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[13]||(s[13]=e("strong",null,"Success",-1)),C(" - "+a(t.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:s[8]||(s[8]=(...o)=>t.dismissMessage&&t.dismissMessage(...o)),"aria-label":"Close Success Message"})])])):g("",!0),t.alertMessage?(n(),d("div",Ie,[e("div",Je,[s[14]||(s[14]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),s[15]||(s[15]=e("strong",null,"Alert",-1)),C(" - "+a(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:s[9]||(s[9]=(...o)=>t.dismissMessage&&t.dismissMessage(...o)),"aria-label":"Close Alert Message"})])])):g("",!0)])]),_:1})}const tt=T(z,[["render",Ke]]);export{tt as default};
