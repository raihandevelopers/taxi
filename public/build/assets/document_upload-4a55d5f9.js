import{_ as L,Z as j,P as q,C as D,T as N,r as f,G as w,g as r,o as i,x as P,w as g,a as M,N as O,k as m,l as t,y as b,J as c,q as T,M as H,i as u,L as F,F as R,B as k,n as E}from"./vendor-ddfbd976.js";import{L as A}from"./main-306a5ea6.js";import{P as G}from"./page-header-2dc95532.js";import{F as J}from"./FormValidation-a9047131.js";import{i as Z}from"./documentUpload-8b8da3ef.js";import{I as z}from"./ImageUpload-6f09ff26.js";import"./footer-e648049d.js";import"./app-042fb454.js";const K={components:{Layout:A,PageHeader:G,Head:j,FormValidation:J,flatPickr:q,imageUpload:Z,ImageUpload:z},props:{successMessage:String,alertMessage:String,fleetId:Array,document:Object,uploaded:Object,validate:Function},setup(e){const{t:a}=D(),n=N({name:e.document&&e.document.name||"",identify_number:e.uploaded&&e.uploaded.identify_number||"",expiry_date:e.uploaded&&e.uploaded.expiry_date||"",image:e.uploaded&&e.uploaded.image||"",back_image:e.uploaded&&e.uploaded.back_image||"",iconFile:null,backImageFile:null}),o={name:{required:!0},identify_number:e.document&&e.document.has_identify_number?{required:!0}:{},expiry_date:e.document&&e.document.has_expiry_date?{required:!0}:{},image:e.document&&e.document.image?{required:!0}:{},back_image:e.document&&e.document.image_type==="front_and_back"?{required:!0}:{}},h=f(null),y=f({}),p=f(e.successMessage||""),_=f(e.alertMessage||""),I=()=>{p.value="",_.value=""},B=async()=>{if(y.value=h.value.validate(),Object.keys(y.value).length>0)return;const s=new FormData;Object.keys(n.data()).forEach(l=>{s.append(l,n[l])}),n.image&&s.append("image",n.image),n.back_image&&s.append("back_image",n.back_image);try{let l;e.document&&e.document.id?l=await M.post(`/manage-fleet/document-upload/${e.document.id}/${e.fleetId.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}):l=await M.post(`/manage-fleet/document-upload/${e.fleetId.id}`,s,{headers:{"Content-Type":"multipart/form-data"}}),l.status===201?(p.value=a("document_successfully_uploaded"),n.reset(),O.get(`/manage-fleet/document/${e.fleetId.id}`)):_.value=a("failed_to_upload_document")}catch(l){l.response&&l.response.status===422?y.value=l.response.data.errors:(console.error(a("error_uploading_document"),l),_.value=a("failed_to_upload_document"))}},x=f(""),S=w(()=>n.iconFile?x.value:e.uploaded&&e.uploaded.image?e.uploaded.image:"/default-profile.jpeg");f("");const C=w(()=>n.iconBackFile?iconBackFile.value:e.uploaded&&e.uploaded.back_image?e.uploaded.back_image:"/default-profile.jpeg");return{form:n,successMessage:p,alertMessage:_,handleSubmit:B,dismissMessage:I,validationRules:o,validationRef:h,errors:y,imageSrc:S,backImageSrc:C,handleImageSelected:(s,l)=>{n[l]=s},handleImageRemoved:s=>{n[s]=null}}}},Q={class:"row"},W={class:"col-6"},X={class:"mb-3"},Y={for:"name",class:"form-label"},$=["placeholder"],ee={key:0,class:"col-6"},ae={class:"mb-3"},te={for:"identify_number",class:"form-label"},oe=["placeholder"],ne={key:1,class:"col-6"},de={class:"mb-3"},le={for:"expiry_date",class:"form-label"},ie={class:"col-sm-6"},se={class:"mb-3"},re={for:"document",class:"form-label d-flex"},me={key:0,class:"text-danger"},ce={key:2,class:"col-sm-6"},ue={class:"mb-3"},_e={for:"back_document",class:"form-label d-flex"},fe={key:0,class:"text-danger"},ge={class:"col-lg-12"},be={class:"text-end"},ye={type:"submit",class:"btn btn-primary"};function pe(e,a,n,o,h,y){const p=r("Head"),_=r("PageHeader"),I=r("BCardHeader"),B=r("flat-pickr"),x=r("ImageUpload"),S=r("FormValidation"),C=r("BCardBody"),U=r("BCard"),V=r("BCol"),s=r("BRow"),l=r("Layout");return i(),P(l,null,{default:g(()=>[m(p,{title:"Document Upload"}),m(_,{title:e.$t("create"),pageTitle:e.$t("document_upload"),pageLink:"/manage-fleet"},null,8,["title","pageTitle"]),m(s,null,{default:g(()=>[m(V,{lg:"12"},{default:g(()=>[m(U,{"no-body":"",id:"tasksList"},{default:g(()=>[m(I,{class:"border-0"}),m(C,{class:"border border-dashed border-end-0 border-start-0"},{default:g(()=>[t("form",{onSubmit:a[7]||(a[7]=E((...d)=>o.handleSubmit&&o.handleSubmit(...d),["prevent"])),enctype:"multipart/form-data"},[m(S,{form:o.form,rules:o.validationRules,ref:"validationRef"},{default:g(()=>[t("div",Q,[t("div",W,[t("div",X,[t("label",Y,[b(c(e.$t("name"))+" ",1),a[8]||(a[8]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_name"),id:"name","onUpdate:modelValue":a[0]||(a[0]=d=>o.form.name=d),readonly:""},null,8,$),[[H,o.form.name]]),(i(!0),u(R,null,F(o.errors.name,(d,v)=>(i(),u("span",{key:v,class:"text-danger"},c(d),1))),128))])]),n.document&&n.document.has_identify_number==1?(i(),u("div",ee,[t("div",ae,[t("label",te,[b(c(e.$t("identify_number"))+" ",1),a[9]||(a[9]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_identify_number"),id:"identify_number","onUpdate:modelValue":a[1]||(a[1]=d=>o.form.identify_number=d)},null,8,oe),[[H,o.form.identify_number]]),(i(!0),u(R,null,F(o.errors.identify_number,(d,v)=>(i(),u("span",{key:v,class:"text-danger"},c(d),1))),128))])])):k("",!0),n.document&&n.document.has_expiry_date==1?(i(),u("div",ne,[t("div",de,[t("label",le,[b(c(e.$t("expiry_date"))+" ",1),a[10]||(a[10]=t("span",{class:"text-danger"},"*",-1))]),m(B,{placeholder:e.$t("select_date"),id:"expiry_date",class:"form-control flatpickr-input",modelValue:o.form.expiry_date,"onUpdate:modelValue":a[2]||(a[2]=d=>o.form.expiry_date=d),config:e.rangeDateconfig},null,8,["placeholder","modelValue","config"]),(i(!0),u(R,null,F(o.errors.expiry_date,(d,v)=>(i(),u("span",{key:v,class:"text-danger"},c(d),1))),128))])])):k("",!0),t("div",ie,[t("div",se,[t("label",re,[b(c(e.$t("documents"))+" ",1),a[11]||(a[11]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))]),a[12]||(a[12]=b(" . ")),m(x,{imageType:"fleet",initialImageUrl:o.form.image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[3]||(a[3]=d=>o.handleImageSelected(d,"image")),onImageRemoved:a[4]||(a[4]=()=>o.handleImageRemoved("image"))},null,8,["initialImageUrl"]),o.errors.image?(i(),u("span",me,c(o.errors.image),1)):k("",!0)])]),n.document&&n.document.image_type==="front_and_back"?(i(),u("div",ce,[t("div",ue,[t("label",_e,[b(c(e.$t("back_image"))+" ",1),a[13]||(a[13]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))]),m(x,{imageType:"fleet",initialImageUrl:o.form.back_image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[5]||(a[5]=d=>o.handleImageSelected(d,"back_image")),onImageRemoved:a[6]||(a[6]=()=>o.handleImageRemoved("back_image"))},null,8,["initialImageUrl"]),o.errors.back_image?(i(),u("span",fe,c(o.errors.back_image),1)):k("",!0)])])):k("",!0),t("div",ge,[t("div",be,[t("button",ye,c(n.document?e.$t("update"):e.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Fe=L(K,[["render",pe]]);export{Fe as default};
