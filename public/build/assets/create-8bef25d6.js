import{_ as N,Z as R,O as j,P as A,C as O,T as E,r as h,Q as Y,a2 as z,G,D as I,g as m,o as i,x as J,w as _,a as T,N as K,k as c,l as e,J as l,y as u,i as d,L as f,F as p,q as y,H as Q,K as W,M as C,n as Z,B as F}from"./vendor-ddfbd976.js";import{L as X}from"./main-306a5ea6.js";import{P as $}from"./page-header-2dc95532.js";import{F as ee}from"./FormValidation-a9047131.js";import{s as oe}from"./searchbar-3acbc236.js";import"./footer-e648049d.js";import"./app-042fb454.js";const se={data(){return{promocode:!1}},components:{Layout:X,PageHeader:$,Head:R,Multiselect:j,searchbar:oe,FormValidation:ee,flatPickr:A},props:{successMessage:String,alertMessage:String,serviceLocations:Array,promo:Object,users:Object,service_location_ids:Array},setup(s){var L;const{t:o}=O(),x=a=>{if(!a)return"";const v=new Date(a*1e3),r=v.getFullYear(),n=String(v.getMonth()+1).padStart(2,"0"),P=String(v.getDate()).padStart(2,"0");return`${r}-${n}-${P}`},t=E({service_location_id:s.promo?s.promo.service_location_id:"",transport_type:s.promo?s.promo.transport_type:"",code:s.promo?s.promo.code:"",minimum_trip_amount:s.promo?s.promo.minimum_trip_amount:"",maximum_discount_amount:s.promo?s.promo.maximum_discount_amount:"",discount_percent:s.promo?s.promo.discount_percent:"",uses_per_user:s.promo?s.promo.uses_per_user:"",user_id:s.promo?s.promo.user_id:[],user_specific:s.promo?((L=s.promo.user_id)==null?void 0:L.length)>0:!1,date:s.promo?[x(s.promo.from),x(s.promo.to)]:[]}),g=h({mode:"range",dateFormat:"Y-m-d"}),w=h(""),M=h(s.users?s.users:[]),D=async()=>{try{let a=await T.get("/promo-code/userList?search="+w.value);M.value=a.data.results}catch(a){console.log("Errors"+a)}};Y(w,z.debounce(function(){w.value.length>0?D():M.value=[]},300));const B={service_location_id:{required:!0},transport_type:{required:!0},code:{required:!0},minimum_trip_amount:{required:!0},maximum_discount_amount:{required:!0},discount_percent:{required:!0},uses_per_user:{required:!0},user_specific:{required:!1},user_id:{required:t.user_specific},date:{required:!0}},S=h(null),b=h({}),V=h(s.successMessage||""),k=h(s.alertMessage||""),U=()=>{V.value="",k.value=""},q=a=>{w.value=a},H=async()=>{if(b.value=S.value.validate(),!(Object.keys(b.value).length>0))try{let a;s.promo?a=await T.post(`/promo-code/update/${s.promo.id}`,t.data()):a=await T.post("store",t.data()),a.status===201||a.status===200?(V.value=o("promo_code_saved_successfully"),t.reset(),K.get("/promo-code")):k.value=o("failed_to_save_promo_code")}catch(a){a.response&&a.response.status===422?b.value=a.response.data.errors:(console.error(o("error_saving_promo_code"),a),k.value=o("failed_to_save_promo_code"))}};return G(()=>{if(t.date&&t.date.length===2){const a=new Date(t.date[0]),v=new Date(t.date[1]),r=a.toLocaleString("default",{month:"short"}),n=v.toLocaleString("default",{month:"short"});return`${a.getDate()} ${r} - ${v.getDate()} ${n}`}return""}),I(()=>{s.promo&&(t.date=[s.promo.from,s.promo.to])}),{form:t,successMessage:V,users:M,inputsearch:q,alertMessage:k,handleSubmit:H,dismissMessage:U,validationRules:B,validationRef:S,serviceLocations:s.serviceLocations,errors:b,rangeDateconfig:g}}},te={class:"text-success text-decoration-underline text-decoration-underline-success float-end"},re={class:"row"},le={class:"col-md-6"},ae={class:"mb-3"},ne={for:"select_service_locations",class:"form-label"},ie={class:"col-md-6"},de={class:"mb-3"},ce={for:"select_users",class:"form-label"},me={class:"col-md-6 d-flex"},ue={class:"form-check",style:{"align-self":"center"}},_e={for:"select_all_user"},fe=["checked"],pe={class:"col-md-6"},ve={class:"mb-3"},ge={for:"select_transport_type",class:"form-label"},be={disabled:"",value:""},he={value:"taxi"},ye={value:"delivery"},ke={value:"both"},xe={class:"col-sm-6"},we={class:"mb-3"},Me={for:"code",class:"form-label"},Ve=["placeholder"],Ce={class:"col-sm-6"},Be={class:"mb-3"},Se={for:"minimum_trip_amount",class:"form-label"},Le=["placeholder"],De={class:"col-sm-6"},Ue={class:"mb-3"},qe={for:"maximum_discount_amount",class:"form-label"},He=["placeholder"],Te={class:"col-sm-6"},Fe={class:"mb-3"},Pe={for:"discount_percent",class:"form-label"},Ne=["placeholder"],Re={class:"col-sm-6"},je={class:"mb-4"},Ae={for:"datepicker-range",class:"form-label"},Oe={class:"col-sm-6"},Ee={class:"mb-3"},Ye={for:"uses_per_user",class:"form-label"},ze=["placeholder"],Ge={class:"col-lg-12"},Ie={class:"text-end"},Je={type:"submit",class:"btn btn-primary"},Ke={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert"},Qe={class:"alert-content"},We={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert"},Ze={class:"alert-content"},Xe={class:"modal-footer v-modal-footer"};function $e(s,o,x,t,g,w){const M=m("Head"),D=m("PageHeader"),B=m("BLink"),S=m("BCardHeader"),b=m("Multiselect"),V=m("flat-pickr"),k=m("FormValidation"),U=m("BCardBody"),q=m("BCard"),H=m("BCol"),L=m("BRow"),a=m("BModal"),v=m("Layout");return i(),J(v,null,{default:_(()=>[c(M,{title:"Promo Code"}),c(D,{title:x.promo?s.$t("edit"):s.$t("create"),pageTitle:s.$t("promo_code"),pageLink:"/promo-code"},null,8,["title","pageTitle"]),c(L,null,{default:_(()=>[c(H,{lg:"12"},{default:_(()=>[c(q,{"no-body":"",id:"tasksList"},{default:_(()=>[c(S,{class:"border-0"},{default:_(()=>[c(B,{onClick:o[0]||(o[0]=r=>g.promocode=!g.promocode)},{default:_(()=>[e("h6",te,l(s.$t("how_it_works")),1)]),_:1})]),_:1}),c(U,{class:"border border-dashed border-end-0 border-start-0"},{default:_(()=>[e("form",{onSubmit:o[11]||(o[11]=Z((...r)=>t.handleSubmit&&t.handleSubmit(...r),["prevent"]))},[c(k,{form:t.form,rules:t.validationRules,ref:"validationRef"},{default:_(()=>[e("div",re,[e("div",le,[e("div",ae,[e("label",ne,[u(l(s.$t("service_locations"))+" ",1),o[16]||(o[16]=e("span",{class:"text-danger"},"*",-1))]),c(b,{id:"select_service_locations",modelValue:t.form.service_location_id,"onUpdate:modelValue":o[1]||(o[1]=r=>t.form.service_location_id=r),"close-on-select":"",searchable:!0,"create-option":!1,options:t.serviceLocations.map(r=>({value:r.id,label:r.name})),placeholder:s.$t("select_service_locations")},null,8,["modelValue","options","placeholder"]),(i(!0),d(p,null,f(t.errors.service_location_id,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",ie,[e("div",de,[e("label",ce,[u(l(s.$t("users"))+" ",1),o[17]||(o[17]=e("span",{class:"text-danger"},"*",-1))]),c(b,{id:"select_users",mode:"tags",modelValue:t.form.user_id,"onUpdate:modelValue":o[2]||(o[2]=r=>t.form.user_id=r),"close-on-select":!1,searchable:!0,"create-option":!1,onSearchChange:t.inputsearch,options:t.users.map(r=>({value:r.id,label:r.name})),placeholder:s.$t("select_users")},null,8,["modelValue","onSearchChange","options","placeholder"]),(i(!0),d(p,null,f(t.errors.user_ids,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",me,[e("div",ue,[e("label",_e,l(s.$t("user_specific")),1),y(e("input",{type:"checkbox",id:"select_all_user","onUpdate:modelValue":o[3]||(o[3]=r=>t.form.user_specific=r),class:"form-check-input",checked:t.form.user_id?t.form.user_id.length>0:!1},null,8,fe),[[Q,t.form.user_specific]])])]),e("div",pe,[e("div",ve,[e("label",ge,[u(l(s.$t("transport_type"))+" ",1),o[18]||(o[18]=e("span",{class:"text-danger"},"*",-1))]),y(e("select",{id:"transport_type",class:"form-select","onUpdate:modelValue":o[4]||(o[4]=r=>t.form.transport_type=r)},[e("option",be,l(s.$t("select")),1),e("option",he,l(s.$t("taxi")),1),e("option",ye,l(s.$t("delivery")),1),e("option",ke,l(s.$t("all")),1)],512),[[W,t.form.transport_type]]),(i(!0),d(p,null,f(t.errors.transport_type,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",xe,[e("div",we,[e("label",Me,[u(l(s.$t("code"))+" ",1),o[19]||(o[19]=e("span",{class:"text-danger"},"*",-1))]),y(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_code"),id:"code","onUpdate:modelValue":o[5]||(o[5]=r=>t.form.code=r)},null,8,Ve),[[C,t.form.code]]),(i(!0),d(p,null,f(t.errors.code,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",Ce,[e("div",Be,[e("label",Se,[u(l(s.$t("minimum_trip_amount"))+" ",1),o[20]||(o[20]=e("span",{class:"text-danger"},"*",-1))]),y(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_minimum_trip_amount"),id:"minimum_trip_amount","onUpdate:modelValue":o[6]||(o[6]=r=>t.form.minimum_trip_amount=r)},null,8,Le),[[C,t.form.minimum_trip_amount]]),(i(!0),d(p,null,f(t.errors.minimum_trip_amount,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",De,[e("div",Ue,[e("label",qe,[u(l(s.$t("maximum_discount_amount"))+" ",1),o[21]||(o[21]=e("span",{class:"text-danger"},"*",-1))]),y(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_maximum_discount_amount"),id:"maximum_discount_amount","onUpdate:modelValue":o[7]||(o[7]=r=>t.form.maximum_discount_amount=r)},null,8,He),[[C,t.form.maximum_discount_amount]]),(i(!0),d(p,null,f(t.errors.maximum_discount_amount,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",Te,[e("div",Fe,[e("label",Pe,[u(l(s.$t("discount_percentage"))+" ",1),o[22]||(o[22]=e("span",{class:"text-danger"},"*",-1))]),y(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_discount_percentage"),id:"discount_percent","onUpdate:modelValue":o[8]||(o[8]=r=>t.form.discount_percent=r)},null,8,Ne),[[C,t.form.discount_percent]]),(i(!0),d(p,null,f(t.errors.discount_percent,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",Re,[e("div",je,[e("label",Ae,[u(l(s.$t("from_to_date"))+" ",1),o[23]||(o[23]=e("span",{class:"text-danger"},"*",-1))]),c(V,{placeholder:s.$t("select_date"),modelValue:t.form.date,"onUpdate:modelValue":o[9]||(o[9]=r=>t.form.date=r),config:t.rangeDateconfig,class:"form-control flatpickr-input",id:"demo-datepicker"},null,8,["placeholder","modelValue","config"]),(i(!0),d(p,null,f(t.errors.date,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",Oe,[e("div",Ee,[e("label",Ye,[u(l(s.$t("how_many_times_the_user_can_use_same_promo_code"))+" ",1),o[24]||(o[24]=e("span",{class:"text-danger"},"*",-1))]),y(e("input",{type:"text",class:"form-control",placeholder:s.$t("enter_how_many_times_the_user_can_use_same_promo_code"),id:"uses_per_user","onUpdate:modelValue":o[10]||(o[10]=r=>t.form.uses_per_user=r)},null,8,ze),[[C,t.form.uses_per_user]]),(i(!0),d(p,null,f(t.errors.uses_per_user,(r,n)=>(i(),d("span",{key:n,class:"text-danger"},l(r),1))),128))])]),e("div",Ge,[e("div",Ie,[e("button",Je,l(x.promo?s.$t("update"):s.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[t.successMessage?(i(),d("div",Ke,[e("div",Qe,[o[25]||(o[25]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[26]||(o[26]=e("strong",null,"Success",-1)),u(" - "+l(t.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:o[12]||(o[12]=(...r)=>t.dismissMessage&&t.dismissMessage(...r)),"aria-label":"Close Success Message"})])])):F("",!0),t.alertMessage?(i(),d("div",We,[e("div",Ze,[o[27]||(o[27]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[28]||(o[28]=e("strong",null,"Alert",-1)),u(" - "+l(t.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[13]||(o[13]=(...r)=>t.dismissMessage&&t.dismissMessage(...r)),"aria-label":"Close Alert Message"})])])):F("",!0)]),c(a,{modelValue:g.promocode,"onUpdate:modelValue":o[15]||(o[15]=r=>g.promocode=r),"hide-footer":"",title:s.$t("promo_code"),class:"v-modal-custom",size:"lg"},{default:_(()=>[o[30]||(o[30]=e("p",{class:"text-muted mb-0"},"How Coupon Works:",-1)),o[31]||(o[31]=e("div",{class:"d-flex mt-4"},[e("div",{class:"flex-shrink-0"},[e("i",{class:"ri-checkbox-circle-fill text-success"})]),e("div",{class:"flex-grow-1 ms-2"},[e("p",{class:"text-muted mb-0"}," The coupon code will work based on its settings, such as the date range, how many times each user can use it, the total number of uses, maximum discount, and minimum trip amount. ")])],-1)),o[32]||(o[32]=e("div",{class:"d-flex mt-4"},[e("div",{class:"flex-shrink-0"},[e("i",{class:"ri-checkbox-circle-fill text-success"})]),e("div",{class:"flex-grow-1 ms-2"},[e("p",{class:"text-muted mb-0"}," The driver will still receive the full payment, so they won't be affected by rides where a coupon is applied. ")])],-1)),o[33]||(o[33]=e("div",{class:"swiper-pagination dynamic-pagination"},null,-1)),e("div",Xe,[c(B,{href:"javascript:void(0);",class:"btn btn-link link-success fw-medium",onClick:o[14]||(o[14]=r=>g.promocode=!1)},{default:_(()=>o[29]||(o[29]=[e("i",{class:"ri-close-line me-1 align-middle"},null,-1),u(" Close ")])),_:1,__:[29]})])]),_:1,__:[30,31,32,33]},8,["modelValue","title"])]),_:1})}const no=N(se,[["render",$e]]);export{no as default};
