import{_ as K,Z as Q,O as W,P as Z,z as X,C as ee,r as m,T as te,R as se,g as d,S as ae,o as f,x as H,w as i,a as $,U as b,N as oe,k as n,l as e,J as l,q as u,K as le,i as _,L as Y,F as j,y as g,B as w,p as ne,n as z,W as v}from"./vendor-ddfbd976.js";import{L as re}from"./main-306a5ea6.js";import{P as ie}from"./page-header-2dc95532.js";import{P as ce}from"./Pagination-f095ae3c.js";import{s as de}from"./search-2c17aadd.js";import{s as fe}from"./searchbar-3acbc236.js";import{l as ue}from"./footer-e648049d.js";import{_ as me}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const pe={data(){return{rightOffcanvas:!1,SearchQuery:""}},components:{Layout:re,PageHeader:ie,Head:Q,Pagination:ce,Multiselect:W,flatPickr:Z,Link:X,search:de,searchbar:fe},props:{successMessage:String,alertMessage:String},setup(a){const{t}=ee(),S=m(""),o=te({transport_type:null,payment_type:null,user_type:null,arrival_status:null,limit:10}),y=m([]),k=m({}),B=m(!1),M=m(!1),C=m(null),V=m({}),p=m(a.successMessage||""),T=m(a.alertMessage||""),U=()=>{p.value="",T.value=""},P=m(!1),N=()=>{s(),M.value=!0,P.value=!1},F=()=>{o.reset(),s(),P.value=!1},I=()=>{B.value=!1},L=async r=>{try{await $.delete(`/cancellation/delete/${r}`);const c=y.value.findIndex(h=>h.id===r);c!==-1&&y.value.splice(c,1),B.value=!1,b.fire(t("success"),t("reason_deleted_successfully"),"success")}catch{b.fire(t("error"),t("failed_to_delete_reason"),"error")}},A=async(r,c)=>{b.fire({title:t("are_you_sure"),text:t("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:t("yes"),cancelButtonText:t("cancel")}).then(async h=>{if(h.isConfirmed)try{await $.post("/cancellation/update-status",{id:r,status:c});const D=y.value.findIndex(J=>J.id===r);D!==-1&&(y.value[D].active=c),b.fire(t("changed"),t("status_updated_successfully"),"success")}catch(D){console.error(t("error_updating_status"),D),b.fire(t("error"),t("failed_to_update_status"),"error")}})},E=async r=>{b.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async c=>{if(c.isConfirmed)try{await L(r)}catch(h){console.error(t("error_deleting_data"),h),b.fire(t("error"),t("failed_to_delete_the_data"),"error")}})},O=async r=>{S.value=r,s()},s=async(r=1)=>{try{const c=o.data();c.search=S.value,c.page=r;const h=await $.get("/cancellation/list",{params:c});y.value=h.data.results,k.value=h.data.paginator,G(k.value.total),M.value=!1}catch(c){console.error(t("error_fetching_reason"),c)}},R=async r=>{localStorage.setItem("cancellation/list",r),s(r)},x=async r=>{oe.get(`/cancellation/edit/${r.id}`)},q=r=>(k.value.current_page-1)*k.value.per_page+r+1,G=()=>{V.value=[10,25,50,100,200,500]};return{results:y,modalShow:B,deleteItemId:C,successMessage:p,alertMessage:T,filterData:N,deleteModal:E,closeModal:I,deleteData:L,dismissMessage:U,searchTerm:S,paginator:k,modalFilter:M,clearFilter:F,fetchDatas:s,filter:o,toggleActiveStatus:A,handlePageChanged:R,SerialNumber:q,editData:x,fetchSearch:O,rightOffcanvas:P,paginatorOption:V,changeEntriesPerPage:()=>{s()}}},computed:{...ue,...se(["permissions"])},mounted(){this.fetchDatas();const a=localStorage.getItem("cancellation/list");a?this.handlePageChanged(Number(a)):this.handlePageChanged(1)}},_e={class:"d-flex align-items-center mt-3"},ve={class:"me-2 text-muted"},he=["value"],ge={class:"ms-2 text-muted"},ye={class:"d-flex align-items-center gap-2"},be={class:"table-responsive"},ke={class:"table align-middle position-relative table-nowrap"},Ce={class:"table-active"},we={scope:"col"},Be={scope:"col"},Me={scope:"col"},Pe={scope:"col"},Se={scope:"col"},Ve={scope:"col"},Te={scope:"col"},Ue={key:0},Le={key:0},Oe=["onClick","id","checked"],xe={key:1},De={colspan:"7",class:"text-center"},He={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ne={class:"alert-content"},Fe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Ie={class:"alert-content"},Ae={class:"offcanvas-body"},Ee={class:"mb-4"},Re={for:"datepicker-range",class:"form-label text-muted text-uppercase fw-semibold mb-3"},$e={class:"form-check form-check-inline"},ze={class:"form-check-label",for:"taxi"},Ye={class:"form-check form-check-inline"},je={class:"form-check-label",for:"delivery"},qe={class:"form-check form-check-inline"},Ge={class:"form-check-label",for:"both"},Je={class:"mb-4"},Ke={for:"user-type",class:"form-label text-muted text-uppercase fw-semibold mb-3"},Qe={class:"form-check form-check-inline"},We={class:"form-check-label",for:"user"},Ze={class:"form-check form-check-inline"},Xe={class:"form-check-label",for:"driver"},et={class:"mb-4"},tt={for:"user-type",class:"form-label text-muted text-uppercase fw-semibold mb-3"},st={class:"form-check form-check-inline"},at={class:"form-check-label",for:"free"},ot={class:"form-check form-check-inline"},lt={class:"form-check-label",for:"compensate"},nt={class:"mb-4"},rt={for:"user-type",class:"form-label text-muted text-uppercase fw-semibold mb-3"},it={class:"form-check form-check-inline"},ct={class:"form-check-label",for:"before"},dt={class:"form-check form-check-inline"},ft={class:"form-check-label",for:"after"},ut={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function mt(a,t,S,o,y,k){const B=d("Head"),M=d("PageHeader"),C=d("BCol"),V=d("searchbar"),p=d("BButton"),T=d("Link"),U=d("BRow"),P=d("BCardHeader"),N=d("BCardBody"),F=d("BCard"),I=d("BFrom"),L=d("BOffcanvas"),A=d("Pagination"),E=d("Layout"),O=ae("b-tooltip");return f(),H(E,null,{default:i(()=>[n(B,{title:"Cancellation"}),n(M,{title:a.$t("cancellation"),pageTitle:a.$t("cancellation")},null,8,["title","pageTitle"]),n(U,null,{default:i(()=>[n(C,{lg:"12"},{default:i(()=>[n(F,{"no-body":"",id:"tasksList"},{default:i(()=>[n(P,{class:"border-0"},{default:i(()=>[n(U,{class:"g-2"},{default:i(()=>[n(C,{md:"3"},{default:i(()=>[e("div",_e,[e("label",ve,l(a.$t("show")),1),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.filter.limit=s),onChange:t[1]||(t[1]=(...s)=>o.changeEntriesPerPage&&o.changeEntriesPerPage(...s)),class:"form-select form-select-sm w-auto"},[(f(!0),_(j,null,Y(o.paginatorOption,s=>(f(),_("option",{key:s,value:s},l(s),9,he))),128))],544),[[le,o.filter.limit]]),e("label",ge,l(a.$t("entries")),1)])]),_:1}),n(C,{md:"3"}),n(C,{md:"auto",class:"ms-auto"},{default:i(()=>[e("div",ye,[n(V,{onSearch:o.fetchSearch},null,8,["onSearch"]),n(p,{variant:"danger",onClick:t[2]||(t[2]=s=>o.rightOffcanvas=!0)},{default:i(()=>[t[15]||(t[15]=e("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),g(" "+l(a.$t("filters")),1)]),_:1,__:[15]}),a.permissions.includes("add-cancellation")?(f(),H(T,{key:0,href:"/cancellation/create"},{default:i(()=>[n(p,{variant:"primary",class:"float-end"},{default:i(()=>[t[16]||(t[16]=e("i",{class:"ri-add-line align-bottom me-1"},null,-1)),g(" "+l(a.$t("add_cancellation")),1)]),_:1,__:[16]})]),_:1})):w("",!0)])]),_:1})]),_:1})]),_:1}),n(N,{class:"border border-dashed border-end-0 border-start-0"},{default:i(()=>[e("div",be,[e("table",ke,[e("thead",Ce,[e("tr",null,[e("th",we,l(a.$t("reason")),1),e("th",Be,l(a.$t("user_type")),1),e("th",Me,l(a.$t("compensable")),1),e("th",Pe,l(a.$t("transport_type")),1),e("th",Se,l(a.$t("arrival_status")),1),e("th",Ve,l(a.$t("status")),1),e("th",Te,l(a.$t("action")),1)])]),o.results.length>0?(f(),_("tbody",Ue,[(f(!0),_(j,null,Y(o.results,(s,R)=>(f(),_("tr",{key:R},[e("td",null,l(s.reason),1),e("td",null,l(s.user_type),1),e("td",null,l(s.payment_type=="free"?a.$t("free"):a.$t("compensate")),1),e("td",null,l(s.transport_type=="taxi"?a.$t("taxi"):a.$t("delivery")),1),e("td",null,l(s.arrival_status=="before"?a.$t("before_arrival"):a.$t("after_arrival")),1),a.permissions.includes("toggle-cancellation")?(f(),_("td",Le,[e("div",{class:ne({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":s.active})},[e("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:z(x=>o.toggleActiveStatus(s.id,!s.active),["prevent"]),id:"status_"+s.id,checked:s.active},null,8,Oe)],2)])):w("",!0),e("td",null,[a.permissions.includes("edit-cancellation")?u((f(),H(p,{key:0,onClick:z(x=>o.editData(s),["prevent"]),class:"btn btn-soft-warning btn-sm m-2","data-bs-toggle":"tooltip",title:a.$t("edit")},{default:i(()=>t[17]||(t[17]=[e("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[17]},1032,["onClick","title"])),[[O,void 0,void 0,{hover:!0}]]):w("",!0),a.permissions.includes("delete-cancellation")?u((f(),H(p,{key:1,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:z(x=>o.deleteModal(s.id),["prevent"]),"data-bs-toggle":"tooltip",title:a.$t("delete")},{default:i(()=>t[18]||(t[18]=[e("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[18]},1032,["onClick","title"])),[[O,void 0,void 0,{hover:!0}]]):w("",!0)])]))),128))])):(f(),_("tbody",xe,[e("tr",null,[e("td",De,[t[19]||(t[19]=e("img",{src:me,alt:"Loading...",style:{width:"100px"}},null,-1)),e("h5",null,l(a.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),e("div",null,[o.successMessage?(f(),_("div",He,[e("div",Ne,[t[20]||(t[20]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[21]||(t[21]=g()),t[22]||(t[22]=e("strong",null,"Success",-1)),g(" - "+l(o.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:t[3]||(t[3]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):w("",!0),o.alertMessage?(f(),_("div",Fe,[e("div",Ie,[t[23]||(t[23]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),t[24]||(t[24]=g()),t[25]||(t[25]=e("strong",null,"Alert",-1)),g(" - "+l(o.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:t[4]||(t[4]=(...s)=>o.dismissMessage&&o.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):w("",!0)]),n(L,{modelValue:o.rightOffcanvas,"onUpdate:modelValue":t[14]||(t[14]=s=>o.rightOffcanvas=s),placement:"end",title:a.$t("leads_filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:i(()=>[n(I,{action:"",class:"d-flex flex-column justify-content-end h-100"},{default:i(()=>[e("div",Ae,[e("div",Ee,[e("label",Re,l(a.$t("transport_type")),1),e("div",null,[e("div",$e,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[5]||(t[5]=s=>o.filter.transport_type=s),type:"radio",name:"transportType",id:"taxi",value:"taxi"},null,512),[[v,o.filter.transport_type]]),e("label",ze,l(a.$t("taxi")),1)]),e("div",Ye,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[6]||(t[6]=s=>o.filter.transport_type=s),type:"radio",name:"transportType",id:"delivery",value:"delivery"},null,512),[[v,o.filter.transport_type]]),e("label",je,l(a.$t("delivery")),1)]),e("div",qe,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[7]||(t[7]=s=>o.filter.transport_type=s),type:"radio",name:"transportType",id:"both",value:"both"},null,512),[[v,o.filter.transport_type]]),e("label",Ge,l(a.$t("all")),1)])])]),e("div",Je,[e("label",Ke,l(a.$t("user_type")),1),e("div",null,[e("div",Qe,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[8]||(t[8]=s=>o.filter.user_type=s),type:"radio",name:"userType",id:"user",value:"user"},null,512),[[v,o.filter.user_type]]),e("label",We,l(a.$t("user")),1)]),e("div",Ze,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[9]||(t[9]=s=>o.filter.user_type=s),type:"radio",name:"userType",id:"driver",value:"driver"},null,512),[[v,o.filter.user_type]]),e("label",Xe,l(a.$t("driver")),1)])])]),e("div",et,[e("label",tt,l(a.$t("payment_type")),1),e("div",null,[e("div",st,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[10]||(t[10]=s=>o.filter.payment_type=s),type:"radio",name:"paymentType",id:"free",value:"free"},null,512),[[v,o.filter.payment_type]]),e("label",at,l(a.$t("free")),1)]),e("div",ot,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[11]||(t[11]=s=>o.filter.payment_type=s),type:"radio",name:"paymentType",id:"compensate",value:"compensate"},null,512),[[v,o.filter.payment_type]]),e("label",lt,l(a.$t("compensate")),1)])])]),e("div",nt,[e("label",rt,l(a.$t("arrival_status")),1),e("div",null,[e("div",it,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[12]||(t[12]=s=>o.filter.arrival_status=s),type:"radio",name:"arrival_status",id:"before",value:"before"},null,512),[[v,o.filter.arrival_status]]),e("label",ct,l(a.$t("before_arrival")),1)]),e("div",dt,[u(e("input",{class:"form-check-input","onUpdate:modelValue":t[13]||(t[13]=s=>o.filter.arrival_status=s),type:"radio",name:"arrival_status",id:"after",value:"after"},null,512),[[v,o.filter.arrival_status]]),e("label",ft,l(a.$t("after_arrival")),1)])])]),t[26]||(t[26]=e("div",null,null,-1))]),e("div",ut,[n(p,{variant:"light",onClick:o.clearFilter,class:"w-100"},{default:i(()=>[g(l(a.$t("clear_filter")),1)]),_:1},8,["onClick"]),n(p,{type:"submit",onClick:o.filterData,variant:"success",class:"w-100"},{default:i(()=>[g(l(a.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),n(A,{paginator:o.paginator,onPageChanged:o.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const Bt=K(pe,[["render",mt]]);export{Bt as default};
