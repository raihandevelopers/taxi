import{_ as oe,Z as le,O as ne,P as ie,z as re,C as ce,r as f,T as de,Q as ue,a as Q,R as fe,g as u,S as _e,o as d,x as B,w as n,U as M,N as x,k as r,l as t,J as i,q as S,K as ge,i as g,L as Y,F as Z,y as v,B as p,p as me,n as O}from"./vendor-ddfbd976.js";import{L as pe}from"./main-306a5ea6.js";import{P as ve}from"./page-header-2dc95532.js";import{P as he}from"./Pagination-f095ae3c.js";import{s as ye}from"./searchbar-3acbc236.js";import{u as be,l as ke}from"./footer-e648049d.js";import{_ as Ce}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const we={data(){return{rightOffcanvas:!1,SearchQuery:""}},components:{Layout:pe,PageHeader:ve,Head:le,Pagination:he,Multiselect:ne,flatPickr:ie,Link:re,searchbar:ye},props:{successMessage:String,alertMessage:String,zones:{type:Array,required:!0},vehicleTypes:{type:Array,required:!0},show_driver_level_feature:Boolean,show_incentive_feature_for_driver:Boolean},setup(o){const{t:e}=ce(),h=f(""),s=de({service_location_id:null,zone_id:[],type_id:[],limit:10}),y=f([]),U=f({}),D=f(!1),z=f(!1),P=f(null),A=f({}),{selectedLocation:_}=be(),H=f(o.successMessage||""),b=f(o.alertMessage||""),T=f(""),L=f(""),F=f(o.zones),E=f(o.vehicleTypes),I=()=>{H.value="",b.value=""};ue(_,l=>{s.service_location_id=l,w()});const R=async(l,c)=>{M.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async m=>{if(m.isConfirmed)try{await Q.post("/set-prices/update-status",{id:l,status:c});const N=y.value.findIndex(ae=>ae.id===l);N!==-1&&(y.value[N].active=c),M.fire(e("changed"),e("status_updated_successfully"),"success")}catch(N){console.error(e("error_updating_status"),N),M.fire(e("error"),e("failed_to_update_status"),"error")}})},$=l=>l.charAt(0).toUpperCase()+l.slice(1),V=f(!1),k=()=>{w(),z.value=!0,V.value=!1},a=()=>{s.reset(),T.value="",L.value="",w(),V.value=!1},q=()=>{D.value=!1},C=async l=>{try{await Q.delete(`/set-prices/delete/${l}`);const c=y.value.findIndex(m=>m.id===l);c!==-1&&y.value.splice(c,1),D.value=!1,M.fire(e("success"),e("vehicle_price_deleted_successfully"),"success")}catch(c){c.response&&c.response.status==403&&(b.value=c.response.data.alertMessage,setTimeout(()=>{b.value=""},5e3)),M.fire(e("error"),e("failed_to_delete_vehicle_price"),"error")}},G=async l=>{M.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async c=>{if(c.isConfirmed)try{await C(l)}catch(m){console.error(e("error_deleting_data"),m),M.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},J=async l=>{h.value=l,w()},w=async(l=1)=>{try{const c=s.data();c.page=l,c.zone=T.value,c.vehicle_type_id=L.value,c.include="vehicleType,zone",s.status!==""&&(c.status=s.status),h.value.length>0&&(c.search=h.value);const m=await Q.get("/set-prices/list",{params:c});console.log("list-data"),console.log(m.data.results),y.value=m.data.results,U.value=m.data.paginator,se(U.value.total),z.value=!1}catch(c){console.error(e("error_fetching_set_prices"),c)}},K=async l=>{localStorage.setItem("set-prices/list",l),w(l)},j=async l=>{x.get(`/set-prices/edit/${l.id}`)},W=async l=>{x.get(`set-prices/packages/${l.id}`)},X=async l=>{x.get(`drivers-levelup/${l.id}`)},ee=async l=>{x.get(`incentives/${l.id}`)},te=async l=>{x.get(`set-prices/surge/${l.id}`)},se=()=>{A.value=[10,25,50,100,200,500]};return{results:y,modalShow:D,deleteItemId:P,successMessage:H,alertMessage:b,filterData:k,deleteModal:G,closeModal:q,dismissMessage:I,searchTerm:h,fetchSearch:J,paginator:U,modalFilter:z,clearFilter:a,fetchDatas:w,filter:s,handlePageChanged:K,editData:j,packagesData:W,surgeData:te,toggleActiveStatus:R,capitalizeFirstLetter:$,zone:T,vehicleType:L,zoneOptions:F,vehicleTypeOptions:E,rightOffcanvas:V,levelUpData:X,incentiveData:ee,paginatorOption:A,selectedLocation:_,changeEntriesPerPage:()=>{w()}}},computed:{...ke,...fe(["permissions"])},mounted(){this.filter.service_location_id=this.selectedLocation,this.fetchDatas();const o=localStorage.getItem("set-prices/list");o?this.handlePageChanged(Number(o)):this.handlePageChanged(1)}},Be={class:"d-flex align-items-center mt-3"},Me={class:"me-2 text-muted"},Pe=["value"],Se={class:"ms-2 text-muted"},Oe={class:"d-flex align-items-center gap-2"},De={class:"table-responsive"},ze={class:"table align-middle position-relative table-nowrap"},Te={class:"table-active"},Le={scope:"col"},Ve={scope:"col"},xe={scope:"col"},Ue={scope:"col"},Ae={scope:"col",class:"mx-5"},He={key:0},Ie={key:0},Ne={key:1},Fe={key:2},Ee={key:0},Re=["onClick","id","checked"],$e={class:"d-flex"},qe={key:1},Qe={colspan:"7",class:"text-center"},Ye={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ze={class:"alert-content"},Ge={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Je={class:"alert-content"},Ke={class:"offcanvas-title",id:"offcanvasRightLabel"},je={class:"p-4"},We={class:"mb-3"},Xe={class:"form-label"},et={class:"mb-3"},tt={class:"form-label"},st={class:"offcanvas-footer p-4 text-center hstack gap-2"};function at(o,e,h,s,y,U){const D=u("Head"),z=u("PageHeader"),P=u("BCol"),A=u("searchbar"),_=u("BButton"),H=u("Link"),b=u("BRow"),T=u("BCardHeader"),L=u("BCardBody"),F=u("BCard"),E=u("pagination"),I=u("Multiselect"),R=u("BOffcanvasBody"),$=u("BOffcanvas"),V=u("Layout"),k=_e("b-tooltip");return d(),B(V,null,{default:n(()=>[r(D,{title:"Set Prices"}),r(z,{title:o.$t("set_prices"),pageTitle:o.$t("set_prices")},null,8,["title","pageTitle"]),r(b,null,{default:n(()=>[r(P,{lg:"12"},{default:n(()=>[r(F,{"no-body":"",id:"tasksList"},{default:n(()=>[r(T,{class:"border-0"},{default:n(()=>[r(b,{class:"g-2"},{default:n(()=>[r(P,{md:"3"},{default:n(()=>[t("div",Be,[t("label",Me,i(o.$t("show")),1),S(t("select",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.filter.limit=a),onChange:e[1]||(e[1]=(...a)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...a)),class:"form-select form-select-sm w-auto"},[(d(!0),g(Z,null,Y(s.paginatorOption,a=>(d(),g("option",{key:a,value:a},i(a),9,Pe))),128))],544),[[ge,s.filter.limit]]),t("label",Se,i(o.$t("entries")),1)])]),_:1}),r(P,{md:"3"}),r(P,{md:"auto",class:"ms-auto"},{default:n(()=>[t("div",Oe,[r(A,{onSearch:s.fetchSearch},null,8,["onSearch"]),r(_,{variant:"danger",onClick:e[2]||(e[2]=a=>s.rightOffcanvas=!0)},{default:n(()=>[e[10]||(e[10]=t("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),v(" "+i(o.$t("filters")),1)]),_:1,__:[10]}),o.permissions.includes("add-price")?(d(),B(H,{key:0,href:"/set-prices/create"},{default:n(()=>[r(_,{variant:"primary",class:"float-end"},{default:n(()=>[e[11]||(e[11]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),v(" "+i(o.$t("add_set_price")),1)]),_:1,__:[11]})]),_:1})):p("",!0)])]),_:1})]),_:1})]),_:1}),r(L,{class:"border border-dashed border-end-0 border-start-0"},{default:n(()=>[t("div",De,[t("table",ze,[t("thead",Te,[t("tr",null,[t("th",Le,i(o.$t("zone")),1),t("th",Ve,i(o.$t("transport_type")),1),t("th",xe,i(o.$t("vehicle_type")),1),t("th",Ue,i(o.$t("status")),1),t("th",Ae,i(o.$t("action")),1)])]),s.results.length>0?(d(),g("tbody",He,[(d(!0),g(Z,null,Y(s.results,(a,q)=>(d(),g("tr",{key:q},[t("td",null,i(a.zone_name),1),t("td",null,[a.transport_type==="taxi"?(d(),g("span",Ie,i(o.$t("taxi")),1)):a.transport_type==="delivery"?(d(),g("span",Ne,i(o.$t("delivery")),1)):(d(),g("span",Fe,i(o.$t("all")),1))]),t("td",null,i(a.name),1),o.permissions.includes("toggle-price")?(d(),g("td",Ee,[t("div",{class:me({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":a.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:O(C=>s.toggleActiveStatus(a.id,!a.active),["prevent"]),id:"status_"+a.id,checked:a.active},null,8,Re)],2)])):p("",!0),t("td",null,[t("div",$e,[o.permissions.includes("edit-price")?S((d(),B(_,{key:0,class:"btn btn-soft-warning btn-sm m-2",onClick:O(C=>s.editData(a),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("edit")},{default:n(()=>e[12]||(e[12]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[12]},1032,["onClick","title"])),[[k,void 0,void 0,{hover:!0}]]):p("",!0),o.permissions.includes("add-package-price")?S((d(),B(_,{key:1,onClick:O(C=>s.packagesData(a),["prevent"]),class:"btn btn-soft-success btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("set_package_prices")},{default:n(()=>e[13]||(e[13]=[t("i",{class:"bx bx-gift bx-xs"},null,-1)])),_:2,__:[13]},1032,["onClick","title"])),[[k,void 0,void 0,{hover:!0}]]):p("",!0),o.permissions.includes("add-package-price")&&h.show_driver_level_feature?S((d(),B(_,{key:2,onClick:O(C=>s.levelUpData(a),["prevent"]),class:"btn btn-soft-dark btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("drivers-levelup")},{default:n(()=>e[14]||(e[14]=[t("i",{class:"ri-medal-fill bx-xs"},null,-1)])),_:2,__:[14]},1032,["onClick","title"])),[[k,void 0,void 0,{hover:!0}]]):p("",!0),o.permissions.includes("add-package-price")&&h.show_incentive_feature_for_driver?S((d(),B(_,{key:3,onClick:O(C=>s.incentiveData(a),["prevent"]),class:"btn btn-soft-secondary btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("incentives")},{default:n(()=>e[15]||(e[15]=[t("i",{class:"ri-coins-line bx-xs"},null,-1)])),_:2,__:[15]},1032,["onClick","title"])),[[k,void 0,void 0,{hover:!0}]]):p("",!0),o.permissions.includes("zone-surge")?S((d(),B(_,{key:4,onClick:O(C=>s.surgeData(a),["prevent"]),class:"btn btn-soft-danger btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("surge")},{default:n(()=>e[16]||(e[16]=[t("i",{class:"ri-flashlight-line bx-xs"},null,-1)])),_:2,__:[16]},1032,["onClick","title"])),[[k,void 0,void 0,{hover:!0}]]):p("",!0)])])]))),128))])):(d(),g("tbody",qe,[t("tr",null,[t("td",Qe,[e[17]||(e[17]=t("img",{src:Ce,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,i(o.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1}),r(E,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})]),_:1}),s.successMessage?(d(),g("div",Ye,[t("div",Ze,[e[18]||(e[18]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[19]||(e[19]=v()),e[20]||(e[20]=t("strong",null,"Success",-1)),v(" - "+i(s.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[3]||(e[3]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Success Message"})])])):p("",!0),s.alertMessage?(d(),g("div",Ge,[t("div",Je,[e[21]||(e[21]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[22]||(e[22]=v()),e[23]||(e[23]=t("strong",null,"Alert",-1)),v(" - "+i(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[4]||(e[4]=(...a)=>s.dismissMessage&&s.dismissMessage(...a)),"aria-label":"Close Alert Message"})])])):p("",!0),r($,{modelValue:s.rightOffcanvas,"onUpdate:modelValue":e[8]||(e[8]=a=>s.rightOffcanvas=a),placement:"end","onUpdate:show":e[9]||(e[9]=a=>s.rightOffcanvas=a)},{header:n(()=>[t("h5",Ke,i(o.$t("filters")),1),r(_,{variant:"white",class:"text-reset p-0",onClick:e[5]||(e[5]=a=>s.rightOffcanvas=!1)},{default:n(()=>e[24]||(e[24]=[t("i",{class:"mdi mdi-close"},null,-1)])),_:1,__:[24]})]),default:n(()=>[r(R,{class:"p-0 overflow-hidden"},{default:n(()=>[t("div",je,[t("div",We,[t("label",Xe,i(o.$t("zone")),1),r(I,{modelValue:s.filter.zone_id,"onUpdate:modelValue":e[6]||(e[6]=a=>s.filter.zone_id=a),"close-on-select":!1,searchable:!0,multiple:"",placeholder:"Select Zone",mode:"tags",options:s.zoneOptions.map(a=>({value:a.id,label:a.name}))},null,8,["modelValue","options"])]),t("div",et,[t("label",tt,i(o.$t("vehicle_type")),1),r(I,{modelValue:s.filter.type_id,"onUpdate:modelValue":e[7]||(e[7]=a=>s.filter.type_id=a),"close-on-select":!1,searchable:!0,multiple:"",placeholder:"Select Vehicle Type",mode:"tags",options:s.vehicleTypeOptions.map(a=>({value:a.id,label:a.name}))},null,8,["modelValue","options"])])]),t("div",st,[r(_,{type:"button",variant:"light",class:"w-100",onClick:s.clearFilter},{default:n(()=>[v(i(o.$t("clear_filter")),1)]),_:1},8,["onClick"]),r(_,{type:"button",variant:"success",class:"w-100",onClick:s.filterData},{default:n(()=>[v(i(o.$t("filters")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue"])]),_:1})}const _t=oe(we,[["render",at]]);export{_t as default};
