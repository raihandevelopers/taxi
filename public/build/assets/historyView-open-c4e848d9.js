import{_ as I,O as R,P as W,Z as N,z as E,T as G,C as Y,r as f,D as V,g as b,o as d,i as c,k as o,w as i,l as e,J as s,F as P,X as k,a4 as J,a as X,U,y as p,x as C,B as u,n as K,L as F}from"./vendor-ddfbd976.js";import{L as Q}from"./main-306a5ea6.js";import{s as $}from"./searchbar-3acbc236.js";import{_ as ee}from"./UserWebMenu-2e0e812c.js";import{P as te}from"./Pagination-f095ae3c.js";import{i as se}from"./app-042fb454.js";import"./footer-e648049d.js";const ae={props:{successMessage:String,alertMessage:String,serviceLocations:{type:Object,required:!0},pick_icon:String,drop_icon:String,stop_icon:String,rejected_drivers:Object,firebaseConfig:Object,request:Object,user:Object},data(){return{searchTerm:""}},components:{Layout:Q,Multiselect:R,flatPickr:W,Head:N,searchbar:$,UserWebMenu:ee,Pagination:te,Link:E,useForm:G},setup(l){const{t:a}=Y(),r=f(l.request),t=f(l.rejected_drivers),S=f(!1),Z=f(l.successMessage||""),L=f(l.alertMessage||""),T=f([]),O=()=>{Z.value="",L.value=""},m=f(l.request?l.request.requestStops.data:[]),x=f(null),y=f(null),h=f([]),z=async()=>{map.value=k.map("map",{zoomControl:!1,dragging:!1,scrollWheelZoom:!1,doubleClickZoom:!1,touchZoom:!1}).setView([r.value.pick_lat,r.value.pick_lng],12),map.value.dragging.disable(),map.value.scrollWheelZoom.disable(),map.value.doubleClickZoom.disable(),map.value.touchZoom.disable(),k.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19}).addTo(map.value);const _=k.icon({iconUrl:"/image/map/pickup.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),g=k.icon({iconUrl:"/image/map/drop.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]});if(x.value=k.marker([r.value.pick_lat,r.value.pick_lng],{icon:_,draggable:!1}).addTo(map.value),y.value=k.marker([r.value.drop_lat,r.value.drop_lng],{icon:g,draggable:!1}).addTo(map.value),m.value.forEach((q,D)=>{const v=k.icon({iconUrl:"/image/map/"+D+".png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),H=k.marker([q.latitude,q.longitude],{icon:v,draggable:!1}).addTo(map.value);h.value[D]=H}),r.value.poly_line){const q=J.decode(r.value.poly_line);let D=k.polyline(q,{color:"blue"}).addTo(map.value);map.value.fitBounds(D)}},M=()=>{S.value=!1},j=async _=>{try{const g=await X.get(`/rides-request/cancel/${_}`);r.value=g.data.request,S.value=!1,U.fire(a("success"),a("trip_cancelled_successfully"),"success")}catch{U.fire(a("error"),a("failed_to_cancel_trip"),"error")}},n=f(""),w=()=>{const _=new Date,g={weekday:"short",day:"numeric",month:"short",year:"numeric"};return _.toLocaleDateString("en-US",g)},A=async _=>{U.fire({title:"Are you sure?",text:"You want to be cancel this ride!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, Cancel it!",cancelButtonText:"Close"}).then(async g=>{if(g.isConfirmed)try{await j(_)}catch(q){console.error(a("error_deleting_data"),q),U.fire(a("error"),a("failed_to_delete_the_data"),"error")}})},B=f(a("normal"));return r.value.is_bid_ride&&(B.value=a("bidding")),r.value.is_rental&&(B.value=a("rental")),r.value.is_out_station&&(r.value.is_round_trip?B.value=a("round_trip_outstation_trip"):B.value=a("one_way_outstation_trip")),V(async()=>{if(r.value.is_completed&&!r.value.is_paid&&r.value.payment_type_string=="card"&&(T.value=r.value.payment_gateways.filter(_=>_.enabled)),!r.value.is_cancelled&&!r.value.is_completed)try{const _=l.firebaseConfig;firebase.apps.length||firebase.initializeApp(_),firebase.database().ref(`requests/${r.value.id}`).on("value",D=>{const v=D.val();v&&(v.hasOwnProperty("is_completed")&&(r.value.is_completed=!0,n.value=a("ride_completed"),setTimeout(()=>{window.location.reload()},2e3)),v.accept!==1&&(r.value.driver_id=null,n.value=a("searching")),v.driver_id&&r.value.driver_id&&window.location.reload(),r.value.is_later&&v.hasOwnProperty("modified_by_driver")&&(n.value=a("driver_started"),r.value.is_driver_started=1),v.trip_arrived==1&&(n.value=a("driver_arrived"),r.value.is_driver_arrived=!0,r.value.converted_arrived_at||(r.value.converted_arrived_at=w())),v.trip_start==1&&(n.value=a("on_trip"),r.value.is_trip_start=!0,r.value.converted_trip_start_time||(r.value.converted_trip_start_time=w())),(v.is_cancelled||v.is_cancel)&&(r.value.is_cancelled=!0,setTimeout(()=>{window.location.reload()},2e3)))})}catch(_){console.error("Error initializing Firebase or fetching settings:",_)}else r.value.is_cancelled?n.value=a("ride_cancelled"):r.value.is_completed?n.value=a("ride_completed"):r.value.is_result.value_start?n.value=a("on_trip"):r.value.is_driver_arrived?n.value=a("driver_arrived"):r.value.is_later&&r.value.is_driver_started?n.value=a("driver_started"):r.value.driver_id?n.value=a("accepted"):r.value.is_later?n.value=a("upcoming"):n.value=a("searching")}),V(async()=>{await se("en"),await z()}),{result:r,modalShow:S,successMessage:Z,alertMessage:L,paymentGateways:T,rejected_drivers:t,deleteModal:A,closeModal:M,stops:m,deleteData:j,rideStatus:n,dismissMessage:O}}},le={class:"row"},re={class:"col-sm-12"},ie={class:"card"},oe={class:"d-flex m-auto"},de={class:"text-center p-3 fs-18"},ne={class:"badge bg-primary-subtle text-primary p-3"},ce={class:"text-center p-3 fs-18"},ue={class:"badge bg-success-subtle text-success p-3"},_e={class:"d-flex align-items-center"},me={class:"avatar-md flex-shrink-0"},fe={class:"avatar-title bg-light rounded-circle"},ve=["src"],pe={class:"flex-grow-1 ms-3"},he={class:"fs-14 mb-1"},be={class:"text-muted fs-12 mb-0"},ye={class:"text-muted fs-12 mb-0"},ge={class:"d-flex align-items-center"},ke={class:"flex-grow-1 ms-3"},xe={class:"fs-14 mb-1"},we={class:"text-muted fs-14 mb-2 mt-2"},Be={class:"d-flex align-items-center"},qe={class:"flex-grow-1 ms-3"},Ce={class:"fs-14 mb-1"},Me={class:"text-muted fs-14 mb-2 mt-2"},De={class:"d-flex align-items-center"},Se={class:"flex-grow-1 ms-3"},Le={class:"fs-14 mb-1"},Te={class:"text-muted fs-14 mb-2 mt-2"},Oe={class:"text-dark"},ze={key:0,class:"flex-grow-1 ms-3"},je={class:"fs-14 mb-1"},Ae={class:"text-muted fs-14 mb-2 mt-2"},Ue={class:"text-dark"},Ze={class:"flex-grow-1 ms-3"},Pe={class:"fs-14 mb-1"},Ve={class:"text-muted fs-14 mb-2 mt-2"},Fe={class:"text-dark"},He={key:0},Ie={key:1,class:"fs-14 mb-1"},Re={key:2,class:"text-muted fs-14 mb-2 mt-2"},We={class:"text-dark"},Ne={class:"flex-shrink-0 text-end"},Ee={class:"mb-1 text-success"},Ge={class:"text-muted fs-13 mb-0"},Ye={key:0},Je={key:1},Xe={key:2},Ke={class:"d-flex align-items-center"},Qe={class:"flex-grow-1 ms-3"},$e={class:"fs-14 mb-1"},et={class:"text-muted fs-14 mb-2 mt-2"},tt={class:"text-center"},st=["href"],at={key:1,class:"text-muted"},lt={class:"text-center"},rt={class:"border-top border-top-dashed mt-2"},it={class:"table table-borderless table-nowrap align-middle mb-0 m-auto",style:{width:"250px"}},ot={class:"text-end"},dt={class:"text-end"},nt={class:"text-end"},ct={key:0},ut={class:"text-end"},_t={class:"text-end"},mt={class:"text-end"},ft={key:1},vt={class:"text-end"},pt={key:2},ht={class:"text-end"},bt={key:3},yt={class:"text-end"},gt={key:4},kt={class:"text-end"},xt={key:5},wt={key:0,class:"text-end"},Bt={key:1,class:"text-end"},qt={key:2,class:"text-end"},Ct={key:3,class:"text-end"},Mt={class:"border-top border-top-dashed fs-15"},Dt={scope:"row"},St={class:"text-end"},Lt={id:"pay",class:"modal fade",tabindex:"-1","aria-labelledby":"payLabel","aria-hidden":"true",style:{display:"none"}},Tt={class:"modal-dialog"},Ot={class:"modal-content"},zt={class:"modal-header"},jt={class:"modal-title",id:"payLabel"},At={class:"modal-body"},Ut=["src","alt"];function Zt(l,a,r,t,S,Z){const L=b("Head"),T=b("UserWebMenu"),O=b("BCardHeader"),m=b("BCol"),x=b("BRow"),y=b("BCardBody"),h=b("BCard"),z=b("BButton"),M=b("BBadge"),j=b("BLink");return d(),c(P,null,[o(h,null,{default:i(()=>[o(L,{title:"Taxi Ride"}),o(O,{class:"border-0"},{default:i(()=>[o(T,{user:r.user},null,8,["user"])]),_:1}),o(x,null,{default:i(()=>[o(m,{lg:"12"},{default:i(()=>[o(h,{"no-body":"",id:"tasksList"},{default:i(()=>[o(O,{class:"border-0"},{default:i(()=>[e("h3",null,s(l.$t("view_details")),1)]),_:1}),o(y,{class:"border border-dashed border-end-0 border-start-0"},{default:i(()=>[o(x,null,{default:i(()=>[o(m,{lg:"12"},{default:i(()=>[e("div",le,[a[2]||(a[2]=e("div",{class:"mt-3"},null,-1)),e("div",re,[e("div",ie,[a[1]||(a[1]=e("div",{class:"card-body"},[e("div",{id:"map",style:{height:"400px"}})],-1)),e("div",oe,[e("div",de,[e("span",ne,[p(s(l.$t("request_id"))+" : ",1),e("strong",null,s(t.result.request_number??"-"),1)])]),e("div",ce,[e("span",ue,[p(s(l.$t("ride_otp"))+" : ",1),e("strong",null,s(t.result.ride_otp??"-"),1)])])])])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(x,null,{default:i(()=>[t.result.driverDetail?(d(),C(m,{key:0,lg:"4"},{default:i(()=>[o(h,{class:"card-animate border border-dashed border-primary"},{default:i(()=>[o(y,null,{default:i(()=>{var n,w,A,B,_;return[e("div",_e,[e("div",me,[e("span",fe,[e("img",{src:(w=(n=t.result.driverDetail)==null?void 0:n.data)==null?void 0:w.profile_picture,class:"img-fluid avatar-md rounded-circle",alt:""},null,8,ve)])]),e("div",pe,[e("h6",he,s(t.result.driverDetail?(A=t.result.driverDetail.data)==null?void 0:A.name:"-"),1),e("p",be,[a[3]||(a[3]=e("i",{class:"mdi mdi-circle-medium text-success fs-15 align-middle"},null,-1)),p(" "+s(t.result.driverDetail?(B=t.result.driverDetail.data)==null?void 0:B.mobile:"-"),1)]),e("p",ye,[a[4]||(a[4]=e("i",{class:"mdi mdi-circle-medium text-success fs-15 align-middle"},null,-1)),p(" "+s(t.result.driverDetail?(_=t.result.driverDetail.data)==null?void 0:_.email:"-"),1)])])])]}),_:1})]),_:1})]),_:1})):u("",!0),o(m,{lg:"4"},{default:i(()=>[o(h,{class:"card-animate border border-dashed border-primary"},{default:i(()=>[o(y,null,{default:i(()=>[e("div",ge,[a[5]||(a[5]=e("div",{class:"avatar-xs flex-shrink-0"},[e("span",{class:"avatar-title bg-light rounded-circle"},[e("i",{class:"ri-map-pin-fill icon-dual-success fs-18"})])],-1)),e("div",ke,[e("h6",xe,s(l.$t("pickup_location")),1),e("p",we,s(t.result.pick_address),1)])])]),_:1})]),_:1})]),_:1}),o(m,{lg:"4"},{default:i(()=>[t.result.drop_address?(d(),C(h,{key:0,class:"card-animate border border-dashed border-primary"},{default:i(()=>[o(y,null,{default:i(()=>[e("div",Be,[a[6]||(a[6]=e("div",{class:"avatar-xs flex-shrink-0"},[e("span",{class:"avatar-title bg-light rounded-circle"},[e("i",{class:"ri-map-pin-fill icon-dual-danger fs-18"})])],-1)),e("div",qe,[e("h6",Ce,s(l.$t("drop_location")),1),e("p",Me,s(t.result.drop_address),1)])])]),_:1})]),_:1})):u("",!0)]),_:1}),o(m,{lg:"6"},{default:i(()=>[o(h,{class:"card-animate border border-dashed border-primary"},{default:i(()=>[o(y,null,{default:i(()=>[e("div",De,[a[8]||(a[8]=e("div",{class:"avatar-xs flex-shrink-0"},[e("span",{class:"avatar-title bg-light rounded-circle"},[e("i",{class:"ri-route-fill icon-dual-primary fs-18"})])],-1)),e("div",Se,[e("h6",Le,s(l.$t("trip_status"))+s(t.result.is_bid_ride?l.$t("bidding"):""),1),e("p",Te,[e("div",null,[e("p",Oe,s(t.rideStatus),1),!t.result.is_cancelled&&!t.result.is_trip_start?(d(),C(z,{key:0,class:"btn btn-danger btn-md",type:"button",onClick:a[0]||(a[0]=K(n=>t.deleteModal(t.result.id),["prevent"]))},{default:i(()=>[a[7]||(a[7]=e("i",{class:"bx bx-show-alt align-center text-muted me-2"},null,-1)),p(" "+s(l.$t("cancel")),1)]),_:1,__:[7]})):u("",!0),t.paymentGateways.length>0?(d(),C(z,{key:1,"data-bs-toggle":"modal","data-bs-target":"#pay",class:"btn btn-success btn-md",type:"button"},{default:i(()=>[p(s(l.$t("pay")),1)]),_:1})):u("",!0)])])]),t.result.rental_package_name!=="-"?(d(),c("div",ze,[e("h6",je,s(l.$t("rental_pack")),1),e("p",Ae,[e("div",null,[e("p",Ue,s(t.result.rental_package_name),1)])])])):u("",!0),e("div",Ze,[e("h6",Pe,s(l.$t("ride_type")),1),e("p",Ve,[e("div",null,[e("p",Fe,s(l.dispatch_type),1)])]),t.result.is_completed?u("",!0):(d(),c("p",He,s(l.$t("tripStarted"))+" : "+s(t.result.converted_trip_start_time),1)),t.result.is_round_trip?(d(),c("h6",Ie,s(l.$t("return_time")),1)):u("",!0),t.result.is_round_trip?(d(),c("p",Re,[e("div",null,[e("p",We,s(t.result.return_time),1)])])):u("",!0)]),e("div",Ne,[e("h6",Ee,s(t.result.vehicle_type_name??"-"),1),e("p",Ge,[t.result.transport_type==="taxi"?(d(),c("span",Ye,s(l.$t("taxi"))+" "+s(t.result.is_bid_ride?l.$t("bidding"):""),1)):t.result.transport_type==="delivery"?(d(),c("span",Je,s(l.$t("delivery"))+" "+s(t.result.is_bid_ride?l.$t("bidding"):""),1)):(d(),c("span",Xe,s(l.$t("all")),1))])])])]),_:1})]),_:1})]),_:1}),t.stops.length>0?(d(),C(m,{key:1,lg:"4"},{default:i(()=>[o(h,{class:"card-animate border border-dashed border-primary"},{default:i(()=>[o(y,null,{default:i(()=>[e("div",Ke,[a[9]||(a[9]=e("div",{class:"avatar-xs flex-shrink-0"},[e("span",{class:"avatar-title bg-light rounded-circle"},[e("i",{class:"ri-map-pin-fill icon-dual-danger fs-18"})])],-1)),e("div",Qe,[e("h6",$e,s(l.$t("location")),1),(d(!0),c(P,null,F(t.stops,(n,w)=>(d(),c("p",et,s(n.address),1))),256))])])]),_:1})]),_:1})]),_:1})):u("",!0)]),_:1}),o(x,null,{default:i(()=>{var n;return[e("div",tt,[t.result.driverDetail&&((n=t.result.driverDetail.data)!=null&&n.mobile)?(d(),c("a",{key:0,href:`tel:${t.result.driverDetail.data.mobile}`,type:"button",class:"btn btn-success btn-label waves-effect waves-light fs-18"},[a[10]||(a[10]=e("i",{class:"ri-phone-fill label-icon align-middle fs-16 me-2"},null,-1)),p(" "+s(l.$t("call")),1)],8,st)):(d(),c("span",at))]),t.result.requestBill?(d(),C(m,{key:0,lg:"12"},{default:i(()=>[o(h,null,{default:i(()=>[o(y,null,{default:i(()=>[e("h4",lt,s(l.$t("fare_breakup")),1),e("div",rt,[e("table",it,[e("tbody",null,[e("tr",null,[e("td",null,s(l.$t("base_price")),1),e("td",ot,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.base_price),1)]),e("tr",null,[e("td",null,s(l.$t("distance_price")),1),e("td",dt,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.distance_price),1)]),e("tr",null,[e("td",null,s(l.$t("time_price")),1),e("td",nt,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.time_price),1)]),t.result.requestBill.data.cancellation_fee>0?(d(),c("tr",ct,[e("td",null,s(l.$t("cancellation_fee")),1),e("td",ut,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.cancellation_fee),1)])):u("",!0),e("tr",null,[e("td",null,s(l.$t("service_tax")),1),e("td",_t,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.service_tax),1)]),e("tr",null,[e("td",null,s(l.$t("convenience_fee")),1),e("td",mt,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.admin_commision),1)]),t.result.requestBill.data.promo_discount>0?(d(),c("tr",ft,[e("td",null,s(l.$t("promo_discount")),1),e("td",vt,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.promo_discount),1)])):u("",!0),t.result.requestBill.data.tips>0?(d(),c("tr",pt,[e("td",null,s(l.$t("driver_tips")),1),e("td",ht,s(t.result.requested_currency_symbol)+s(t.result.requestBill.data.tips),1)])):u("",!0),t.result.requestBill.data.waiting_charge>0?(d(),c("tr",bt,[e("td",null,s(l.$t("waiting_charge"))+"("+s(l.$t("For"))+" "+s(t.result.requestBill.data.waiting_charge)+" min)",1),e("td",yt,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.waiting_charge),1)])):u("",!0),t.result.requestBill.data.airport_surge_fee>0&&t.result.transport_type==="taxi"?(d(),c("tr",gt,[e("td",null,s(l.$t("airport_surge_fee")),1),e("td",kt,s(t.result.requested_currency_symbol)+s(t.result.requestBill.data.airport_surge_fee),1)])):u("",!0),t.result.payment_opt?(d(),c("tr",xt,[e("td",null,s(l.$t("payment_option")),1),t.result.payment_opt==0?(d(),c("td",wt,[o(M,{variant:"success",class:"text-uppercase"},{default:i(()=>[p(s(l.$t("card")),1)]),_:1})])):u("",!0),t.result.payment_opt==1?(d(),c("td",Bt,[o(M,{variant:"success",class:"text-uppercase"},{default:i(()=>[p(s(l.$t("cash")),1)]),_:1})])):u("",!0),t.result.payment_opt==2?(d(),c("td",qt,[o(M,{variant:"success",class:"text-uppercase"},{default:i(()=>[p(s(l.$t("wallet")),1)]),_:1})])):u("",!0),t.result.payment_opt==3?(d(),c("td",Ct,[o(M,{variant:"success",class:"text-uppercase"},{default:i(()=>[p(s(l.$t("wallet/cash")),1)]),_:1})])):u("",!0)])):u("",!0),e("tr",Mt,[e("th",Dt,s(l.$t("total")),1),e("th",St,s(t.result.requested_currency_symbol)+" "+s(t.result.requestBill.data.total_amount),1)])])])])]),_:1})]),_:1})]),_:1})):u("",!0)]}),_:1})]),_:1}),e("div",Lt,[e("div",Tt,[e("div",Ot,[e("div",zt,[e("h5",jt,s(l.$t("payment_option")),1),a[11]||(a[11]=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),e("div",At,[o(x,{style:{"max-height":"400px","overflow-y":"auto"}},{default:i(()=>[(d(!0),c(P,null,F(t.paymentGateways,(n,w)=>(d(),C(m,{lg:"12"},{default:i(()=>[o(j,{href:n.url+`?user_id=${r.user.id}&request_id=${t.result.id}&amount=${t.result.requestBill.data.total_amount}`,class:"d-flex"},{default:i(()=>[e("img",{src:n.image,alt:n.gateway,width:"200",class:"img-fluid m-auto"},null,8,Ut)]),_:2},1032,["href"])]),_:2},1024))),256))]),_:1})])])])])],64)}const Nt=I(ae,[["render",Zt]]);export{Nt as default};
