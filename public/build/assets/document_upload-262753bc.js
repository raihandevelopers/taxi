import{_ as H,Z as L,P as j,C as q,T as D,r as p,G as N,g as c,o as r,x as P,w as g,a as V,N as O,k as u,l as t,y as b,J as i,q as w,M,i as s,L as F,F as k,B as x,n as E}from"./vendor-ddfbd976.js";import{L as G}from"./main-306a5ea6.js";import{P as J}from"./page-header-2dc95532.js";import{F as Z}from"./FormValidation-a9047131.js";import{i as z}from"./documentUpload-8b8da3ef.js";import{I as A}from"./ImageUpload-6f09ff26.js";import"./footer-e648049d.js";import"./app-042fb454.js";const K={components:{Layout:G,PageHeader:J,Head:L,FormValidation:Z,flatPickr:j,imageUpload:z,ImageUpload:A},props:{successMessage:String,alertMessage:String,driverId:Object,document:Object,uploaded:Object,validate:Function},setup(e){const{t:a}=q(),d=D({name:e.document&&e.document.name||"",identify_number:e.uploaded&&e.uploaded.identify_number||"",expiry_date:e.uploaded&&e.uploaded.expiry_date||"",image:e.uploaded&&e.uploaded.image||"",back_image:e.uploaded&&e.uploaded.back_image||"",iconFile:null}),o={name:{required:!0},image:{required:!0},back_image:e.document&&e.document.image_type==="front_and_back"?{required:!0}:{},identify_number:e.document&&e.document.has_identify_number?{required:!0}:{},expiry_date:e.document&&e.document.has_expiry_date?{required:!0}:{}},I=p(null),_=p({}),y=p(e.successMessage||""),f=p(e.alertMessage||""),B=()=>{y.value="",f.value=""},S=async()=>{if(_.value=I.value.validate(),console.log(_),Object.keys(_.value).length>0)return;const m=new FormData;Object.keys(d.data()).forEach(l=>{m.append(l,d[l])}),d.image&&m.append("image",d.image),d.back_image&&m.append("backImageFile",d.back_image);try{let l;e.document&&e.document.id?l=await V.post(`/approved-drivers/document-upload/${e.document.id}/${e.driverId.id}`,m,{headers:{"Content-Type":"multipart/form-data"}}):l=await V.post(`/approved-drivers/document-upload/${e.driverId.id}`,m,{headers:{"Content-Type":"multipart/form-data"}}),l.status===201?(y.value=a("document_successfully_uploaded"),d.reset(),O.get(`/approved-drivers/document/${e.driverId.id}`)):f.value=a("failed_to_upload_document")}catch(l){l.response&&l.response.status===422?_.value=l.response.data.errors:(console.error(a("error_uploading_document"),l),f.value=a("failed_to_upload_document"))}},h=p(""),C=N(()=>d.iconFile?h.value:e.uploaded&&e.uploaded.image?e.uploaded.image:"/default-profile.jpeg");return{form:d,successMessage:y,alertMessage:f,handleSubmit:S,dismissMessage:B,validationRules:o,validationRef:I,errors:_,imageSrc:C,handleImageSelected:(m,l)=>{d[l]=m},handleImageRemoved:m=>{d[m]=null}}}},Q={class:"row"},W={class:"col-6"},X={class:"mb-3"},Y={for:"name",class:"form-label"},$=["placeholder"],ee={key:0,class:"col-6"},ae={class:"mb-3"},te={for:"identify_number",class:"form-label"},oe=["placeholder"],de={key:1,class:"col-6"},ne={class:"mb-3"},le={for:"expiry_date",class:"form-label"},re={class:"row"},se={class:"col-sm-6"},ie={class:"mb-3"},me={for:"document",class:"form-label d-flex"},ce={key:0,class:"text-danger"},ue={key:0,class:"col-sm-6"},_e={class:"mb-3"},fe={for:"back_document",class:"form-label d-flex"},ge={key:0,class:"text-danger"},be={class:"col-lg-12"},ye={class:"text-end"},ve={type:"submit",class:"btn btn-primary"};function pe(e,a,d,o,I,_){const y=c("Head"),f=c("PageHeader"),B=c("BCardHeader"),S=c("flat-pickr"),h=c("ImageUpload"),C=c("FormValidation"),R=c("BCardBody"),U=c("BCard"),m=c("BCol"),l=c("BRow"),T=c("Layout");return r(),P(T,null,{default:g(()=>[u(y,{title:"Document Upload"}),u(f,{title:d.document?e.$t("edit"):e.$t("upload"),pageTitle:e.$t("document_upload"),pageLink:"/approved-drivers"},null,8,["title","pageTitle"]),u(l,null,{default:g(()=>[u(m,{lg:"12"},{default:g(()=>[u(U,{"no-body":"",id:"tasksList"},{default:g(()=>[u(B,{class:"border-0"}),u(R,{class:"border border-dashed border-end-0 border-start-0"},{default:g(()=>[t("form",{onSubmit:a[7]||(a[7]=E((...n)=>o.handleSubmit&&o.handleSubmit(...n),["prevent"])),enctype:"multipart/form-data"},[u(C,{form:o.form,rules:o.validationRules,ref:"validationRef"},{default:g(()=>[t("div",Q,[t("div",W,[t("div",X,[t("label",Y,[b(i(e.$t("name"))+" ",1),a[8]||(a[8]=t("span",{class:"text-danger"},"*",-1))]),w(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_name"),id:"name","onUpdate:modelValue":a[0]||(a[0]=n=>o.form.name=n),readonly:""},null,8,$),[[M,o.form.name]]),(r(!0),s(k,null,F(o.errors.name,(n,v)=>(r(),s("span",{key:v,class:"text-danger"},i(n),1))),128))])]),d.document&&d.document.has_identify_number==1?(r(),s("div",ee,[t("div",ae,[t("label",te,[b(i(e.$t("identify_number"))+" ",1),a[9]||(a[9]=t("span",{class:"text-danger"},"*",-1))]),w(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_identify_number"),id:"identify_number","onUpdate:modelValue":a[1]||(a[1]=n=>o.form.identify_number=n)},null,8,oe),[[M,o.form.identify_number]]),(r(!0),s(k,null,F(o.errors.identify_number,(n,v)=>(r(),s("span",{key:v,class:"text-danger"},i(n),1))),128))])])):x("",!0),d.document&&d.document.has_expiry_date==1?(r(),s("div",de,[t("div",ne,[t("label",le,[b(i(e.$t("expiry_date"))+" ",1),a[10]||(a[10]=t("span",{class:"text-danger"},"*",-1))]),u(S,{placeholder:e.$t("select_date"),id:"expiry_date",class:"form-control flatpickr-input",modelValue:o.form.expiry_date,"onUpdate:modelValue":a[2]||(a[2]=n=>o.form.expiry_date=n),config:e.rangeDateconfig},null,8,["placeholder","modelValue","config"]),(r(!0),s(k,null,F(o.errors.expiry_date,(n,v)=>(r(),s("span",{key:v,class:"text-danger"},i(n),1))),128))])])):x("",!0),t("div",re,[t("div",se,[t("div",ie,[t("label",me,[d.document&&d.document.image_type==="front_and_back"?(r(),s(k,{key:0},[b(i(d.document.document_name_front)+" ",1),a[11]||(a[11]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))],64)):(r(),s(k,{key:1},[b(i(e.$t("document"))+" ",1),a[12]||(a[12]=t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)",-1))],64))]),u(h,{imageType:"driver-documents",initialImageUrl:o.form.image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[3]||(a[3]=n=>o.handleImageSelected(n,"image")),onImageRemoved:a[4]||(a[4]=()=>o.handleImageRemoved("image"))},null,8,["initialImageUrl"]),o.errors.image?(r(),s("span",ce,i(o.errors.image),1)):x("",!0)])]),d.document&&d.document.image_type==="front_and_back"?(r(),s("div",ue,[t("div",_e,[t("label",fe,[b(i(d.document.document_name_back)+" ",1),a[13]||(a[13]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))]),u(h,{imageType:"driver-documents",initialImageUrl:o.form.back_image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[5]||(a[5]=n=>o.handleImageSelected(n,"back_image")),onImageRemoved:a[6]||(a[6]=()=>o.handleImageRemoved("back_image"))},null,8,["initialImageUrl"]),o.errors.backImageFile?(r(),s("span",ge,i(o.errors.backImageFile),1)):x("",!0)])])):x("",!0)]),t("div",be,[t("div",ye,[t("button",ve,i(d.document?e.$t("update"):e.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Re=H(K,[["render",pe]]);export{Re as default};
