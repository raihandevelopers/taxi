import{_ as L,Z as j,P as q,C as D,T as N,r as g,G as V,g as c,o as i,x as P,w as f,a as M,N as O,k as u,l as t,y as b,J as m,q as T,M as H,i as s,L as C,F as p,B as x,n as E}from"./vendor-ddfbd976.js";import{L as A}from"./main-306a5ea6.js";import{P as G}from"./page-header-2dc95532.js";import{F as J}from"./FormValidation-a9047131.js";import{i as Z}from"./documentUpload-8b8da3ef.js";import{I as z}from"./ImageUpload-6f09ff26.js";import"./footer-e648049d.js";import"./app-042fb454.js";const K={components:{Layout:A,PageHeader:G,Head:j,FormValidation:J,flatPickr:q,imageUpload:Z,ImageUpload:z},props:{successMessage:String,alertMessage:String,ownerId:Array,document:Object,uploaded:Object,validate:Function},setup(e){const{t:a}=D(),n=N({name:e.document&&e.document.name||"",identify_number:e.uploaded&&e.uploaded.identify_number||"",expiry_date:e.uploaded&&e.uploaded.expiry_date||"",image:e.uploaded&&e.uploaded.image||"",back_image:e.uploaded&&e.uploaded.back_image||"",iconFile:null,backImageFile:null}),o={name:{required:!0},identify_number:e.document&&e.document.has_identify_number?{required:!0}:{},expiry_date:e.document&&e.document.has_expiry_date?{required:!0}:{},image:e.document&&e.document.image?{required:!0}:{},back_image:e.document&&e.document.image_type==="front_and_back"?{required:!0}:{}},I=g(null),y=g({}),v=g(e.successMessage||""),_=g(e.alertMessage||""),w=()=>{v.value="",_.value=""},B=async()=>{if(y.value=I.value.validate(),Object.keys(y.value).length>0)return;const r=new FormData;Object.keys(n.data()).forEach(l=>{r.append(l,n[l])}),n.image&&r.append("image",n.image),n.back_image&&r.append("back_image",n.back_image);try{let l;e.document&&e.document.id?l=await M.post(`/manage-owners/document-upload/${e.document.id}/${e.ownerId.id}`,r,{headers:{"Content-Type":"multipart/form-data"}}):l=await M.post(`/manage-owners/document-upload/${e.ownerId.id}`,r,{headers:{"Content-Type":"multipart/form-data"}}),l.status===201?(v.value=a("document_successfully_uploaded"),n.reset(),O.get(`/manage-owners/document/${e.ownerId.id}`)):_.value=a("failed_to_upload_document")}catch(l){l.response&&l.response.status===422?y.value=l.response.data.errors:(console.error(a("error_uploading_document"),l),_.value=a("failed_to_upload_document"))}},h=g(""),S=V(()=>n.iconFile?h.value:e.uploaded&&e.uploaded.image?e.uploaded.image:"/default-profile.jpeg");g("");const F=V(()=>n.iconBackFile?iconBackFile.value:e.uploaded&&e.uploaded.back_image?e.uploaded.back_image:"/default-profile.jpeg");return{form:n,successMessage:v,alertMessage:_,handleSubmit:B,dismissMessage:w,validationRules:o,validationRef:I,errors:y,imageSrc:S,backImageSrc:F,handleImageSelected:(r,l)=>{n[l]=r},handleImageRemoved:r=>{n[r]=null}}}},Q={class:"row"},W={class:"col-6"},X={class:"mb-3"},Y={for:"name",class:"form-label"},$=["placeholder"],ee={key:0,class:"col-6"},ae={class:"mb-3"},te={for:"identify_number",class:"form-label"},oe=["placeholder"],ne={key:1,class:"col-6"},de={class:"mb-3"},le={for:"expiry_date",class:"form-label"},ie={class:"row"},se={class:"col-sm-6"},me={class:"mb-3"},re={for:"document",class:"form-label d-flex"},ce={key:0,class:"text-danger"},ue={key:0,class:"col-sm-6"},_e={class:"mb-3"},ge={for:"back_document",class:"form-label d-flex"},fe={key:0,class:"text-danger"},be={class:"col-lg-12"},ye={class:"text-end"},ve={type:"submit",class:"btn btn-primary"};function ke(e,a,n,o,I,y){const v=c("Head"),_=c("PageHeader"),w=c("BCardHeader"),B=c("flat-pickr"),h=c("ImageUpload"),S=c("FormValidation"),F=c("BCardBody"),R=c("BCard"),U=c("BCol"),r=c("BRow"),l=c("Layout");return i(),P(l,null,{default:f(()=>[u(v,{title:"Document Upload"}),u(_,{title:e.$t("create"),pageTitle:e.$t("document_upload"),pageLink:"/manage-owners"},null,8,["title","pageTitle"]),u(r,null,{default:f(()=>[u(U,{lg:"12"},{default:f(()=>[u(R,{"no-body":"",id:"tasksList"},{default:f(()=>[u(w,{class:"border-0"}),u(F,{class:"border border-dashed border-end-0 border-start-0"},{default:f(()=>[t("form",{onSubmit:a[7]||(a[7]=E((...d)=>o.handleSubmit&&o.handleSubmit(...d),["prevent"])),enctype:"multipart/form-data"},[u(S,{form:o.form,rules:o.validationRules,ref:"validationRef"},{default:f(()=>[t("div",Q,[t("div",W,[t("div",X,[t("label",Y,[b(m(e.$t("name"))+" ",1),a[8]||(a[8]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_name"),id:"name","onUpdate:modelValue":a[0]||(a[0]=d=>o.form.name=d),readonly:""},null,8,$),[[H,o.form.name]]),(i(!0),s(p,null,C(o.errors.name,(d,k)=>(i(),s("span",{key:k,class:"text-danger"},m(d),1))),128))])]),n.document&&n.document.has_identify_number==1?(i(),s("div",ee,[t("div",ae,[t("label",te,[b(m(e.$t("identify_number"))+" ",1),a[9]||(a[9]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_identify_number"),id:"identify_number","onUpdate:modelValue":a[1]||(a[1]=d=>o.form.identify_number=d)},null,8,oe),[[H,o.form.identify_number]]),(i(!0),s(p,null,C(o.errors.identify_number,(d,k)=>(i(),s("span",{key:k,class:"text-danger"},m(d),1))),128))])])):x("",!0),n.document&&n.document.has_expiry_date==1?(i(),s("div",ne,[t("div",de,[t("label",le,[b(m(e.$t("expiry_date"))+" ",1),a[10]||(a[10]=t("span",{class:"text-danger"},"*",-1))]),u(B,{placeholder:e.$t("select_date"),id:"expiry_date",class:"form-control flatpickr-input",modelValue:o.form.expiry_date,"onUpdate:modelValue":a[2]||(a[2]=d=>o.form.expiry_date=d),config:e.rangeDateconfig},null,8,["placeholder","modelValue","config"]),(i(!0),s(p,null,C(o.errors.expiry_date,(d,k)=>(i(),s("span",{key:k,class:"text-danger"},m(d),1))),128))])])):x("",!0),t("div",ie,[t("div",se,[t("div",me,[t("label",re,[n.document&&n.document.image_type==="front_and_back"?(i(),s(p,{key:0},[b(m(n.document.document_name_front)+" ",1),a[11]||(a[11]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))],64)):(i(),s(p,{key:1},[b(m(e.$t("document"))+" ",1),a[12]||(a[12]=t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)",-1))],64))]),u(h,{imageType:"owner-documents",initialImageUrl:o.form.image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[3]||(a[3]=d=>o.handleImageSelected(d,"image")),onImageRemoved:a[4]||(a[4]=()=>o.handleImageRemoved("image"))},null,8,["initialImageUrl"]),o.errors.image?(i(),s("span",ce,m(o.errors.image),1)):x("",!0)])]),n.document&&n.document.image_type==="front_and_back"?(i(),s("div",ue,[t("div",_e,[t("label",ge,[b(m(n.document.document_name_back)+" ",1),a[13]||(a[13]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))]),u(h,{imageType:"owner-documents",initialImageUrl:o.form.back_image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[5]||(a[5]=d=>o.handleImageSelected(d,"back_image")),onImageRemoved:a[6]||(a[6]=()=>o.handleImageRemoved("back_image"))},null,8,["initialImageUrl"]),o.errors.backImageFile?(i(),s("span",fe,m(o.errors.backImageFile),1)):x("",!0)])])):x("",!0)]),t("div",be,[t("div",ye,[t("button",ve,m(n.document?e.$t("update"):e.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Ce=L(K,[["render",ke]]);export{Ce as default};
