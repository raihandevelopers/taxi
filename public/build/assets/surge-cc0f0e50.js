import{_ as $,R as q,Z as A,P as E,z as W,C as G,r as M,$ as I,g as _,o as g,x as z,w as r,a as J,U as x,k as d,l as e,J as m,i as h,L as N,y as k,B,F as R,q as Z,M as K}from"./vendor-ddfbd976.js";import{L as Q}from"./main-306a5ea6.js";import{P as X}from"./page-header-2dc95532.js";import{l as Y}from"./footer-e648049d.js";import"./app-042fb454.js";const ee={data(){return{rightOffcanvas:!1}},computed:{...Y,...q(["permissions"])},components:{Layout:Q,PageHeader:X,Head:A,flatPickr:E,Link:W},props:{successMessage:String,alertMessage:String,zoneType:{type:Object,required:!0},surge:{type:Object,required:!0}},setup(a){const{t:o}=G(),T=M(a.successMessage||""),n=M(a.alertMessage||""),c=M(a.surge),w=M(a.zoneType),i=M({}),O=M("Sunday"),b=s=>{const t=s.getHours().toString().padStart(2,"0"),l=s.getMinutes().toString().padStart(2,"0");return`${t}:${l}`},f=s=>{const[t,l]=s.split(":").map(Number);return t*60+l},S={enableTime:!0,noCalendar:!0,dateFormat:"H:i",defaultDate:b(new Date)},v=I({Sunday:c?c.value.Sunday:[],Monday:c?c.value.Monday:[],Tuesday:c?c.value.Tuesday:[],Wednesday:c?c.value.Wednesday:[],Thursday:c?c.value.Thursday:[],Friday:c?c.value.Friday:[],Saturday:c?c.value.Saturday:[]}),C=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],V=s=>{if(D()){const t=new Date,l=new Date(t).addMinutes(60),p={index:v[s]?v[s].length+1:1,start_time:b(t),end_time:b(l),value:0};v[s].push(p)}F(s)},F=s=>{v[s].sort((t,l)=>{const p=f(t.start_time),u=f(l.start_time);return p-u})},D=()=>{let s=!0;return C.forEach(t=>{const l=v[t];l.length>1&&l.forEach((p,u)=>{if(u>0){const H=l[u-1],U=f(p.start_time)<f(H.end_time),L=f(p.end_time)<f(p.start_time);U?(i.value[t]||(i.value[t]={}),i.value[t][u]||(i.value[t][u]=[]),i.value[t][u]=o("surge_must_be_distinct"),s=!1):L?(i.value[t]||(i.value[t]={}),i.value[t][u]||(i.value[t][u]=[]),i.value[t][u]=o("surge_start_must_be_before_end"),s=!1):i.value[t]&&i.value[t][u]&&(delete i.value[t][u],Object.keys(i.value[t]).length===0&&delete i.value[t])}})}),s},P=async()=>{var s;try{if(D()){const t=await J.post(`/set-prices/surge/update/${(s=w==null?void 0:w.value)==null?void 0:s.id}`,{surge:v});c.value=t.data.surge,x.fire(o("success"),o("surge_updated_successfully"),"success")}}catch(t){console.log(t),x.fire(o("error"),o("surge_update_failed"),"error")}};return Date.prototype.addMinutes=function(s){return this.setMinutes(this.getMinutes()+s),this},{successMessage:T,alertMessage:n,fields:v,days:C,surgeUpdate:P,addField:V,sortBy:F,errors:i,removeField:(s,t)=>{v[s].splice(t,1)},activeDay:O,preloadingTime:S}}},se={class:"row"},te={class:"col-sm-3"},oe={class:"card border border-dashed border-primary"},ae={class:"card-body text-center"},le={class:"mb-3 flex-grow-1 text-start text-muted badge bg-secondary-subtle fs-18"},ne={class:"col-sm-3"},re={class:"card border border-dashed border-primary"},ie={class:"card-body text-center"},de={class:"mb-3 flex-grow-1 text-start text-muted badge bg-secondary-subtle fs-18"},ce={key:0,class:"text-danger"},ue={class:"text-muted"},me={class:"d-flex"},_e={class:"flex-grow-1 ms-2"},ge={class:"d-flex align-items-center gap-2"},fe={key:0,class:"d-flex flex-column align-items-center justify-content-center",style:{"min-height":"200px"}},ve={class:"text-muted mt-2"},pe={class:"col-sm-3"},be={class:"mb-3"},he={for:"from",class:"form-label"},ye={class:"col-sm-3"},ke={class:"mb-3"},Me={for:"to",class:"form-label"},Be={class:"col-sm-3"},Ce={class:"mb-3"},Te={for:"surge",class:"form-label"},we=["onUpdate:modelValue","placeholder"],Se={class:"col-sm-3"},Ve={class:"mt-3"},Fe={class:"form-check form-check-inline"},De=["onClick"],He={class:"col-sm-12"},Ue={key:0,class:"text-danger"},Le={class:"d-flex align-items-center gap-2"},ze={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Oe={class:"alert-content"},Pe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},je={class:"alert-content"};function xe(a,o,T,n,c,w){const i=_("Head"),O=_("PageHeader"),b=_("BCol"),f=_("BRow"),S=_("BCardHeader"),v=_("BCard"),C=_("BButton"),V=_("flat-pickr"),F=_("BCardBody"),D=_("BTab"),P=_("BTabs"),j=_("Layout");return g(),z(j,null,{default:r(()=>[d(i,{title:"Surge"}),d(O,{title:a.$t("surge"),pageTitle:a.$t("surge"),pageLink:"/set-prices"},null,8,["title","pageTitle"]),d(v,{"no-body":"",id:""},{default:r(()=>[d(S,{class:"border-0"},{default:r(()=>[d(f,null,{default:r(()=>[d(b,{lg:"12"},{default:r(()=>[e("div",se,[e("div",te,[e("div",oe,[e("div",ae,[e("h4",le,m(a.$t("zone")),1),e("h5",null,m(T.zoneType.zone_name),1)])])]),e("div",ne,[e("div",re,[e("div",ie,[e("h4",de,m(a.$t("vehicle_type")),1),e("h5",null,m(T.zoneType.vehicle_type_name),1)])])])])]),_:1})]),_:1})]),_:1})]),_:1}),d(f,null,{default:r(()=>[d(b,{lg:"12"},{default:r(()=>[d(v,{"no-body":"",id:"tasksList"},{default:r(()=>[d(P,{"nav-class":"nav-tabs-custom nav-success mb-3 pt-3",justified:"",modelValue:n.activeDay,"onUpdate:modelValue":o[0]||(o[0]=s=>n.activeDay=s)},{default:r(()=>[(g(!0),h(R,null,N(n.days,(s,t)=>(g(),z(D,{key:t,active:n.activeDay===s},{title:r(()=>{var l;return[k(m(s)+" ",1),(l=n.errors)!=null&&l[s]?(g(),h("span",ce,"*")):B("",!0)]}),default:r(()=>[e("div",ue,[e("div",me,[e("div",_e,[a.permissions.includes("update-zone-surge")?(g(),z(S,{key:0,class:"border-0"},{default:r(()=>[d(f,{class:"g-2"},{default:r(()=>[d(b,{md:"auto",class:"ms-auto"},{default:r(()=>[e("div",ge,[d(C,{variant:"primary",onClick:l=>n.addField(s)},{default:r(()=>[o[3]||(o[3]=e("i",{class:"ri-add-line align-bottom me-1"},null,-1)),k(" "+m(a.$t("add_new_surge")),1)]),_:2,__:[3]},1032,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:2},1024)):B("",!0),d(F,{class:"border border-dashed border-end-0 border-start-0"},{default:r(()=>[n.fields[s].length===0?(g(),h("div",fe,[o[4]||(o[4]=e("i",{class:"ri-file-add-line text-muted display-4"},null,-1)),e("p",ve,m(a.$t("add_surge")),1)])):(g(!0),h(R,{key:1},N(n.fields[s],(l,p)=>{var u,H,U,L;return g(),h("div",{key:l.index,class:"row d-flex align-items-center"},[e("div",pe,[e("div",be,[e("label",he,m(a.$t("from")),1),d(V,{modelValue:l.start_time,"onUpdate:modelValue":y=>l.start_time=y,onOnChange:y=>n.sortBy(s),placeholder:a.$t("from"),config:n.preloadingTime,class:"form-control flatpickr-input"},null,8,["modelValue","onUpdate:modelValue","onOnChange","placeholder","config"])])]),e("div",ye,[e("div",ke,[e("label",Me,m(a.$t("To")),1),d(V,{modelValue:l.end_time,"onUpdate:modelValue":y=>l.end_time=y,placeholder:a.$t("To"),config:n.preloadingTime,class:"form-control flatpickr-input"},null,8,["modelValue","onUpdate:modelValue","placeholder","config"])])]),e("div",Be,[e("div",Ce,[e("label",Te,m(a.$t("surge_value")),1),Z(e("input",{type:"text",class:"form-control","onUpdate:modelValue":y=>l.value=y,placeholder:a.$t("surge")},null,8,we),[[K,l.value]])])]),e("div",Se,[e("div",Ve,[e("div",Fe,[e("i",{class:"bx bx-trash text-danger fs-22 btn",onClick:y=>n.removeField(s,p)},null,8,De)])])]),e("div",He,[(H=(u=n.errors)==null?void 0:u[s])!=null&&H[p]?(g(),h("span",Ue,m((L=(U=n.errors)==null?void 0:U[s])==null?void 0:L[p]),1)):B("",!0)])])}),128)),a.permissions.includes("update-zone-surge")?(g(),z(f,{key:2,class:"g-2"},{default:r(()=>[d(b,{md:"auto",class:"ms-auto"},{default:r(()=>[e("div",Le,[d(C,{variant:"primary",onClick:l=>n.surgeUpdate(s)},{default:r(()=>[k(m(a.$t("update")),1)]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024)):B("",!0)]),_:2},1024)])])])]),_:2},1032,["active"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e("div",null,[n.successMessage?(g(),h("div",ze,[e("div",Oe,[o[5]||(o[5]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[6]||(o[6]=k()),o[7]||(o[7]=e("strong",null,"Success",-1)),k(" - "+m(n.successMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-success",onClick:o[1]||(o[1]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Success Message"})])])):B("",!0),n.alertMessage?(g(),h("div",Pe,[e("div",je,[o[8]||(o[8]=e("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[9]||(o[9]=k()),o[10]||(o[10]=e("strong",null,"Alert",-1)),k(" - "+m(n.alertMessage)+" ",1),e("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[2]||(o[2]=(...s)=>a.dismissMessage&&a.dismissMessage(...s)),"aria-label":"Close Alert Message"})])])):B("",!0)])]),_:1})}const Ee=$(ee,[["render",xe]]);export{Ee as default};
