import{_ as q,z as N,Z as O,R as Y,T as G,C as I,r as f,Q as A,D as J,g as u,S as Z,o as c,x as L,w as n,a as S,U as V,k as a,l as s,y as x,J as d,q as k,M as j,p as K,i as _,B as g,n as z,ad as W,L as X,F as $}from"./vendor-ddfbd976.js";import{L as ee}from"./main-306a5ea6.js";import{P as te}from"./page-header-2dc95532.js";import{l as se}from"./footer-e648049d.js";import"./app-042fb454.js";const oe={components:{Layout:ee,PageHeader:te,Link:N,Head:O},computed:{...se,...Y(["permissions"])},setup(){const o=G({slug:"",name:"",description:""}),{t:e}=I(),v=f(null),t=f([]),E=f({}),w=f(""),y=f(""),C=f(""),b=f(10),p=f(1),R=f(0),m=async()=>{try{const l=await S.get("/roles/list",{params:{page:p.value,perPage:b.value,searchQuery:C.value}});t.value=l.data.roles.data,E.value={currentPage:l.data.roles.current_page,lastPage:l.data.roles.last_page,from:l.data.roles.from,to:l.data.roles.to,total:l.data.roles.total},R.value=l.data.roles.total}catch(l){console.error(e("error_fetching_roles"),l)}},B=()=>{w.value="",y.value=""},P=()=>{o.reset(),v.value=null},H=l=>{v.value=l,o.slug=l.slug,o.name=l.name,o.description=l.description,o.clearErrors()},T=()=>{const{name:l,description:i}=o,h={},U={name:{test:()=>!l,message:"Role name is required"}};return Object.keys(U).forEach(D=>{U[D].test()&&(h[D]=U[D].message)}),h},F=async()=>{const l=T();if(Object.keys(l).length===0)try{let i;v.value?i=await S.put(`/roles/${v.value.id}`,o.data()):i=await S.post("/roles",o.data()),w.value=i.data.successMessage,y.value=i.data.alertMessage,setTimeout(()=>{w.value="",y.value=""},2e3),m(),o.reset(),P()}catch(i){if(console.error(e("error_handling_form_submission"),i),i.response&&i.response.status===422){const h=i.response.data.errors;o.errors=h}else console.error(e("an_unexpected_error_occurred"),i)}else o.errors=l},M=l=>{o.errors[l]=""},r=async l=>{try{await S.delete(`/roles/${l}`),V.fire("Success","Role deleted successfully","success"),m()}catch(i){console.error(e("error_deleting_role"),i),V.fire(e("error"),e("failed_to_delete_role"),"error")}},Q=async l=>{V.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async i=>{if(i.isConfirmed)try{await r(l)}catch(h){console.error(e("error_deleting_role"),h),V.fire(e("error"),e("failed_to_delete_role"),"error")}})};return A(p,()=>{m()}),A(C,()=>{m()}),J(()=>{m()}),{form:o,roles:t,selectedRole:v,paginator:E,successMessage:w,alertMessage:y,searchQuery:C,perPage:b,currentPage:p,rows:R,createRole:P,editRole:H,handleSubmit:F,deleteModal:Q,deleteRole:r,dismissMessage:B,hideError:M,fetchRoles:m}}},re={class:"form-group mt-3"},le={for:"name",class:"form-label"},ne={key:0,class:"text-danger"},ae={class:"form-group mt-3"},ie={for:"description",class:"form-label"},de={key:0,class:"text-danger"},ce={class:"text-end mt-4"},ue={key:0,type:"submit",class:"btn btn-success m-2 float-end"},me={class:"d-flex align-items-center mt-2"},fe={class:"search-box flex-grow-1 mr-1"},ge=["placeholder"],be={class:"table-responsive table-card mb-4"},pe={class:"table table-bordered align-middle table-nowrap mb-0 overflow-auto"},_e={class:"table-light"},ve={class:"d-flex"},ye={class:"d-flex justify-content-sm-end"},he={key:0,class:"custom-alert alert alert-success alert-border-left fade show",language:"alert",id:"alertMsg"},ke={class:"alert-content"},we={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",language:"alert",id:"alertMsg"},Ce={class:"alert-content"};function Be(o,e,v,t,E,w){const y=u("Head"),C=u("PageHeader"),b=u("BCol"),p=u("BRow"),R=u("BCardHeader"),m=u("BCard"),B=u("BButton"),P=u("Link"),H=u("BCardBody"),T=u("b-pagination"),F=u("Layout"),M=Z("b-tooltip");return c(),L(F,null,{default:n(()=>[a(y,{title:"Roles"}),a(C,{title:o.$t("roles"),pageTitle:o.$t("roles")},null,8,["title","pageTitle"]),a(p,null,{default:n(()=>[a(b,{lg:"12"},{default:n(()=>[a(m,{"no-body":"",id:"tasksList"},{default:n(()=>[a(R,{class:"border-0"},{default:n(()=>[s("form",{onSubmit:e[5]||(e[5]=z((...r)=>t.handleSubmit&&t.handleSubmit(...r),["prevent"])),onKeydown:e[6]||(e[6]=(...r)=>t.hideError&&t.hideError(...r))},[a(p,null,{default:n(()=>[a(b,{md:"4"},{default:n(()=>[s("div",re,[s("label",le,[x(d(o.$t("role_name")),1),e[12]||(e[12]=s("span",{class:"text-danger"},"*",-1))]),k(s("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=r=>t.form.name=r),class:K(["form-control",{"is-invalid":t.form.errors.name}]),onFocus:e[1]||(e[1]=r=>t.hideError("name"))},null,34),[[j,t.form.name]]),t.form.errors.name?(c(),_("div",ne,d(t.form.errors.name),1)):g("",!0)])]),_:1}),a(b,{md:"4"},{default:n(()=>[s("div",ae,[s("label",ie,d(o.$t("description")),1),k(s("input",{type:"text",id:"description","onUpdate:modelValue":e[2]||(e[2]=r=>t.form.description=r),class:K(["form-control",{"is-invalid":t.form.errors.description}]),onFocus:e[3]||(e[3]=r=>t.hideError("description"))},null,34),[[j,t.form.description]]),t.form.errors.description?(c(),_("div",de,d(t.form.errors.description),1)):g("",!0)])]),_:1})]),_:1}),a(p,{class:"g-3"},{default:n(()=>[s("div",ce,[o.permissions.includes("create_roles")?(c(),_("button",ue,d(t.selectedRole?o.$t("update"):o.$t("create")),1)):g("",!0),t.selectedRole?(c(),_("button",{key:1,type:"button",onClick:e[4]||(e[4]=(...r)=>t.createRole&&t.createRole(...r)),class:"btn btn-secondary m-2 float-end"},d(o.$t("cancel")),1)):g("",!0)])]),_:1})],32)]),_:1})]),_:1}),a(m,null,{default:n(()=>[a(H,{class:"border border-dashed border-end-0 border-start-0"},{default:n(()=>[a(b,{xxl:"4",class:"mb-5"},{default:n(()=>[s("div",me,[s("div",fe,[k(s("input",{type:"text",class:"form-control",placeholder:o.$t("search_slug_or_name"),"onUpdate:modelValue":e[7]||(e[7]=r=>t.searchQuery=r),onKeyup:e[8]||(e[8]=W((...r)=>t.fetchRoles&&t.fetchRoles(...r),["enter"]))},null,40,ge),[[j,t.searchQuery]]),e[13]||(e[13]=s("i",{class:"ri-search-line search-icon"},null,-1))])])]),_:1}),a(p,null,{default:n(()=>[a(b,{md:"12"},{default:n(()=>[s("div",be,[s("table",pe,[s("thead",_e,[s("tr",null,[s("th",null,d(o.$t("s_no")),1),s("th",null,d(o.$t("name")),1),s("th",null,d(o.$t("description")),1),s("th",null,d(o.$t("action")),1)])]),s("tbody",null,[(c(!0),_($,null,X(t.roles,(r,Q)=>(c(),_("tr",{key:r.id},[s("td",null,d((t.currentPage-1)*t.perPage+Q+1),1),s("td",null,d(r.name),1),s("td",null,d(r.description?r.description:"-"),1),s("td",null,[s("div",ve,[a(P,{href:`/permissions/${r.id}`},{default:n(()=>[o.permissions.includes("permissions_roles")?k((c(),L(B,{key:0,class:"btn btn-soft-success btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("permissions")},{default:n(()=>e[14]||(e[14]=[s("i",{class:"bx bxs-user-check bx-xs"},null,-1)])),_:1,__:[14]},8,["title"])),[[M,void 0,void 0,{hover:!0}]]):g("",!0)]),_:2},1032,["href"]),o.permissions.includes("edit_roles")?k((c(),L(B,{key:0,onClick:z(l=>t.editRole(r),["prevent"]),class:"btn btn-soft-warning btn-sm m-2","data-bs-toggle":"tooltip",title:o.$t("edit")},{default:n(()=>e[15]||(e[15]=[s("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[15]},1032,["onClick","title"])),[[M,void 0,void 0,{hover:!0}]]):g("",!0),o.permissions.includes("delete_roles")?k((c(),L(B,{key:1,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:z(l=>t.deleteModal(r.id),["prevent"]),"data-bs-toggle":"tooltip",title:o.$t("delete")},{default:n(()=>e[16]||(e[16]=[s("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[16]},1032,["onClick","title"])),[[M,void 0,void 0,{hover:!0}]]):g("",!0)])])]))),128))])])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),s("div",ye,[a(T,{modelValue:t.currentPage,"onUpdate:modelValue":e[9]||(e[9]=r=>t.currentPage=r),"total-rows":t.rows,"per-page":t.perPage,"aria-controls":"my-table",align:"right"},null,8,["modelValue","total-rows","per-page"])]),t.successMessage?(c(),_("div",he,[s("div",ke,[e[17]||(e[17]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[18]||(e[18]=x()),e[19]||(e[19]=s("strong",null,"Success",-1)),x(" - "+d(t.successMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-success",onClick:e[10]||(e[10]=(...r)=>t.dismissMessage&&t.dismissMessage(...r)),"aria-label":"Close Success Message"})])])):g("",!0),t.alertMessage?(c(),_("div",we,[s("div",Ce,[e[20]||(e[20]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[21]||(e[21]=x()),e[22]||(e[22]=s("strong",null,"Alert",-1)),x(" - "+d(t.alertMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[11]||(e[11]=(...r)=>t.dismissMessage&&t.dismissMessage(...r)),"aria-label":"Close Alert Message"})])])):g("",!0)]),_:1})}const Se=q(oe,[["render",Be]]);export{Se as default};
