import{_ as Y,Z as j,O as z,P as G,z as J,C as K,r as p,T as Q,R as Z,g as u,o as l,x as H,w as m,a as O,U as N,N as W,k as d,l as t,J as n,q as X,K as ee,i as g,L as V,F,y as f,B as C,n as $}from"./vendor-ddfbd976.js";import{L as te}from"./main-306a5ea6.js";import{P as se}from"./page-header-2dc95532.js";import{P as ae}from"./Pagination-f095ae3c.js";import{s as oe}from"./search-2c17aadd.js";import{s as ne}from"./searchbar-3acbc236.js";import{l as le}from"./footer-e648049d.js";import{_ as re}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const ie={data(){return{rightOffcanvas:!1,SearchQuery:""}},components:{Layout:te,PageHeader:se,Head:j,Pagination:ae,Multiselect:z,flatPickr:G,Link:J,search:oe,searchbar:ne},props:{successMessage:String,alertMessage:String,sos:{type:Object,required:!0}},setup(s){const{t:e}=K(),B=p(""),a=Q({all:"",locked:"",limit:10}),_=p([]),P=p({}),k=p(!1),y=p(!1),b=p(null),M=p({}),v=p(s.successMessage||""),x=p(s.alertMessage||""),S=()=>{v.value="",x.value=""},T=async(r,i)=>{try{await O.post("/sos/update-status",{id:r,status:i});const c=_.value.findIndex(U=>U.id===r);c!==-1&&(_.value[c].active===1?(v.value=e("sos_inactive_successfully"),_.value[c].active=i):(v.value=e("sos_active_successfully"),_.value[c].active=i),setTimeout(()=>{v.value=""},5e3))}catch(c){console.error(e("error_updating_status"),c)}},L=()=>{y.value=!0},A=()=>{a.reset(),h(),y.value=!1},E=()=>{k.value=!1},D=async r=>{try{await O.delete(`/sos/delete/${r}`);const i=_.value.findIndex(c=>c.id===r);i!==-1&&_.value.splice(i,1),k.value=!1,N.fire(e("success"),e("sos_deleted_successfully"),"success")}catch{N.fire(e("error"),e("failed_to_delete_sos"),"error")}},I=async r=>{N.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async i=>{if(i.isConfirmed)try{await D(r)}catch(c){console.error(e("error_deleting_data"),c),N.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},o=async r=>{B.value=r,h()},h=async(r=1)=>{try{const i=a.data();i.search=B.value,i.page=r;const c=await O.get("/sos/list",{params:i});_.value=c.data.results,P.value=c.data.paginator,q(P.value.total),y.value=!1}catch(i){console.error(e("error_fetching_sos"),i)}},w=async r=>{localStorage.setItem("sos/fetch",r),h(r)},R=async r=>{W.get(`/sos/edit/${r.id}`)},q=()=>{M.value=[10,25,50,100,200,500]};return{results:_,modalShow:k,deleteItemId:b,successMessage:v,alertMessage:x,filterData:L,deleteModal:I,closeModal:E,deleteData:D,dismissMessage:S,searchTerm:B,paginator:P,modalFilter:y,clearFilter:A,fetchDatas:h,filter:a,toggleActiveStatus:T,handlePageChanged:w,editData:R,fetchSearch:o,paginatorOption:M,changeEntriesPerPage:()=>{h()}}},computed:{...le,...Z(["permissions"])},mounted(){this.fetchDatas();const s=localStorage.getItem("sos/fetch");s?this.handlePageChanged(Number(s)):this.handlePageChanged(1)}},de={class:"d-flex align-items-center mt-3"},ce={class:"me-2 text-muted"},ue=["value"],me={class:"ms-2 text-muted"},ge={class:"d-flex align-items-center gap-2"},fe={class:"table-responsive"},_e={class:"table align-middle position-relative table-nowrap"},pe={class:"table-active"},ve={scope:"col"},he={scope:"col"},ye={scope:"col"},be={scope:"col"},Ce={key:0},ke={class:"dropdown"},we={class:"dropdown-menu dropdown-menu-end"},Be={key:0},Pe=["onClick"],Me=["onClick"],xe=["onClick"],Se=["onClick"],Le={key:1},De={colspan:"7",class:"text-center"},He={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ne={class:"alert-content"},Te={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Ae={class:"alert-content"};function Ee(s,e,B,a,_,P){const k=u("Head"),y=u("PageHeader"),b=u("BCol"),M=u("searchbar"),v=u("BButton"),x=u("Link"),S=u("BRow"),T=u("BCardHeader"),L=u("BBadge"),A=u("BCardBody"),E=u("BCard"),D=u("Pagination"),I=u("Layout");return l(),H(I,null,{default:m(()=>[d(k,{title:"Emergency Number"}),d(y,{title:s.$t("emergency_number"),pageTitle:s.$t("emergency_number")},null,8,["title","pageTitle"]),d(S,null,{default:m(()=>[d(b,{lg:"12"},{default:m(()=>[d(E,{"no-body":"",id:"tasksList"},{default:m(()=>[d(T,{class:"border-0"},{default:m(()=>[d(S,{class:"g-2"},{default:m(()=>[d(b,{md:"3"},{default:m(()=>[t("div",de,[t("label",ce,n(s.$t("show")),1),X(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.filter.limit=o),onChange:e[1]||(e[1]=(...o)=>a.changeEntriesPerPage&&a.changeEntriesPerPage(...o)),class:"form-select form-select-sm w-auto"},[(l(!0),g(F,null,V(a.paginatorOption,o=>(l(),g("option",{key:o,value:o},n(o),9,ue))),128))],544),[[ee,a.filter.limit]]),t("label",me,n(s.$t("entries")),1)])]),_:1}),d(b,{md:"3"}),d(b,{md:"auto",class:"ms-auto"},{default:m(()=>[t("div",ge,[d(M,{onSearch:a.fetchSearch},null,8,["onSearch"]),s.permissions.includes("add-sos")?(l(),H(x,{key:0,href:"/sos/create"},{default:m(()=>[d(v,{variant:"primary",class:"float-end"},{default:m(()=>[e[4]||(e[4]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),f(" "+n(s.$t("add_emergency_number")),1)]),_:1,__:[4]})]),_:1})):C("",!0)])]),_:1})]),_:1})]),_:1}),d(A,{class:"border border-dashed border-end-0 border-start-0"},{default:m(()=>[t("div",fe,[t("table",_e,[t("thead",pe,[t("tr",null,[t("th",ve,n(s.$t("name")),1),t("th",he,n(s.$t("sos_number")),1),t("th",ye,n(s.$t("status")),1),t("th",be,n(s.$t("action")),1)])]),a.results.length>0?(l(),g("tbody",Ce,[(l(!0),g(F,null,V(a.results,(o,h)=>(l(),g("tr",{key:h},[t("td",null,n(o.name),1),t("td",null,n(o.number),1),t("td",null,[o.active==1?(l(),H(L,{key:0,variant:"success",class:"text-uppercase"},{default:m(()=>[f(n(s.$t("active")),1)]),_:1})):(l(),H(L,{key:1,variant:"danger",class:"text-uppercase"},{default:m(()=>[f(n(s.$t("inactive")),1)]),_:1}))]),t("td",null,[t("div",ke,[e[9]||(e[9]=t("a",{class:"text-reset",href:"#","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},[t("span",{class:"text-muted fs-18"},[t("i",{class:"mdi mdi-dots-vertical"})])],-1)),t("div",we,[s.permissions.includes("toggle-sos")?(l(),g("div",Be,[o.active===1?(l(),g("a",{key:0,class:"dropdown-item",href:"#",onClick:w=>a.toggleActiveStatus(o.id,0)},[e[5]||(e[5]=t("i",{class:"bx bxs-low-vision align-center text-muted me-2"},null,-1)),f(" "+n(s.$t("inactive")),1)],8,Pe)):(l(),g("a",{key:1,class:"dropdown-item",href:"#",onClick:w=>a.toggleActiveStatus(o.id,1)},[e[6]||(e[6]=t("i",{class:"bx bx-show-alt align-center text-muted me-2"},null,-1)),f(" "+n(s.$t("active")),1)],8,Me))])):C("",!0),s.permissions.includes("edit-sos")?(l(),g("a",{key:1,class:"dropdown-item",href:"#",onClick:$(w=>a.editData(o),["prevent"])},[e[7]||(e[7]=t("i",{class:"bx bxs-edit-alt align-center text-muted me-2"},null,-1)),f(n(s.$t("edit")),1)],8,xe)):C("",!0),s.permissions.includes("delete-sos")?(l(),g("a",{key:2,class:"dropdown-item",href:"#",onClick:$(w=>a.deleteModal(o.id),["prevent"])},[e[8]||(e[8]=t("i",{class:"bx bxs-trash align-center text-muted me-2"},null,-1)),f(n(s.$t("delete")),1)],8,Se)):C("",!0)])])])]))),128))])):(l(),g("tbody",Le,[t("tr",null,[t("td",De,[e[10]||(e[10]=t("img",{src:re,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,n(s.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[a.successMessage?(l(),g("div",He,[t("div",Ne,[e[11]||(e[11]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[12]||(e[12]=f()),e[13]||(e[13]=t("strong",null,"Success",-1)),f(" - "+n(a.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[2]||(e[2]=(...o)=>a.dismissMessage&&a.dismissMessage(...o)),"aria-label":"Close Success Message"})])])):C("",!0),a.alertMessage?(l(),g("div",Te,[t("div",Ae,[e[14]||(e[14]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[15]||(e[15]=f()),e[16]||(e[16]=t("strong",null,"Alert",-1)),f(" - "+n(a.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[3]||(e[3]=(...o)=>a.dismissMessage&&a.dismissMessage(...o)),"aria-label":"Close Alert Message"})])])):C("",!0)]),d(D,{paginator:a.paginator,onPageChanged:a.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const ze=Y(ie,[["render",Ee]]);export{ze as default};
