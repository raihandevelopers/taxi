import{_ as X,Z as $,O as ee,P as te,z as se,C as ae,r as m,T as oe,Q as ne,R as le,g as d,S as ie,o as u,x as D,w as l,U as k,a as R,N as q,k as i,l as t,J as c,q as w,K as re,i as v,L as Y,F as Z,y as h,B as C,p as ce,n as H,W as j}from"./vendor-ddfbd976.js";import{L as de}from"./main-306a5ea6.js";import{P as ue}from"./page-header-2dc95532.js";import{P as fe}from"./Pagination-f095ae3c.js";import{s as me}from"./searchbar-3acbc236.js";import{u as ge,l as _e}from"./footer-e648049d.js";import{_ as ve}from"./search-file-ab3e1046.js";import"./app-042fb454.js";const pe={data(){return{rightOffcanvas:!1}},components:{Layout:de,PageHeader:ue,Head:$,Pagination:fe,Multiselect:ee,flatPickr:te,Link:se,searchbar:me},props:{successMessage:String,alertMessage:String,app_for:String,zones:{type:Object,required:!0}},setup(a){const{t:e}=ae(),B=m(""),{selectedLocation:s}=ge(),b=oe({status:null,service_location_id:null,limit:10}),y=m([]),M=m({}),L=m(a.successMessage||""),g=m(a.alertMessage||""),O=m(!1),f=m(!1),I=m(null),P=m({}),A=()=>{L.value="",g.value=""},F=async(n,r)=>{k.fire({title:e("are_you_sure"),text:e("you_are_about_to_change_status"),icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:e("yes"),cancelButtonText:e("cancel")}).then(async p=>{if(p.isConfirmed)try{await R.post("/zones/update-status",{id:n,status:r});const T=y.value.findIndex(W=>W.id===n);T!==-1&&(y.value[T].active=r),k.fire(e("changed"),e("status_updated_successfully"),"success")}catch(T){console.error(e("error_updating_status"),T),k.fire(e("error"),e("failed_to_update_status"),"error")}})},z=m(!1),N=()=>{_(),f.value=!0,z.value=!1},E=()=>{b.reset(),_(),z.value=!1},U=()=>{O.value=!1},V=async n=>{try{await R.delete(`/zones/delete/${n}`);const r=y.value.findIndex(p=>p.id===n);r!==-1&&y.value.splice(r,1),O.value=!1,k.fire(e("success"),e("zone_deleted_successfully"),"success")}catch(r){r.response&&r.response.status==403&&(g.value=r.response.data.alertMessage,setTimeout(()=>{g.value=""},5e3)),k.fire(e("error"),e("failed_to_delete_zone"),"error")}},S=async n=>{k.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#34c38f",cancelButtonColor:"#f46a6a",confirmButtonText:"Yes, delete it!"}).then(async r=>{if(r.isConfirmed)try{await V(n)}catch(p){console.error(e("error_deleting_data"),p),k.fire(e("error"),e("failed_to_delete_the_data"),"error")}})},o=async n=>{B.value=n,_()},_=async(n=1)=>{try{const r=b.data();r.search=B.value,r.page=n;const p=await R.get("/zones/fetch",{params:r});y.value=p.data.results,M.value=p.data.paginator,Q(M.value.total),f.value=!1,b.status!==""&&(r.status=b.status)}catch(r){console.error(e("error_fetching_zones"),r)}},x=async n=>{localStorage.setItem("zones/fetch",n),_(n)},G=async n=>{q.get(`/zones/edit/${n.id}`)},J=async n=>{q.get(`/zones/surge/${n.id}`)},K=async n=>{q.get(`/zones/map/${n.id}`)},Q=()=>{P.value=[10,25,50,100,200,500]};return ne(s,n=>{b.service_location_id=n,_()}),{results:y,deleteItemId:I,successMessage:L,alertMessage:g,filterData:N,deleteModal:S,closeModal:U,deleteData:V,dismissMessage:A,searchTerm:B,paginator:M,modalFilter:f,fetchSearch:o,clearFilter:E,fetchDatas:_,filter:b,selectedLocation:s,handlePageChanged:x,editData:G,mapData:K,toggleActiveStatus:F,surgeData:J,rightOffcanvas:z,paginatorOption:P,changeEntriesPerPage:()=>{_()}}},computed:{..._e,...le(["permissions"])},mounted(){this.filter.service_location_id=this.selectedLocation,this.fetchDatas();const a=localStorage.getItem("zones/fetch");a?this.handlePageChanged(Number(a)):this.handlePageChanged(1)}},he={class:"d-flex align-items-center mt-3"},be={class:"me-2 text-muted"},ye=["value"],ke={class:"ms-2 text-muted"},Ce={class:"d-flex align-items-center gap-2"},we={class:"table"},Be={class:"table align-middle position-relative table-nowrap"},Me={class:"table-active"},Pe={scope:"col"},ze={scope:"col"},Se={scope:"col"},xe={key:0},De={class:"d-flex"},Le={class:"flex-grow-1"},Oe={key:0},Ve=["onClick","id","checked"],Te={key:1},He={colspan:"4",class:"text-center"},Ie={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},Ae={class:"alert-content"},Fe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},Ne={class:"alert-content"},Ee={class:"offcanvas-body"},Ue={class:"mb-4"},Re={for:"status-select",class:"form-label text-muted text-uppercase fw-semibold mb-3"},qe={class:"form-check form-check-inline"},Ye={class:"form-check-label",for:"statusActive"},Ze={class:"form-check form-check-inline"},je={class:"form-check-label",for:"statusInactive"},Ge={class:"offcanvas-footer border-top p-3 text-center hstack gap-2"};function Je(a,e,B,s,b,y){const M=d("Head"),L=d("PageHeader"),g=d("BCol"),O=d("searchbar"),f=d("BButton"),I=d("Link"),P=d("BRow"),A=d("BCardHeader"),F=d("BCardBody"),z=d("BCard"),N=d("BForm"),E=d("BOffcanvas"),U=d("Pagination"),V=d("Layout"),S=ie("b-tooltip");return u(),D(V,null,{default:l(()=>[i(M,{title:"Zone"}),i(L,{title:a.$t("zone"),pageTitle:a.$t("zone")},null,8,["title","pageTitle"]),i(P,null,{default:l(()=>[i(g,{lg:"12"},{default:l(()=>[i(z,{"no-body":"",id:"tasksList"},{default:l(()=>[i(A,{class:"border-0"},{default:l(()=>[i(P,{class:"g-2"},{default:l(()=>[i(g,{md:"3"},{default:l(()=>[t("div",he,[t("label",be,c(a.$t("show")),1),w(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.filter.limit=o),onChange:e[1]||(e[1]=(...o)=>s.changeEntriesPerPage&&s.changeEntriesPerPage(...o)),class:"form-select form-select-sm w-auto"},[(u(!0),v(Z,null,Y(s.paginatorOption,o=>(u(),v("option",{key:o,value:o},c(o),9,ye))),128))],544),[[re,s.filter.limit]]),t("label",ke,c(a.$t("entries")),1)])]),_:1}),i(g,{md:"3"}),i(g,{md:"auto",class:"ms-auto"},{default:l(()=>[t("div",Ce,[i(O,{onSearch:s.fetchSearch},null,8,["onSearch"]),i(f,{variant:"danger",onClick:e[2]||(e[2]=o=>s.rightOffcanvas=!0)},{default:l(()=>[e[8]||(e[8]=t("i",{class:"ri-filter-2-line me-1 align-bottom"},null,-1)),h(" "+c(a.$t("filters")),1)]),_:1,__:[8]}),a.permissions.includes("add-zone")?(u(),D(I,{key:0,href:"/zones/create"},{default:l(()=>[i(f,{variant:"primary",class:"float-end",disabled:B.app_for==="demo"},{default:l(()=>[e[9]||(e[9]=t("i",{class:"ri-add-line align-bottom me-1"},null,-1)),h(" "+c(a.$t("add_zone")),1)]),_:1,__:[9]},8,["disabled"])]),_:1})):C("",!0)])]),_:1})]),_:1})]),_:1}),i(F,{class:"border border-dashed border-end-0 border-start-0"},{default:l(()=>[t("div",we,[t("table",Be,[t("thead",Me,[t("tr",null,[t("th",Pe,c(a.$t("name")),1),t("th",ze,c(a.$t("status")),1),t("th",Se,c(a.$t("action")),1)])]),s.results.length>0?(u(),v("tbody",xe,[(u(!0),v(Z,null,Y(s.results,(o,_)=>(u(),v("tr",{key:_},[t("td",null,[t("div",De,[t("div",Le,c(o.name),1)])]),a.permissions.includes("toggle-zone")?(u(),v("td",Oe,[t("div",{class:ce({"form-check":!0,"form-switch":!0,"form-switch-lg":!0,"form-switch-success":o.active})},[t("input",{class:"form-check-input",type:"checkbox",role:"switch",onClick:H(x=>s.toggleActiveStatus(o.id,!o.active),["prevent"]),id:"status_"+o.id,checked:o.active},null,8,Ve)],2)])):C("",!0),t("td",null,[a.permissions.includes("edit-price")?w((u(),D(f,{key:0,class:"btn btn-soft-warning btn-sm m-2",onClick:H(x=>s.editData(o),["prevent"]),"data-bs-toggle":"tooltip",title:a.$t("edit")},{default:l(()=>e[10]||(e[10]=[t("i",{class:"bx bxs-edit-alt bx-xs"},null,-1)])),_:2,__:[10]},1032,["onClick","title"])),[[S,void 0,void 0,{hover:!0}]]):C("",!0),a.permissions.includes("view-zone-map")?w((u(),D(f,{key:1,class:"btn btn-soft-info btn-sm m-2",size:"sm",type:"button",onClick:H(x=>s.mapData(o),["prevent"]),"data-bs-toggle":"tooltip",title:a.$t("zone_map_view")},{default:l(()=>e[11]||(e[11]=[t("i",{class:"ri-earth-line bx-xs"},null,-1)])),_:2,__:[11]},1032,["onClick","title"])),[[S,void 0,void 0,{hover:!0}]]):C("",!0),a.permissions.includes("delete-price")?w((u(),D(f,{key:2,class:"btn btn-soft-danger btn-sm m-2",size:"sm",type:"button",onClick:H(x=>s.deleteModal(o.id),["prevent"]),"data-bs-toggle":"tooltip",title:a.$t("delete")},{default:l(()=>e[12]||(e[12]=[t("i",{class:"bx bx-trash bx-xs"},null,-1)])),_:2,__:[12]},1032,["onClick","title"])),[[S,void 0,void 0,{hover:!0}]]):C("",!0)])]))),128))])):(u(),v("tbody",Te,[t("tr",null,[t("td",He,[e[13]||(e[13]=t("img",{src:ve,alt:"Loading...",style:{width:"100px"}},null,-1)),t("h5",null,c(a.$t("no_data_found")),1)])])]))])])]),_:1})]),_:1})]),_:1})]),_:1}),t("div",null,[s.successMessage?(u(),v("div",Ie,[t("div",Ae,[e[14]||(e[14]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[15]||(e[15]=h()),e[16]||(e[16]=t("strong",null,"Success",-1)),h(" - "+c(s.successMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-success",onClick:e[3]||(e[3]=(...o)=>s.dismissMessage&&s.dismissMessage(...o)),"aria-label":"Close Success Message"})])])):C("",!0),s.alertMessage?(u(),v("div",Fe,[t("div",Ne,[e[17]||(e[17]=t("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),e[18]||(e[18]=h()),e[19]||(e[19]=t("strong",null,"Alert",-1)),h(" - "+c(s.alertMessage)+" ",1),t("button",{type:"button",class:"btn-close btn-close-danger",onClick:e[4]||(e[4]=(...o)=>s.dismissMessage&&s.dismissMessage(...o)),"aria-label":"Close Alert Message"})])])):C("",!0)]),i(E,{modelValue:s.rightOffcanvas,"onUpdate:modelValue":e[7]||(e[7]=o=>s.rightOffcanvas=o),placement:"end",title:a.$t("zone_filters"),"header-class":"bg-light","body-class":"p-0 overflow-hidden","footer-class":"border-top p-3 text-center"},{default:l(()=>[i(N,null,{default:l(()=>[t("div",Ee,[t("div",Ue,[t("label",Re,c(a.$t("status")),1),t("div",null,[t("div",qe,[w(t("input",{class:"form-check-input",type:"radio",name:"status",id:"statusActive","onUpdate:modelValue":e[5]||(e[5]=o=>s.filter.status=o),value:"1"},null,512),[[j,s.filter.status]]),t("label",Ye,c(a.$t("active")),1)]),t("div",Ze,[w(t("input",{class:"form-check-input",type:"radio",name:"status",id:"statusInactive","onUpdate:modelValue":e[6]||(e[6]=o=>s.filter.status=o),value:"0"},null,512),[[j,s.filter.status]]),t("label",je,c(a.$t("inactive")),1)])])])]),t("div",Ge,[i(f,{variant:"light",class:"w-100",onClick:s.clearFilter},{default:l(()=>[h(c(a.$t("clear_filter")),1)]),_:1},8,["onClick"]),i(f,{type:"submit",variant:"success",class:"w-100",onClick:s.filterData},{default:l(()=>[h(c(a.$t("apply")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["modelValue","title"]),i(U,{paginator:s.paginator,onPageChanged:s.handlePageChanged},null,8,["paginator","onPageChanged"])]),_:1})}const ot=X(pe,[["render",Je]]);export{ot as default};
