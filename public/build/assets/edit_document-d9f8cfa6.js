import{_ as N,Z as T,P as A,O as E,C as O,r as m,T as j,g as c,o as i,x,w as b,a as I,N as Z,k as u,l as s,i as d,L as S,J as _,B as p,F as U,q,M as z,n as J,y as R}from"./vendor-ddfbd976.js";import{L as Y}from"./main-306a5ea6.js";import{P as G}from"./page-header-2dc95532.js";import{P as K}from"./Pagination-f095ae3c.js";import{i as Q}from"./imageUpload-4f5efd67.js";import{F as W}from"./FormValidation-a9047131.js";import"./footer-e648049d.js";import"./app-042fb454.js";/* empty css                                                    */const X={components:{Layout:Y,PageHeader:G,Head:T,Pagination:K,flatPickr:A,Multiselect:E,FormValidation:W,imageUpload:Q},props:{successMessage:String,alertMessage:String,countries:Array,timeZones:Array,driver:Object,neededDocuments:Object,documents:Object,validate:Function},setup(n){const{t:r}=O();m(n.driver||"");const g=m(n.neededDocuments||"");m(n.documents||"");const e=j({iconFile:g.value.map(()=>null),expiry_date:g.value.map((o,t)=>{var a,f,l;return o.has_expiry_date?(a=n.documents)!=null&&a[t]?(l=(f=n.documents)==null?void 0:f[t])==null?void 0:l.expiry_date:null:void 0}),identify_number:g.value.map((o,t)=>{var a,f,l;return o.has_identify_number?(a=n.documents)!=null&&a[t]?(l=(f=n.documents)==null?void 0:f[t])==null?void 0:l.identify_number:null:void 0})}),L={},H=m(null),h=m({}),v=m(n.successMessage||""),y=m(n.alertMessage||""),M=()=>{v.value="",y.value=""},k=new Date,C=new Date(k);C.setDate(k.getDate()+1);const F={minDate:C,dateFormat:"Y-m-d"},D=m([]),B=o=>n.documents&&n.documents[o]?n.documents[o].image:null,V=(o,t)=>{const a=o.target.files[0];e.iconFile[t]=a,a&&new FileReader().readAsDataURL(a)};return{form:e,successMessage:v,alertMessage:y,handleSubmit:async()=>{const o=new FormData;g.value.forEach((t,a)=>{e.iconFile[a]&&o.append(`iconFile_${a+1}`,e.iconFile[a]),e.expiry_date[a]!==void 0&&o.append(`expiry_date[${a}]`,e.expiry_date[a]),e.identify_number[a]!==void 0&&o.append(`identify_number[${a}]`,e.identify_number[a])});try{let t;t=await I.post(`/fleet-drivers/document/upload/${n.driver.id}`,o,{headers:{"Content-Type":"multipart/form-data"}}),t.status===201?(v.value=r("driver_document_uploaded_successfully"),e.reset(),Z.get("/fleet-drivers")):y.value=$t("failed_to_upload_driver_document")}catch(t){t.response&&t.response.status===422?h.value=t.response.data.errors:(console.error(r("error_upload_driver_document"),t),y.value=r("failed_to_upload_driver_document_catch"))}},dismissMessage:M,selectedCountry:m(null),selectedTimezone:m(null),validationRules:L,validationRef:H,errors:h,rangeDateconfig:F,imageSrc:B,iconUrl:D,onFileChange:V}}},$={class:"row"},ee={class:"col-sm-6"},te={class:"mb-3"},oe={for:"document",class:"form-label d-flex"},se={key:0,class:"text-danger"},ae={class:"col-sm-6"},ne={key:0,class:"mb-3"},re=["for"],le={key:1,class:"mb-3"},ie=["for"],de=["onUpdate:modelValue","placeholder","id"],ce={class:"mb-3"},me={key:0},ue=["src"],_e={class:"col-lg-12"},fe={class:"text-end"},ge={type:"submit",class:"btn btn-primary"},ye={key:0,class:"custom-alert alert alert-success alert-border-left fade show",role:"alert",id:"alertMsg"},be={class:"alert-content"},pe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",role:"alert",id:"alertMsg"},ve={class:"alert-content"};function he(n,r,g,e,L,H){const h=c("Head"),v=c("PageHeader"),y=c("BCardHeader"),M=c("imageUpload"),k=c("flat-pickr"),C=c("FormValidation"),F=c("BCardBody"),D=c("BCard"),B=c("BCol"),V=c("BRow"),P=c("Layout");return i(),x(P,null,{default:b(()=>[u(h,{title:"Edit Document"}),u(v,{title:"Create",pageTitle:"Edit Document",pageLink:"/fleet-drivers"}),u(V,null,{default:b(()=>[u(B,{lg:"12"},{default:b(()=>[u(D,{"no-body":"",id:"tasksList"},{default:b(()=>[u(y,{class:"border-0"}),u(F,{class:"border border-dashed border-end-0 border-start-0 form-steps"},{default:b(()=>[s("form",{onSubmit:r[0]||(r[0]=J((...o)=>e.handleSubmit&&e.handleSubmit(...o),["prevent"])),class:"form-steps",enctype:"multipart/form-data"},[u(C,{form:e.form,rules:e.validationRules,ref:"validationRef"},{default:b(()=>[(i(!0),d(U,null,S(g.neededDocuments,(o,t)=>{var a,f;return i(),d("div",$,[s("h4",null,_(o.name),1),s("div",ee,[s("div",te,[s("label",oe,_(n.$t("documents")),1),u(M,{onChange:l=>e.onFileChange(l,t),modelValue:e.form.iconFile[t],"onUpdate:modelValue":l=>e.form.iconFile[t]=l,src:e.iconUrl},null,8,["onChange","modelValue","onUpdate:modelValue","src"]),e.form.errors.icon?(i(),d("span",se,_(e.errors.iconFile[t]),1)):p("",!0)])]),s("div",ae,[o.has_expiry_date?(i(),d("div",ne,[s("label",{for:`expiry_date_${t}`,class:"form-label"},_(n.$t("expiry_date")),9,re),u(k,{placeholder:n.$t("select_expiry_date"),modelValue:e.form.expiry_date[t],"onUpdate:modelValue":l=>e.form.expiry_date[t]=l,config:e.rangeDateconfig,class:"form-control flatpickr-input",id:`expiry_date_${t}`},null,8,["placeholder","modelValue","onUpdate:modelValue","config","id"]),(i(!0),d(U,null,S((a=e.errors.expiry_date)==null?void 0:a[t],(l,w)=>(i(),d("span",{key:w,class:"text-danger"},_(l),1))),128))])):p("",!0),o.has_identify_number?(i(),d("div",le,[s("label",{for:`${o.identify_number_locale_key}_${t}`,class:"form-label"},_(o.identify_number_locale_key),9,ie),q(s("input",{type:"text",class:"form-control","onUpdate:modelValue":l=>e.form.identify_number[t]=l,placeholder:`Enter ${o.identify_number_locale_key}`,id:`${o.identify_number_locale_key}_${t}`},null,8,de),[[z,e.form.identify_number[t]]]),(i(!0),d(U,null,S((f=e.errors.identify_number)==null?void 0:f[t],(l,w)=>(i(),d("span",{key:w,class:"text-danger"},_(l),1))),128))])):p("",!0),s("div",ce,[e.imageSrc(t)?(i(),d("div",me,[s("img",{src:e.imageSrc(t),alt:"Document Image",style:{"max-width":"400px","max-height":"400px"}},null,8,ue)])):p("",!0)])])])}),256)),s("div",_e,[s("div",fe,[s("button",ge,_(n.$t("upload")),1)])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1}),s("div",null,[e.successMessage?(i(),d("div",ye,[s("div",be,[r[3]||(r[3]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),r[4]||(r[4]=s("strong",null,"Success",-1)),R(" - "+_(e.successMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-success",onClick:r[1]||(r[1]=(...o)=>e.dismissMessage&&e.dismissMessage(...o)),"aria-label":"Close Success Message"})])])):p("",!0),e.alertMessage?(i(),d("div",pe,[s("div",ve,[r[5]||(r[5]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),r[6]||(r[6]=s("strong",null,"Alert",-1)),R(" - "+_(e.alertMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-danger",onClick:r[2]||(r[2]=(...o)=>e.dismissMessage&&e.dismissMessage(...o)),"aria-label":"Close Alert Message"})])])):p("",!0)])]),_:1})}const Ue=N(X,[["render",he]]);export{Ue as default};
