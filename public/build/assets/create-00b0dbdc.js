import{_ as N,Z as q,O as T,C as j,r as b,T as A,G as P,g as m,o as d,x as O,w as p,a as B,N as Q,k as _,i as c,l as s,y as g,J as n,B as u,q as h,M as v,K as E,L as G,F as J,n as K}from"./vendor-ddfbd976.js";import{L as Z}from"./main-306a5ea6.js";import{P as z}from"./page-header-2dc95532.js";import{i as W}from"./vehicletypeIcon-aaf23b0d.js";import{I as X}from"./ImageUpload-6f09ff26.js";import{F as Y}from"./FormValidation-a9047131.js";import"./footer-e648049d.js";import"./app-042fb454.js";const $={components:{Layout:Z,PageHeader:z,Head:q,Multiselect:T,imageUpload:W,ImageUpload:X,FormValidation:Y},props:{user:Object,successMessage:String,alertMessage:String,app_for:String,countries:Array,default_dial_code:String,default_flag:String,default_country_id:Number},setup(e){const{t:o}=j(),y=b({dial_code:e.default_dial_code||"",flag:e.default_flag||""}),t=b({}),x=b(null),S=b(!1),a=A({name:e.user&&e.user.name||"",mobile:e.user&&e.user.mobile||"",email:e.user&&e.user.email||"",gender:e.user&&e.user.gender||"",password:e.user&&e.user.password||"",confirm_password:e.user&&e.user.password||"",profilePictureFile:null,profile_picture:e.user&&e.user.profile_picture||"",country:e.user?e.user.country.id||"":null}),k=b(e.successMessage||""),R=b(e.alertMessage||""),w={name:{required:!0},mobile:{required:!0},gender:{required:!0}},M=b(""),U=P(()=>e.countries.filter(l=>l.name.toLowerCase().includes(M.value.toLowerCase())));e.app_for=="demo"&&(a.mobile="**********",a.email="**********"),a.country=e.default_country_id;const F=l=>{l&&(y.value=l,a.country=l.id)},I=()=>{const l={};for(const i in w)w[i].required&&!a[i]&&(l[i]=o("this_field_is_required"));return l},V=async()=>{if(t.value=I(),Object.keys(t.value).length===0)try{if(a.mobile&&(!e.user||a.mobile!==e.user.mobile)&&(await B.get(`/users/check-mobile/${a.mobile}${e.user?`/${e.user.id}`:""}`)).data.exists){t.value.mobile=o("mobile_number_already_exists");return}if(a.email&&(!e.user||a.email!==e.user.email)&&(await B.get(`/users/check-email/${a.email}${e.user?`/${e.user.id}`:""}`)).data.exists){t.value.email=o("email_already_exists");return}const l=new FormData;for(const f in a)f==="profilePictureFile"&&a[f]?l.append("profile_picture",a[f]):l.append(f,a[f]);l.append("country",a.country),S.value=!0;let i;e.user?i=await B.post(`/users/update/${e.user.id}`,l):i=await B.post("store",l),i.status===200||i.status===201?(k.value=i.data.successMessage,a.reset(),Q.get("/users")):console.error(o("unexpected_response_status"),i.status)}catch(l){console.error(o("error_handling_form_submission"),l),l.response&&l.response.status===422?t.value=l.response.data.errors:console.error(o("an_unexpected_error_occurred"),l)}},L=l=>{const i=l.target.files[0];if(a.profilePictureFile=i,i){const f=new FileReader;f.onload=D=>{C.value=D.target.result},f.readAsDataURL(i)}},C=b(""),r=P(()=>a.profilePictureFile?C.value:e.user.profile_picture?e.user.profile_picture:"/default-profile.jpeg");return{form:a,successMessage:k,alertMessage:R,errors:t,handleSubmit:V,validationRef:x,validationRules:w,selectCountry:F,selectedCountry:y,searchQuery:M,filteredCountries:U,onFileChange:L,imageSrc:r,profilePictureUrl:C,handleImageSelected:(l,i)=>{a[i]=l},handleImageRemoved:l=>{a[l]=null},isButtonDisabled:S}}},ee={key:0,class:"custom-alert alert alert-success alert-border-left fade show",data:"alert",id:"alertMsg"},se={class:"alert-content"},oe={key:1,class:"custom-alert alert alert-danger alert-border-left fade show",data:"alert",id:"alertMsg"},te={class:"alert-content"},re={class:"row"},le={class:"col-sm-6"},ae={class:"mb-3"},ne={for:"name",class:"form-label"},ie=["placeholder"],de={key:0,class:"text-danger"},ce={class:"col-sm-6"},me={class:"mb-3"},ue={for:"select_gender",class:"form-label"},fe={selected:"",disabled:"",value:""},_e={value:"male"},ge={value:"female"},be={value:"others"},pe={key:0,class:"text-danger"},he={class:"col-sm-6"},ye={class:"form-label"},ve={class:"input-group","data-input-flag":""},we={class:"btn btn-light border",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Ce=["src"],ke={class:"ms-2 country-codeno"},Me=["placeholder"],Be={class:"dropdown-menu w-100"},Se={class:"p-2 px-3 pt-1 searchlist-input"},Re=["placeholder"],Ue={class:"list-unstyled dropdown-menu-list mb-0"},Fe=["onClick"],Ie=["src"],Ve={class:"align-middle"},Le={key:0,class:"text-danger"},xe={class:"col-sm-6"},Pe={class:"mb-3"},He={for:"email",class:"form-label"},De=["placeholder"],Ne={key:0,class:"text-danger"},qe={key:0,class:"col-sm-6"},Te={class:"mb-3"},je={for:"password",class:"form-label"},Ae=["placeholder"],Oe={key:0,class:"text-danger"},Qe={key:1,class:"col-sm-6"},Ee={class:"mb-3"},Ge={for:"confirm_password",class:"form-label"},Je=["placeholder"],Ke={key:0,class:"text-danger"},Ze={class:"col-sm-6"},ze={for:"profile_picture",class:"form-label"},We={key:0,class:"text-danger"},Xe={class:"col-sm-12 text-end"},Ye=["disabled"];function $e(e,o,y,t,x,S){const a=m("Head"),k=m("PageHeader"),R=m("tab"),w=m("BCardHeader"),M=m("ImageUpload"),U=m("FormValidation"),F=m("BCardBody"),I=m("BCard"),V=m("BCol"),L=m("BRow"),C=m("Layout");return d(),O(C,null,{default:p(()=>[_(a,{title:"User"}),_(k,{title:y.user?e.$t("edit"):e.$t("create"),pageTitle:e.$t("user"),pageLink:"/users"},null,8,["title","pageTitle"]),_(L,null,{default:p(()=>[_(V,{lg:"12"},{default:p(()=>[_(I,{"no-body":"",id:"tasksList"},{default:p(()=>[_(w,{class:"border-0"},{default:p(()=>[_(R),t.successMessage?(d(),c("div",ee,[s("div",se,[o[12]||(o[12]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[13]||(o[13]=g()),o[14]||(o[14]=s("strong",null,"Success",-1)),g(" - "+n(t.successMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-success",onClick:o[0]||(o[0]=(...r)=>e.dismissMessage&&e.dismissMessage(...r)),"aria-label":"Close Success Message"})])])):u("",!0),t.alertMessage?(d(),c("div",oe,[s("div",te,[o[15]||(o[15]=s("i",{class:"ri-notification-off-line me-3 align-middle"},null,-1)),o[16]||(o[16]=g()),o[17]||(o[17]=s("strong",null,"Alert",-1)),g(" - "+n(t.alertMessage)+" ",1),s("button",{type:"button",class:"btn-close btn-close-danger",onClick:o[1]||(o[1]=(...r)=>e.dismissMessage&&e.dismissMessage(...r)),"aria-label":"Close Alert Message"})])])):u("",!0)]),_:1}),_(F,{class:"border border-dashed border-end-0 border-start-0"},{default:p(()=>[s("form",{onSubmit:o[11]||(o[11]=K((...r)=>t.handleSubmit&&t.handleSubmit(...r),["prevent"])),enctype:"multipart/form-data"},[_(U,{form:t.form,rules:t.validationRules,ref:"validationRef"},{default:p(()=>[s("div",re,[s("div",le,[s("div",ae,[s("label",ne,[g(n(e.$t("name"))+" ",1),o[18]||(o[18]=s("span",{class:"text-danger"},"*",-1))]),h(s("input",{type:"text",class:"form-control",placeholder:e.$t("enter_name"),id:"name","onUpdate:modelValue":o[2]||(o[2]=r=>t.form.name=r)},null,8,ie),[[v,t.form.name]]),t.errors.name?(d(),c("span",de,n(t.errors.name),1)):u("",!0)])]),s("div",ce,[s("div",me,[s("label",ue,[g(n(e.$t("select_gender"))+" ",1),o[19]||(o[19]=s("span",{class:"text-danger"},"*",-1))]),h(s("select",{id:"gender",class:"form-select","onUpdate:modelValue":o[3]||(o[3]=r=>t.form.gender=r)},[s("option",fe,n(e.$t("choose_gender")),1),s("option",_e,n(e.$t("male")),1),s("option",ge,n(e.$t("female")),1),s("option",be,n(e.$t("others")),1)],512),[[E,t.form.gender]]),t.errors.gender?(d(),c("span",pe,n(t.errors.gender),1)):u("",!0)])]),s("div",he,[s("div",null,[s("label",ye,[g(n(e.$t("mobile"))+" ",1),o[20]||(o[20]=s("span",{class:"text-danger"},"*",-1))]),s("div",ve,[s("button",we,[s("img",{src:t.selectedCountry.flag,alt:"flag",height:"20",class:"country-flagimg rounded"},null,8,Ce),s("span",ke,n(t.selectedCountry.dial_code),1)]),h(s("input",{type:"text",class:"form-control rounded-end flag-input","onUpdate:modelValue":o[4]||(o[4]=r=>t.form.mobile=r),placeholder:e.$t("enter_number")},null,8,Me),[[v,t.form.mobile]]),s("div",Be,[s("div",Se,[h(s("input",{type:"text",class:"form-control form-control-sm border search-countryList",placeholder:e.$t("search_country_name_or_country_code"),"onUpdate:modelValue":o[5]||(o[5]=r=>t.searchQuery=r)},null,8,Re),[[v,t.searchQuery]])]),s("ul",Ue,[(d(!0),c(J,null,G(t.filteredCountries,r=>(d(),c("li",{key:r.id},[s("a",{href:"javascript:void(0);",class:"dropdown-item notify-item language py-2",onClick:H=>t.selectCountry(r)},[s("img",{src:r.flag,alt:"flag",class:"me-2 rounded",height:"18"},null,8,Ie),s("span",Ve,n(r.name)+" "+n(r.dial_code),1)],8,Fe)]))),128))])])]),t.errors.mobile?(d(),c("span",Le,n(t.errors.mobile),1)):u("",!0)])]),s("div",xe,[s("div",Pe,[s("label",He,[g(n(e.$t("email"))+" ",1),o[21]||(o[21]=s("span",{class:"text-danger"},"*",-1))]),h(s("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":o[6]||(o[6]=r=>t.form.email=r),placeholder:e.$t("enter_email")},null,8,De),[[v,t.form.email]]),t.errors.email?(d(),c("span",Ne,n(t.errors.email),1)):u("",!0)])]),y.user?u("",!0):(d(),c("div",qe,[s("div",Te,[s("label",je,[g(n(e.$t("password"))+" ",1),o[22]||(o[22]=s("span",{class:"text-danger"},"*",-1))]),h(s("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":o[7]||(o[7]=r=>t.form.password=r),placeholder:e.$t("enter_password")},null,8,Ae),[[v,t.form.password]]),t.errors.password?(d(),c("span",Oe,n(t.errors.password),1)):u("",!0)])])),y.user?u("",!0):(d(),c("div",Qe,[s("div",Ee,[s("label",Ge,[g(n(e.$t("confirm_password"))+" ",1),o[23]||(o[23]=s("span",{class:"text-danger"},"*",-1))]),h(s("input",{type:"password",class:"form-control",id:"confirm_password","onUpdate:modelValue":o[8]||(o[8]=r=>t.form.confirm_password=r),placeholder:e.$t("confirm_password")},null,8,Je),[[v,t.form.confirm_password]]),t.errors.confirm_password?(d(),c("span",Ke,n(t.errors.confirm_password),1)):u("",!0)])])),s("div",Ze,[s("label",ze,n(e.$t("profile_picture")),1),_(M,{imageType:"user-profile",initialImageUrl:t.form.profile_picture,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:o[9]||(o[9]=r=>t.handleImageSelected(r,"profile_picture")),onImageRemoved:o[10]||(o[10]=()=>t.handleImageRemoved("profile_picture")),onChange:t.onFileChange},null,8,["initialImageUrl","onChange"]),t.errors.profile_picture?(d(),c("span",We,n(t.errors.profile_picture),1)):u("",!0)]),s("div",Xe,[s("button",{type:"submit",class:"btn btn-primary",disabled:t.isButtonDisabled},n(e.$t("submit")),9,Ye)])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const ds=N($,[["render",$e]]);export{ds as default};
