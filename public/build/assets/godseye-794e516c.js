import{_ as P,Z as $,O as F,C as I,r as y,Q as U,D as R,g as o,o as N,x as E,w as d,k as s,l as n,J as g,y as j}from"./vendor-ddfbd976.js";import{L as z}from"./main-306a5ea6.js";import{P as G}from"./page-header-2dc95532.js";import{g as q}from"./googleMap-1f997b81.js";import{u as J}from"./footer-e648049d.js";import"./app-042fb454.js";const K={components:{Head:$,Layout:z,PageHeader:G,Multiselect:F,googleMap:q},props:{firebaseSettings:Object,map_key:String,service_location:Array,vehicle_type:Array,baseUrl:String,default_location:Object},setup(e){I();const i=y(null),r=y(null),t=y([]),{selectedLocation:D}=J(),L=y(e.service_location.map(a=>({value:a.id,label:a.name}))),T=y(e.vehicle_type.map(a=>({value:a.id,label:a.name}))),h=y({}),S=()=>{r.value=null,t.value=[],_()},V=()=>{_()},_=async()=>{firebase.database().ref("drivers").once("value",k=>{const f=k.val();f&&(h.value={},Object.keys(f).forEach(u=>{const l=f[u],c=l.g,v=w(c);if(v&&l.service_location_id){let p=!1;l.service_location_id&&L.value.find(m=>m.id==l.service_location_id)&&(p=!0),i.value&&(p=i.value==l.service_location_id);let B=Array.isArray(l.vehicle_types);r.value&&Array.isArray(l.vehicle_types)&&l.vehicle_types.length>0&&(B=(Array.isArray(l.vehicle_types)&&l.vehicle_types.some(m=>r.value===m))??!1);let A=t.value.length>0?t.value.includes("online"):!0,C=t.value.length>0?t.value.includes("onride"):!0,H=t.value.length>0?t.value.includes("offline"):!0,b=!1;l.hasOwnProperty("is_active")&&l.hasOwnProperty("is_available")&&(l.is_active==1&&l.is_available==!0&&A||l.is_active==1&&l.is_available==!1&&C||H)&&(b=!0),p&&B&&b&&(h.value[l.id]={lat:v.lat,lng:v.lon,type_icon:l.vehicle_type_icon})}}))})},w=a=>{const k="0123456789bcdefghjkmnpqrstuvwxyz",f=[16,8,4,2,1];let u=!0,l=-90,c=90,v=-180,p=180,B,A;if(a){for(let C=0;C<a.length;C++){let H=a.charAt(C),b=k.indexOf(H);for(let m=0;m<5;m++){let O=f[m];if(u){let M=(v+p)/2;b&O?v=M:p=M}else{let M=(l+c)/2;b&O?l=M:c=M}u=!u}}return B=(l+c)/2,A=(v+p)/2,{lat:B,lon:A}}};return U(D,a=>{i.value=a,_()}),U([r,t],()=>{_()}),R(async()=>{i.value=D.value;var a={apiKey:e.firebaseSettings.firebase_api_key,authDomain:e.firebaseSettings.firebase_auth_domain,databaseURL:e.firebaseSettings.firebase_database_url,projectId:e.firebaseSettings.firebase_project_id,storageBucket:e.firebaseSettings.firebase_storage_bucket,messagingSenderId:e.firebaseSettings.firebase_messaging_sender_id,appId:e.firebaseSettings.firebase_app_id};firebase.apps.length||firebase.initializeApp(a),_()}),{serviceLocations:L,vehicleTypes:T,selectedServiceLocations:i,selectedDriverModes:t,clearFilters:S,applyFilters:V,selectedVehicleTypes:r,driverMarkers:h}}},Q={class:"row"},Z={class:"col-12 col-lg-4"},W={class:"mb-3"},X={for:"select_driver_mode",class:"form-label"},Y={class:"col-12 col-lg-4"},x={class:"mb-3"},ee={for:"vehicle_type",class:"form-label"},le={class:"col-12 col-lg-6 d-flex gap-1"},te={id:"map",style:{height:"400px"}};function ae(e,i,r,t,D,L){const T=o("Head"),h=o("PageHeader"),S=o("Multiselect"),V=o("BButton"),_=o("BCardHeader"),w=o("googleMap"),a=o("BCardBody"),k=o("BCard"),f=o("BCol"),u=o("BRow"),l=o("Layout");return N(),E(l,null,{default:d(()=>[s(T,{title:e.$t("gods-eye")},null,8,["title"]),s(h,{title:e.$t("gods-eye"),pageTitle:e.$t("map")},null,8,["title","pageTitle"]),s(u,null,{default:d(()=>[s(f,{lg:"12"},{default:d(()=>[s(k,{"no-body":"",id:"tasksList"},{default:d(()=>[s(_,{class:"border-0"},{default:d(()=>[n("h4",null,g(e.$t("filters")),1),n("div",Q,[n("div",Z,[n("div",W,[n("label",X,g(e.$t("drivers")),1),s(S,{modelValue:t.selectedDriverModes,"onUpdate:modelValue":i[0]||(i[0]=c=>t.selectedDriverModes=c),id:"select_driver_mode",mode:"tags","close-on-select":!1,searchable:!0,onChange:t.applyFilters,"create-option":!1,options:[{value:"offline",label:e.$t("offline")},{value:"online",label:e.$t("online")},{value:"onride",label:e.$t("onride")}],placeholder:e.$t("select_mode")},null,8,["modelValue","onChange","options","placeholder"])])]),n("div",Y,[n("div",x,[n("label",ee,g(e.$t("vehicle_types")),1),s(S,{modelValue:t.selectedVehicleTypes,"onUpdate:modelValue":i[1]||(i[1]=c=>t.selectedVehicleTypes=c),options:t.vehicleTypes,label:"label","track-by":"value",multiple:"","close-on-select":"",placeholder:e.$t("select_vehicle_types")},null,8,["modelValue","options","placeholder"])])]),n("div",le,[s(V,{type:"button",variant:"success",class:"btn btn-md",onClick:t.applyFilters},{default:d(()=>[j(g(e.$t("apply")),1)]),_:1},8,["onClick"]),s(V,{type:"button",variant:"danger",class:"btn btn-md",onClick:t.clearFilters},{default:d(()=>[j(g(e.$t("clear")),1)]),_:1},8,["onClick"])])])]),_:1}),s(a,{class:"border border-dashed border-end-0 border-start-0"},{default:d(()=>[n("div",te,[s(w,{baseUrl:r.baseUrl,default_location:r.default_location,nearbyDrivers:t.driverMarkers,map_key:r.map_key,libraries:["marker"]},{default:d(()=>[j(g(e.$t("map_loading")),1)]),_:1},8,["baseUrl","default_location","nearbyDrivers","map_key"])])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const de=P(K,[["render",ae]]);export{de as default};
