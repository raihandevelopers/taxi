import{_ as L,Z as j,P as q,C as D,T as N,r as f,G as w,g as c,o as i,x as P,w as g,a as M,N as O,k as u,l as t,y as b,J as s,q as T,M as H,i as r,L as R,F as p,B as x,n as E}from"./vendor-ddfbd976.js";import{L as A}from"./main-306a5ea6.js";import{P as G}from"./page-header-2dc95532.js";import{F as J}from"./FormValidation-a9047131.js";import{i as Z}from"./documentUpload-8b8da3ef.js";import{I as z}from"./ImageUpload-6f09ff26.js";import"./footer-e648049d.js";import"./app-042fb454.js";const K={components:{Layout:A,PageHeader:G,Head:j,FormValidation:J,flatPickr:q,imageUpload:Z,ImageUpload:z},props:{successMessage:String,alertMessage:String,driverId:Array,document:Object,uploaded:Object,validate:Function},setup(e){const{t:a}=D(),o=N({name:e.document&&e.document.name||"",identify_number:e.uploaded&&e.uploaded.identify_number||"",expiry_date:e.uploaded&&e.uploaded.expiry_date||"",image:e.uploaded&&e.uploaded.image||"",back_image:e.uploaded&&e.uploaded.back_image||"",iconFile:null,backImageFile:null}),d={name:{required:!0},identify_number:e.document&&e.document.has_identify_number?{required:!0}:{},expiry_date:e.document&&e.document.has_expiry_date?{required:!0}:{},image:e.document&&e.document.image?{required:!0}:{},back_image:e.document&&e.document.image_type==="front_and_back"?{required:!0}:{}},I=f(null),y=f({}),v=f(e.successMessage||""),_=f(e.alertMessage||""),B=()=>{v.value="",_.value=""},S=async()=>{if(y.value=I.value.validate(),Object.keys(y.value).length>0)return;const m=new FormData;Object.keys(o.data()).forEach(l=>{m.append(l,o[l])}),o.image&&m.append("image",o.image),o.back_image&&m.append("back_image",o.back_image);try{let l;e.document&&e.document.id?l=await M.post(`/fleet-drivers/document-upload-store/${e.document.id}/${e.driverId.id}`,m,{headers:{"Content-Type":"multipart/form-data"}}):l=await M.post(`/fleet-drivers/document-upload-store/${e.driverId.id}`,m,{headers:{"Content-Type":"multipart/form-data"}}),l.status===201?(v.value=a("document_successfully_uploaded"),o.reset(),O.get(`/fleet-drivers/document/${e.driverId.id}`)):_.value=a("failed_to_upload_document")}catch(l){l.response&&l.response.status===422?y.value=l.response.data.errors:(console.error(a("error_uploading_document"),l),_.value=a("failed_to_upload_document"))}},h=f(""),C=w(()=>o.iconFile?h.value:e.uploaded&&e.uploaded.image?e.uploaded.image:"/default-profile.jpeg");f("");const F=w(()=>o.iconBackFile?iconBackFile.value:e.uploaded&&e.uploaded.back_image?e.uploaded.back_image:"/default-profile.jpeg");return{form:o,successMessage:v,alertMessage:_,handleSubmit:S,dismissMessage:B,validationRules:d,validationRef:I,errors:y,imageSrc:C,backImageSrc:F,handleImageSelected:(m,l)=>{o[l]=m},handleImageRemoved:m=>{o[m]=null}}}},Q={class:"row"},W={class:"col-6"},X={class:"mb-3"},Y={for:"name",class:"form-label"},$=["placeholder"],ee={key:0,class:"col-6"},ae={class:"mb-3"},te={for:"identify_number",class:"form-label"},oe=["placeholder"],de={key:1,class:"col-6"},ne={class:"mb-3"},le={for:"expiry_date",class:"form-label"},ie={class:"row"},re={class:"col-sm-6"},se={class:"mb-0"},me={for:"document",class:"form-label d-flex"},ce={key:0,class:"text-danger"},ue={key:0,class:"col-sm-6"},_e={class:"mb-3"},fe={for:"back_document",class:"form-label d-flex"},ge={key:0,class:"text-danger"},be={class:"col-lg-12"},ye={class:"text-end"},ve={type:"submit",class:"btn btn-primary"};function ke(e,a,o,d,I,y){const v=c("Head"),_=c("PageHeader"),B=c("BCardHeader"),S=c("flat-pickr"),h=c("ImageUpload"),C=c("FormValidation"),F=c("BCardBody"),U=c("BCard"),V=c("BCol"),m=c("BRow"),l=c("Layout");return i(),P(l,null,{default:g(()=>[u(v,{title:"Document Upload"}),u(_,{title:o.document?e.$t("edit"):e.$t("upload"),pageTitle:e.$t("document_upload"),pageLink:"/fleet-drivers"},null,8,["title","pageTitle"]),u(m,null,{default:g(()=>[u(V,{lg:"12"},{default:g(()=>[u(U,{"no-body":"",id:"tasksList"},{default:g(()=>[u(B,{class:"border-0"}),u(F,{class:"border border-dashed border-end-0 border-start-0"},{default:g(()=>[t("form",{onSubmit:a[7]||(a[7]=E((...n)=>d.handleSubmit&&d.handleSubmit(...n),["prevent"])),enctype:"multipart/form-data"},[u(C,{form:d.form,rules:d.validationRules,ref:"validationRef"},{default:g(()=>[t("div",Q,[t("div",W,[t("div",X,[t("label",Y,[b(s(e.$t("name"))+" ",1),a[8]||(a[8]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_name"),id:"name","onUpdate:modelValue":a[0]||(a[0]=n=>d.form.name=n),readonly:""},null,8,$),[[H,d.form.name]]),(i(!0),r(p,null,R(d.errors.name,(n,k)=>(i(),r("span",{key:k,class:"text-danger"},s(n),1))),128))])]),o.document&&o.document.has_identify_number==1?(i(),r("div",ee,[t("div",ae,[t("label",te,[b(s(e.$t("identify_number"))+" ",1),a[9]||(a[9]=t("span",{class:"text-danger"},"*",-1))]),T(t("input",{type:"text",class:"form-control",placeholder:e.$t("enter_identify_number"),id:"identify_number","onUpdate:modelValue":a[1]||(a[1]=n=>d.form.identify_number=n)},null,8,oe),[[H,d.form.identify_number]]),(i(!0),r(p,null,R(d.errors.identify_number,(n,k)=>(i(),r("span",{key:k,class:"text-danger"},s(n),1))),128))])])):x("",!0),o.document&&o.document.has_expiry_date==1?(i(),r("div",de,[t("div",ne,[t("label",le,[b(s(e.$t("expiry_date"))+" ",1),a[10]||(a[10]=t("span",{class:"text-danger"},"*",-1))]),u(S,{placeholder:e.$t("select_date"),id:"expiry_date",class:"form-control flatpickr-input",modelValue:d.form.expiry_date,"onUpdate:modelValue":a[2]||(a[2]=n=>d.form.expiry_date=n),config:e.rangeDateconfig},null,8,["placeholder","modelValue","config"]),(i(!0),r(p,null,R(d.errors.expiry_date,(n,k)=>(i(),r("span",{key:k,class:"text-danger"},s(n),1))),128))])])):x("",!0),t("div",ie,[t("div",re,[t("div",se,[t("label",me,[o.document&&o.document.image_type==="front_and_back"?(i(),r(p,{key:0},[b(s(o.document.document_name_front)+" ",1),a[11]||(a[11]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))],64)):(i(),r(p,{key:1},[b(s(e.$t("document"))+" ",1),a[12]||(a[12]=t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)",-1))],64))]),u(h,{imageType:"driver-documents",initialImageUrl:d.form.image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[3]||(a[3]=n=>d.handleImageSelected(n,"image")),onImageRemoved:a[4]||(a[4]=()=>d.handleImageRemoved("image"))},null,8,["initialImageUrl"]),d.errors.image?(i(),r("span",ce,s(d.errors.image),1)):x("",!0)])]),o.document&&o.document.image_type==="front_and_back"?(i(),r("div",ue,[t("div",_e,[t("label",fe,[b(s(o.document.document_name_back)+" ",1),a[13]||(a[13]=t("span",null,[t("h5",{class:"text-muted mt-1 mb-0 fs-13"},"(512px x 512px)")],-1))]),u(h,{imageType:"driver-documents",initialImageUrl:d.form.back_image,flexStyle:"0 0 calc(50% - 20px)",aspectRatio:"5 / 5",onImageSelected:a[5]||(a[5]=n=>d.handleImageSelected(n,"back_image")),onImageRemoved:a[6]||(a[6]=()=>d.handleImageRemoved("back_image"))},null,8,["initialImageUrl"]),d.errors.back_image?(i(),r("span",ge,s(d.errors.back_image),1)):x("",!0)])])):x("",!0)]),t("div",be,[t("div",ye,[t("button",ve,s(o.document?e.$t("update"):e.$t("save")),1)])])])]),_:1},8,["form","rules"])],32)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const Re=L(K,[["render",ke]]);export{Re as default};
